<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Springboot学习笔记 | 小Z成长录😀丶</title><meta name="keywords" content="工作技能,后端,Spring"><meta name="author" content="十七"><meta name="copyright" content="十七"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#e8dfc4"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Springboot学习笔记"><meta name="application-name" content="Springboot学习笔记"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#e8dfc4"><meta property="og:type" content="article"><meta property="og:title" content="Springboot学习笔记"><meta property="og:url" content="https://zc-zjy.github.io/2023/10/24/Springboot学习笔记/index.html"><meta property="og:site_name" content="小Z成长录😀丶"><meta property="og:description" content="一、Springboot基础知识记录1、Springboot IOC和DI注入方式1、按照类型注入（直接在类上使用@Autowired）（1）当只有一个名字相同的类存在：   12345678910111213&amp;#x2F;&amp;#x2F; Service层@Servicepublic class DemoServiceI"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://zc-zjy.github.io/img/page_background/cover_background_light.jpg"><meta property="article:author" content="十七"><meta property="article:tag" content="Java,Spring,软件开发技术,Vue"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://zc-zjy.github.io/img/page_background/cover_background_light.jpg"><meta name="description" content="一、Springboot基础知识记录1、Springboot IOC和DI注入方式1、按照类型注入（直接在类上使用@Autowired）（1）当只有一个名字相同的类存在：   12345678910111213&amp;#x2F;&amp;#x2F; Service层@Servicepublic class DemoServiceI"><link rel="shortcut icon" href="/img/dog.png"><link rel="canonical" href="https://zc-zjy.github.io/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},
  postHeadAiDescription: {"enable":true,"gptName":"小Z成长录😀丶","mode":"local","switchBtn":true,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":["💢 励志成为技术大牛的一名小白"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":true,"limitCount":50,"languages":{"author":"作者: 十七","link":"链接: ","source":"来源: 小Z成长录😀丶","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '小Z成长录😀丶',
  title: 'Springboot学习笔记',
  postAI: '',
  pageFillDescription: '一、Springboot基础知识记录, 1、Springboot IOC和DI注入方式, 2、Springboot 关于使用 AOP, 3、关于 Springboot 配置文件, 4、springboot集成mybatis需要的依赖, 5、Springboot bean的管理, 6、Springboot自动配置加载流程, 7、循环依赖问题, 8、Springboot源码名词, 二、Springboot使用方法, 1、要想在tomcat中启动项目, 2、在配置文件中配置静态资源, 3、springboot各种pom文件需要和学习指南地址, 4、Springboot读配置的4种方式, 5、Springboot获取bean对象方法, 6、怎么使用好springboot自动配置, 7、springboot多环境配置, 8、springboot打包插件, 三、Springboot其他组件, 1、全局异常处理器, 2、过滤器和拦截器, 3、热部署, 四、Springboot使用过程中遇到的问题合集, 1、springboot自动注入问题, 2、Springboot多传参数导致JSON parse error Unrecognized filed …异常, 3、有关对象属性中有枚举list怎么传参, 4、事务失效问题, 5、关于配置类List对象映射到实体类问题, 6、VO、DTO、BO、PO、DO的区别, 7、链式调用, 8、替换@Autowired注解的方式一基础知识记录和注入方式按照类型注入直接在类上使用当只有一个名字相同的类存在层层当存在多个相同的类名不在同一个包下层层使用声明的注入按照名称注入说明直接在类上使用相当于层层使用声明的注入按照方法注入层层按照构造器方式注入说明构造器注入可以避免注入的循环依赖问题比如在中注入了在中注入了使用构造器注入在项目启动的时候会抛出提醒循环依赖层层关于使用说明什么是就是增强在没有使用时对象是原本的对象比如房东对象而使用了之后使用的对象就变成了代理对象而不是原本的对象比如中介对象相当于就是不修改原有的业务逻辑代码的基础上想要增加额外的逻辑就是找到原有的代码切入想要增加的代码比如日志的记录的工作流程说明容器启动会去读取被和标注的切面类中配置的所有切入点也就是被标注的方法初始化所有然后去判断需要被增强的对应的类中的方法是否匹配到任意切入点如果匹配失败就创建对象如果匹配成功就创建对象的代理对象获取调用方法并执行完成操作使用方法导入依赖在中导入的依赖方式一将这个类注入到容器中使用这个注解标注这个类在类的方法处切入相当于想增强方法在方法处切入具体怎么切入看使用的是什么通知类型注解将这个切入点配置对应到这个方法上相当于上面工作流程说明中的第点如果没有这个切入点就毫无意义就会匹配失败这个方法是在上面方法前调用编写需要增强的业务逻辑代码在启动类上加注解告诉我以注解的方式使用特别说明为什么不加注解一样也会生效是因为依赖中如果存在依赖而这个依赖中包含了依赖正是这个依赖自动装配依赖它会读取文件这个文件中有一个类这个等同于注解我们可以在配置文件中将它关闭这样就不生效了在不使用注解前提下所以为了保险期间请一律加上注解方式二简写形式省去了将这个类注入到容器中使用这个注解标注这个类下面的注解的意思是在切入意思就是在所有方法前后都会执行下面中的逻辑调用原始方法方式三注解的形式灵活比较详细创建一个注解使用该注解标注的方法会执行切入类中的方法这样就不用写匹配规则了无法获知此用户的操作行为创建切面类使用注解的方式来定切入点比如我在方法上使用注解标注之后当执行到方法时因为使用的的形式所以会在方法后面执行下面的方法参数可以获取到方法的各种值使用必须在注解中声明这个是获取方法返回值这个是可以获取注解的参数获取获取所属的类名获取方法的参数使用方式在需要的方法上使用注解在需要的方法上使用注解要想获取请求的各种参数比如请求类型等使用正常日志获取为空时间获取请求获取响应正常日志获取失败时间切入点表达式描述描述一接口执行包下的接口中的无参数方法是的返回类型描述二类执行包下的类中的无参数方法是的返回类型描述三单个独立的任意符号可以独立出现也可以作为前缀或者后缀的匹配符出现匹配包下的任意包中的类或接口中所有开头的带有一个参数的方法描述四多个连续的任意符号可以独立出现常用于简化包名与参数的书写匹配包下的任意包中的类或接口中所有名称为的方法描述五专用于匹配子类类型表达式格式说明格式动作关键字访问修饰符返回值包名类接口方法名参数异常名动作关键字描述切入点的行为动作例如表示执行到指定切入点访问修饰符等可以省略返回值包名类接口名方法名参数异常名方法定义中抛出指定异常可以省略通知类型环绕通知需要传参自己调用方法执行原始方法下面其他的注解不用调用此注解标注的通知方法在目标方法前后都被执行前置通知此注解标注的通知方法在目标方法前被执行后置通知此注解标注的通知方法在目标方法后被执行无论是否有异常都会执行返回后通知此注解标注的通知方法在目标方法后被执行有异常不会执行异常后通知此注解标注的通知方法发生异常后执行通知类型的参数非环绕通知可以将作为通知方法的第个参数通过这个参数获取被调用方法的信息连接点所在位置的相关信息连接点所在位置的简短相关信息连接点所在位置的全部相关信息返回代理对象返回目标对象返回被通知方法参数列表也就是目前调用目标方法传入的参数返回当前连接点签名这个可以用来获取目标方法的详细信息如方法对象等返回连接点方法所在类文件中的位置连接点类型返回连接点静态部分如果是环绕通知可以将作为方法的第个参数通过这个参数获取被调用方法的信息关于配置文件配置文件加载优先级配置文件配置文件配置文件配置文件名必须是如果想更改它的名字必须在这里配置不止可以在配置文件中配置还可以在属性或者命令行配置中设置属性配置在启动配置里有一项配置例如可以在里配置端口号命令行配置同属性配置有一项配置例如在里配置端口号在命令行设置属性配置命令行配置注意优先级命令行属性配置文件多个文件的使用方法默认加载的是文件所以想要引入其他配置的文件就要在中激活该文件定义一个文件注意必须以开头中注意必须是在或者这个也是用来启动多环境的如果有开发测试生产环境就用这个来启动赋值如果是的话它是自动完成的配置文件代码小明男方案一使用注解注意如果使用需要使用来加载并在属性上使用使用方案二使用集成需要的依赖驱动这里这个可以换比如如果要用的就导入的或者只需要以下依赖就可以了在中配置数据源数据库名字这个依赖导入哪个就用哪个实体类包路径比如的路径比如的管理获取非第三方管理我们将一个类注入到容器中成为一个对象默认是单例要想多例只需在该类上加上注解例如第三方管理第三方比如第三方的包我们无法在第三方中某个类上面使用等注解的情况下就使用注解举个场景我们想使用必须上面这个场景我们不能在类上面使用注解来将它注入到容器中但是我们可以这样在启动类里把类注入到容器中不过在启动类中定义是不推荐的推荐的是在配置类中定义将当前方法的返回值对象交给容器管理成为容器多个使用方法概述通过管理的类默认是单例模式但是如果有的类需要使用独立的属性则需要配置为多例模式的但是多例模式不仅仅只是加一个声明使用进行注入可能并不会是你想要的结果因为多例模式的类是需要单独调用的不搞清楚原理直接测试需要多例的类上加上注解引用直接使用结果每个过来的时候实例均为同一个实例解决办法第一种不使用第二种使用工厂设置工厂否则工厂将不会自动连接然后使用进行代理工厂注入使用自动配置加载流程说明导入就会导入包包里面有一个文件里面指定的是启动要加载的所有自动配置类会自动的把上面文件里面写的所有自动配置类都导入进容器自动配置类中的是有条件注解来进行按需加载的给容器中导入一堆组件组件都是从中提取属性值的又是和配置文件进行了绑定默认配置说明包含了和组件方便视图解析默认的静态资源处理机制静态资源在文件夹下即可直接访问自动注册了组件适配常见数据类型转换和格式化需求支持可以方便返回等数据类型自动使用实现消息处理数据绑定类型转化数据校验等功能重要如果想保持默认配置并且自定义更多配置如拦截器格式化器视图解析器等可以创建一个新类使用注解和实现一个接口并且不要标注注解如果想保持默认配置但要自定义核心组件实例比如等只需给容器中放一个组件即可如果想全面接管标注一个配置类并加上注解实现接口接口方法说明参数解析器用来解析中各方法的参数跨域格式化器用来处理配置文件中格式化的问题拦截器资源处理器处理静态资源规则返回值处理器当返回一个字符串或者对象等时是要跳转页面还是返回数据视图控制器如果想发一个请求直接跳转到页面不用写可以在这里设置异步支持内容协商配置异常处理解析器配置消息转换器路径匹配配置视图解析器循环依赖问题三级缓存一级缓存单例池用来存经历过完整生命周期的二级缓存用来存还没有初始化的代理对象三级缓存代码上面产生了循环依赖说明源码名词说明一在源码中用到的是接口而官网中使用到的是的实现类说明二和区别是中一种特殊的可以在工厂方法自定义的逻辑创建是一种能够生产其他的在容器启动时被创建而在实际使用时通过调用方法来得到其所生产的因此可以自定义任何所需的初始化逻辑生产出一些定制化的是框架的基础其作为一个顶级接口定义了容器的基本行为例如管理的生命周期配置文件的加载和解析的装配和依赖注入等接口提供了访问的方式例如方法获取指定的实例它可以从不同的来源例如数据库文件配置类等获取定义并将其转换为实例同时还包含很多子类例如接口提供了额外的强大功能是接口位于包下它是的一个工厂它定义了各种获取的方法判断是否存在判断是否单例等针对的基础方法是接口位于包下它就是容器它继承了接口查看源码可以看到它是先继承了接口再继承的接口它负责实例化配置组装是接口它继承了接口在的基础上扩展了的查询方法例如根据类型获取根据注解获取根据获取注解是接口它继承了接口在的基础上提供了的创建配置注入销毁等操作注意有时候我们需要自己手动注入的时候可以考虑通过实现该接口来完成是接口它继承了接口在的基础上添加了获取的方法是接口定义了对单例的定义以及获取方法是接口它继承了接口和接口它定义了针对的各种配置以及销毁方法是接口它继承了接口接口和接口它是的配置清单这里定义了忽略的类型接口通过的名词获取冻结等是别名是接口它定义了对的注册移除判断以及查询操作是类它实现了接口中的所有方法它还使用做载体实现对的注册移除判断以及查询操作是类它继承了类实现了接口这个类基于中的集合对接口进行了实现是类继承了类在的基础上增加了获取类型移除缓存的方法等是类继承了类实现了接口是类它继承了类实现了接口的所有方法是接口它继承了接口增加了一系列针对的注册移除查询判断等方法是类它继承了类实现了定义了关于的注册移除查询和序列化接口接口它是工厂的一个默认实现类提供了原始的的功能如对外提供方法这个方法有两种方式获取第一种方式是中提供的根据名称获取第二种方式是它自己的根据类型获取这种方式属于方法的扩展属性是信息表说明是提供的扩展性接口接口为提供了属性初始化后的处理方法它只有一个方法只要实现了该接口的类所创建出来的在初始化后都会执行该方法构造方法执行输出输出优先级构造方法执行构造方法执行说明在初始化的时候如果该实现了接口并且同时配置了系统则是先调用方法然后再调用中指定的方法二使用方法要想在中启动项目要想在中使用包启动项目首先先继承然后在使用下面的方法在配置文件中配置静态资源默认的静态资源路径为修改静态资源访问路径项目路径修改静态资源存放路径修改之后只有将静态资源放到目录下才能被访问到各种文件需要和学习指南地址各种文件需要和学习指南地址读配置的种方式注解使用该注解需要注意该类必须注入容器中才能使用注解获取配置文件中的数据配置文件里必须有该属性不然启动会报异常默认值为了不报异常可以加默认值如果是表示值为如果属性有和关键字的话是无法生效的注解只需要指定配置文件中某一个的前缀就可以了例如配置文件这里的命名规范要么全小写要么小写小写格式不能下划线注意使用注解必须将给管理方法一在配置类上使用方法二在实体类上使用注解通过类动态获取是底层提供的第一种实现方式实现接口重写方法从配置文件获取第二种通过自动注入从配置文件获取以上三种是获取默认的配置文件要想获取自定义的配置文件可以通过下面的方法默认的配置文件开头自定义注解只能获取的配置文件要想获取的需要设置配置类然后就可以通过第一种方式注解获取获取对象方法启动获取在项目启动时先获取对象然后将其存储在一个地方以便后续用到时进行使用这里提供两种场景的获取基于配置的形式适用于比较古老的项目已经很少使用了基于启动时获取对象基于的形式实现其中为配置容器的不过现在一般很少使用了这里等于直接初始化容器并且获得容器的引用这种方式适用于采用框架的独立应用程序需要程序通过配置文件手工初始化的情况目前大多数项目已经不再采用配置很少使用了基于启动实现启动时保存上下文并保存为静态对应的类如下两种方式都是在启动项目时直接获取到的引用然后将其存储到工具类当中在使用时则从工具类中获取容器进而从中获得对象通过继承此种方式依旧是先获得容器然后从中获取对象只不过是基于继承类实现的具体实现代码注意这里的类需要实例化类图我们看到它实现了接口在容器初始化过程中回调方法来完成的赋值通过继承是的一个实现类提供了相关的支持实现原理与一样具体实现代码如下通过类图我们可以看到它是的实现子类此方式除了继承对象不同外没有其他区别都是基于方法来获取通过提供了工具类通过该类可获取对象具体实现代码如下或者这个方法很常见于构建的项目中适用于项目的结构通过通过实现接口在容器启动时将注入进去从而获取对象这种方法也是常见的获取的一种方式推荐使用具体实现代码如下这种方式与前面通过获得的思路一致通过使用提供的方法也是常用的获取的一种方法具体实现代码如下该方法常见于实现的项目中该方式是一种不依赖于不需要注入的方式但是需要注意一点在服务器启动时和容器初始化时不能通过该方法获取容器通过工具类方便在非管理环境中获取应用上下文环境获取对象一个以所给名字注册的的实例获取类型为的对象如果包含一个与所给名称匹配的定义则返回判断以给定名字注册的定义是一个还是一个如果与给定名字相应的定义没有被找到将会抛出一个异常注册对象的类型如果给定的名字在定义中有别名则返回这些别名获取代理对象其中接口也属于的子接口怎么使用好自动配置选场景然后找到这个场景的自动配置类写配置在这个自动配置类中找到分析开启了哪些属性绑定关系修改相关的配置分析组件在这个自动配置类中分析因为有两个方法表示这个自动配置类给容器中放了两个组件有一个组件方法叫然后去业务代码中使用自动装配注解装配这个方法使用组件的前提是知道这个组件是干嘛的定制化如果不满足需求需要定制化自定义组件自己写一个方法并放到容器中自动配置类中的这个方法上面标注了这个注解的作用就是如果我们自己写了下面的方法则这个自动配置类就不加载这个方法容器中使用我们自己自定义的方法例子自定义启动类步骤创建模块只负责依赖管理创建模块在模块引入该模块在模块中定义自动配置功能并定义自动配置文件老版本的为实例对应上面的步骤创建模块创建模块在模块引入该模块文件同上注意没有启动类配置文件测试类在步骤创建的模块文件中加入步骤创建的模块依赖在步骤创建的模块文件中引入依赖在模块中创建类和类和方法的方法的方法获取上传的文件输入流避免文件名重复导致被覆盖上传文件到拼接文件访问路径关闭在模块中创建配置类在模块中定义自动配置功能并定义自动配置文件老版本的为在模块的目录下创建文件夹继续在文件夹下创建文件夹继续在文件夹下创建文件将类的全类名填入文件中多环境配置文件将应用程序的配置参数分离到不同的文件中每个环境对应一个文件例如可以创建和等文件在这些文件中可以定义各自环境的配置参数如数据库连接信息端口号等然后在中通过属性指定当前使用的环境会根据该属性来加载对应环境的文件覆盖默认的配置文件同文件命令行参数动态可以通过命令行参数来指定当前的环境例如使用来指定使用开发环境打包插件三其他组件全局异常处理器说明当出现异常的时候会把异常抛到前端抛出数据格式不符合规范所以我们必须在每个中去处理异常这样的话每个类中的方法都要去写这个处理的过程太繁琐了所以我们就要弄一个全局异常处理器这个注解的作用是指定要捕获的异常对不起操作失败请联系管理员过滤器和拦截器说明过滤器是在浏览器发送请求到服务器之前而拦截器是在与之间以及视图返回到之间过滤器快速入门是下的定义定义一个类实现接口并重写其所有方法配置类上加注解配置拦截资源的路径启动类上加开启组件支持要拦截什么样的请求表示所有初始化方法服务器启动创建时调用只调用一次拦截到请求时调用该方法可调用多次放行销毁方法服务器关闭时调用只调用一次拦截器快速入门介绍是框架中的一个接口它用于实现拦截器在框架中拦截器是一种特殊的中间件用于在请求处理之前或之后执行一些特定的操作口定义了三个方法和分别用于在请求处理之前之后以及视图渲染之后执行一些操作实现接口的类可以用于处理请求和响应例如在请求处理之前执行一些操作例如权限验证日志记录等在请求处理之后执行一些操作例如处理异常记录日志等在视图渲染之后执行一些操作例如清理资源关闭连接等要使用接口需要将其实现类注册到容器中可以通过实现接口的方法来注册拦截器实现方式有两种方式选择其中之一就可方式一定义一个类实现接口方式二定义一个类继承已实现了接口的类例如抽象类然后添加拦截器到配置器中以前一般继承类不过以上类就过时了有以下两种替代方法第一种方式直接实现接口推荐第二种方式继承类但是继承会让对的自动配置失效不过目前大多数项目是前后端分离并没有对静态资源有自动配置的需求所以继承也未尝不可实现步骤定义拦截器实现接口并重写其所有方法注册拦截器目标资源方法执行前执行返回放行返回不放行预处理在业务处理器处理请求之前被调用可以进行登录拦截编码处理安全控制权限校验等处理目标资源方法执行后执行后处理在业务处理器处理请求执行完成后生成视图之前被调用即调用了并返回但未进行页面渲染可以修改这个比较少用视图渲染完毕后执行最后执行返回处理在完全处理完请求后被调用可用于清理资源等已经渲染了页面例子一实现接口说明此拦截器演示了通过注解形式对用户权限进行拦截校验获取用户权限校验注解优先获取方法无则再从类获取获取用户信息权限校验如若不抛出异常也可返回例子二继承类添加拦截器配置方法一实现接口推荐方法一例子可以添加多个拦截器一般只添加一个表示对所有请求都拦截表示排除对请求的拦截多个拦截器可以设置顺序值越小越先执行和越后执行默认的值是如果只添加一个拦截器可以不显示设置的值方法二继承类可以添加多个拦截器一般只添加一个表示对所有请求都拦截表示排除对请求的拦截其他主要辅助类用户上下文类用户名称用户用户类型用户上下文操作类获取用户上下文信息从缓存或者第三方获取用户信息因为演示没集成故简单对象保存用户上下文信息用户实际根据自己业务进行生成此处简单用设置缓存方法参数解析器类对有参数的接口进行拦截注入用户信息从缓存获取用户信息赋值到接口参数中只对参数进行拦截赋值拦截路径能匹配不能匹配能匹配能匹配不能匹配能匹配多个拦截器执行顺序上面这个图是每个拦截器都放行的情况下如果其中一个拦截器不放行那所有的都不会执行然后不放行的拦截器中的不会执行其他的拦截器的会执行例如拦截器不放行那么执行的方法为拦截器的拦截器的拦截器的拦截器的拦截器的总结就是只有所有拦截器都放行了方法才会执行只有当前拦截器放行了当前拦截器的方法才会执行过滤器和拦截器的区别执行流程浏览器发送请求过滤器拦截器区别接口规范不同过滤器需要实现接口而拦截器需要实现接口拦截范围不同过滤器会拦截所有的资源而只会拦截环境中的资源拦截器是中的只能作用于过滤器是拦截器基于反射机制过滤器基于函数回调拦截器只对请求起作用过滤器几乎所有请求都起作用拦截器可以多次被调用过滤器只能在初始化的时候被调用一次热部署使用插件编写玩代码后使用这个插件自带的启动按钮启动然后每次编写玩都按使用热部署设置热部署设置后我们就不用频繁的去手动重启它会自动刷新就是写好代码后在中按再去浏览器刷新如果不想按也可以这样设置先设置设置自动编译勾选然后点击勾选四使用过程中遇到的问题合集自动注入问题使用了注解还是无法获取到对象原因是因为扫描器没有扫描到默认扫描启动类同级的包解决方法一需要到启动类上加上包扫描注解而且不止要扫描需要扫描的包还要扫描原来启动类同级的包解决方法二在启动类上使用注解例子大括号里的是需要被扫描到的类不需要使用任何注解的普通类解决方法三新建一个配置类使用注解标注的类把需要被扫描的类在这个配置类中使用注解标注在启动类上使用注解将这个配置类导入例子配置类启动类解决方法四新建一个配置类使用注解标注的类把需要被扫描的类在这个配置类中使用注解标注在新建一个选择器类实现接口实现这个接口的方法在这个方法中将配置类返回然后将这个选择器类在启动类上使用注解导入例子配置类需要扫描的类需要扫描的类选择器类上面的配置类包路径启动类将上面选择器类导入总结上面的方法太繁琐了一般需要扫描的包中会提供给我们一个注解注解这个注解封装了上面使用到和注解我们直接在启动类上使用注解就可以了多传参数导致异常说明一个方法中只能有一个注解因为就是的这个流在第一次使用该注解后会关闭后面的都会报错默认情况下标注的对象必须包含前台传来的所有字段如果没有包含前台传来的字段就会报错这是因为默认要求必须存在相应的字段如果没有前台传来的某个字段就会报错解决前端请求多余字段转换报错问题第一种后端实体类可以增加一个字段来接收前台传来的这个值第二种在前端往后端传值的时候去掉无用的字段这样还能减少网络传输的大小第三种使用提供的注解注解用来忽略某些字段可以用在或者方法上用在方法时和效果一样将这个注解写在类上之后就会忽略类中不存在的字段指定要忽略的字段用在类上例子实体类第四种重写配置类方式添加此配置有关对象属性中有枚举怎么传参实体类枚举类较低高危中危严重前端传参事务失效问题完整详情链接场景一此传播方式如果已经存在了一个事务就抛出异常说明因为方法被标注事务又是基于实现的所以的代理类执行方法方法也被标注并且传播方式为如果已经存在了一个事务就抛出异常很明显已经存在一个事务所以正常情况会抛出异常但是现在不会因为事务失效了原因方法中执行方法是类本身去调用执行的并不是它的代理类去调用执行所以它失效了解决办法让它代理类去调用执行方法而不是它本身去调用执行办法一此传播方式如果已经存在了一个事务就抛出异常办法二加注解防止报错加入后运行会报个错需要你设置在该类上加个注解此传播方式如果已经存在了一个事务就抛出异常办法三将方法提出去另一个类中在由这个类来调用执行关于配置类对象映射到实体类问题实体类实体类中的属性名称必须对应配置文件中对象中属性的名称实体配置类必须对应配置文件中名称配置文件检测规则包基础检测包基础检测包基础检测包使用注意这里注入的是实体配置类的区别链式调用输出结果替换注解的方式使用的注解这里的必须和一起用不注入的话就不用加要注入才加',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-06 22:30:38',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#e8dfc4')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/avatar/loading.gif"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">小Z成长录😀丶</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "city": "CN101290101",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/reward/zjyzanshang.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/reward/zjyzanshang.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/reward/zjyzfb.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/reward/zjyzfb.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Camunda/" style="font-size: 1.05rem;">Camunda<sup>1</sup></a><a href="/tags/ElasticSearch/" style="font-size: 1.05rem;">ElasticSearch<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>1</sup></a><a href="/tags/IntelliJ-IDEA-2020-3-3-x64%E6%BF%80%E6%B4%BB%E6%96%B9%E6%B3%95/" style="font-size: 1.05rem;">IntelliJ IDEA 2020.3.3 x64激活方法<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>14</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/Maven/" style="font-size: 1.05rem;">Maven<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 1.05rem;">Mybatis<sup>1</sup></a><a href="/tags/MybatisPlus/" style="font-size: 1.05rem;">MybatisPlus<sup>1</sup></a><a href="/tags/Mysql/" style="font-size: 1.05rem;">Mysql<sup>1</sup></a><a href="/tags/Postgresql/" style="font-size: 1.05rem;">Postgresql<sup>1</sup></a><a href="/tags/Postman/" style="font-size: 1.05rem;">Postman<sup>1</sup></a><a href="/tags/SVN/" style="font-size: 1.05rem;">SVN<sup>1</sup></a><a href="/tags/Spring/" style="font-size: 1.05rem;">Spring<sup>7</sup></a><a href="/tags/Vue/" style="font-size: 1.05rem;">Vue<sup>1</sup></a><a href="/tags/css/" style="font-size: 1.05rem;">css<sup>1</sup></a><a href="/tags/navicat/" style="font-size: 1.05rem;">navicat<sup>1</sup></a><a href="/tags/%E4%B9%A6%E6%9C%AC%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">书本知识<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.05rem;">前端<sup>3</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 1.05rem;">后端<sup>25</sup></a><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/" style="font-size: 1.05rem;">工作技能<sup>40</sup></a><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%B5%81/" style="font-size: 1.05rem;">工作流<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">数据库<sup>3</sup></a><a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 1.05rem;">服务器<sup>3</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">测试工具<sup>1</sup></a><a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 1.05rem;">消息队列<sup>1</sup></a><a href="/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" style="font-size: 1.05rem;">版本控制<sup>2</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 1.05rem;">设计模式<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/" itemprop="url">工作技能</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>工作技能</span></a><a class="article-meta__tags" href="/tags/%E5%90%8E%E7%AB%AF/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>后端</span></a><a class="article-meta__tags" href="/tags/Spring/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Spring</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Springboot学习笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-10-24T01:09:19.000Z" title="发表于 2023-10-24 09:09:19">2023-10-24</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-03-06T14:30:38.977Z" title="更新于 2025-03-06 22:30:38">2025-03-06</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Springboot学习笔记"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为昆明"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>昆明</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/img/page_background/cover_background_light.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://zc-zjy.github.io/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><header><a class="post-meta-categories" href="/categories/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/" itemprop="url">工作技能</a><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/" tabindex="-1" itemprop="url">工作技能</a><a href="/tags/%E5%90%8E%E7%AB%AF/" tabindex="-1" itemprop="url">后端</a><a href="/tags/Spring/" tabindex="-1" itemprop="url">Spring</a><h1 id="CrawlerTitle" itemprop="name headline">Springboot学习笔记</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">十七</span><time itemprop="dateCreated datePublished" datetime="2023-10-24T01:09:19.000Z" title="发表于 2023-10-24 09:09:19">2023-10-24</time><time itemprop="dateCreated datePublished" datetime="2025-03-06T14:30:38.977Z" title="更新于 2025-03-06 22:30:38">2025-03-06</time></header><hr>
<h1 id="一、Springboot基础知识记录"><a href="#一、Springboot基础知识记录" class="headerlink" title="一、Springboot基础知识记录"></a>一、Springboot基础知识记录</h1><h3 id="1、Springboot-IOC和DI注入方式"><a href="#1、Springboot-IOC和DI注入方式" class="headerlink" title="1、Springboot IOC和DI注入方式"></a>1、Springboot IOC和DI注入方式</h3><p>1、按照类型注入（直接在类上使用<code>@Autowired</code>）<br>（1）当只有一个名字相同的类存在：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Service层</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DemoService</span> &#123;</span><br><span class="line">    .........</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Controller层</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DemoService demoService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（2）当存在多个相同的类名（不在同一个包下）：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Service层</span></span><br><span class="line"><span class="meta">@Service(&quot;a&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DemoService</span> &#123;</span><br><span class="line">    .........</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service(&quot;b&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DemoService</span> &#123;</span><br><span class="line">    .........</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Controller层</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(value=&quot;a&quot;)</span> <span class="comment">// 使用a声明的service注入</span></span><br><span class="line">    <span class="keyword">private</span> DemoService demoService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、按照名称注入<br><strong>说明：</strong>直接在类上使用<code>@Resource</code>（<code>@Resource</code>相当于<code>@Autowired + @Qualifier</code>）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Service层</span></span><br><span class="line"><span class="meta">@Service(&quot;a&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DemoService</span> &#123;</span><br><span class="line">    <span class="comment">// .........</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service(&quot;b&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DemoService</span> &#123;</span><br><span class="line">    <span class="comment">// .........</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Controller层</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name=&quot;a&quot;)</span> <span class="comment">// 使用a声明的service注入</span></span><br><span class="line">    <span class="keyword">private</span> DemoService demoService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、按照<code>setter</code>方法注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Service层</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DemoService</span> &#123;</span><br><span class="line">    .........</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Controller层</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DemoService demoService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDemoService</span><span class="params">(DemoService demoService)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.demoService = demoService;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、按照构造器方式注入<br><strong>说明：</strong>构造器注入可以避免<code>Field</code>注入的 循环依赖 问题，比如在<code>Demo1</code>中注入了<code>Demo2</code>，在<code>Demo2</code>中注入了<code>Demo1</code>，使用构造器注入，在项目启动的时候会抛出<code>BeanCurrentlyCreationException</code>提醒循环依赖。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Service层</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DemoService</span> &#123;</span><br><span class="line">    .........</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Controller层</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DemoService demoService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DemoController</span><span class="params">(DemoService demoService)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.demoService = demoService;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="2、Springboot-关于使用-AOP"><a href="#2、Springboot-关于使用-AOP" class="headerlink" title="2、Springboot 关于使用 AOP"></a>2、Springboot 关于使用 AOP</h3><p>1、说明：什么是AOP？<br>AOP就是增强，在没有使用AOP时，对象是原本的对象（比如房东对象），而使用了AOP之后，使用的对象就变成了代理对象，而不是原本的对象（比如中介对象），相当于就是不修改原有的业务逻辑代码的基础上，想要增加额外的逻辑，就是找到原有的代码，切入想要增加的代码，比如日志的记录；<br>2、AOP的工作流程说明<br>（1）Spring容器启动；<br>（2）会去读取被<code>@Aspect</code>和<code>@Component</code>标注的切面类中配置的所有切入点，也就是被<code>@Pointcut</code>标注的方法；<br>（3）初始化所有bean，然后去判断需要被增强的bean对应的类中的方法是否匹配到任意切入点；<br>（4）如果匹配失败，就创建bean对象；<br>（5）如果匹配成功，就创建bean对象的代理对象；<br>（6）获取bean，调用方法并执行，完成操作。<br>3、使用方法<br>（1）导入依赖，在<code>pom.xml</code>中导入AOP的依赖  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>（2）方式一：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> <span class="comment">// 将这个类注入到容器中</span></span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">// 使用这个注解标注这个类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoAspect</span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 在BookDao类的update方法处切入，相当于想增强update方法</span></span><br><span class="line">	<span class="comment">// 在void com.xxx.dao.BookDao.update方法处切入，具体怎么切入看使用的是什么通知类型注解</span></span><br><span class="line">	<span class="meta">@Pointcut(&quot;execution(void com.xxx.dao.BookDao.update())&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将pt这个切入点配置对应到这个方法上</span></span><br><span class="line">	<span class="comment">// 相当于上面AOP工作流程说明中的第3点</span></span><br><span class="line">	<span class="comment">// 如果没有这个，切入点就毫无意义，就会匹配失败</span></span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">recordTime</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">		<span class="comment">// 这个方法是在上面 update方法前调用</span></span><br><span class="line">        .... <span class="comment">// 编写需要增强的业务逻辑代码</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在启动类上加<code>@EnableAspectJAutoProxy</code>注解，告诉spring，我以注解的方式使用aop。<br>特别说明：为什么不加<code>@EnableAspectJAutoProxy</code>注解AOP一样也会生效？<br>是因为依赖中如果存在<code>spring-boot-starter-web</code>依赖，而这个依赖中包含了<code>spring-boot-autoconfigure</code>依赖，正是这个依赖（自动装配依赖），它会读取<code>spring.factories</code>文件，这个文件中有一个<code>AopAutoConfiguration</code>类，这个等同于<code>@EnableAspectJAutoProxy</code>注解，我们可以在<code>yml</code>配置文件中将它关闭<code>spring.aop.auto=false</code>，这样AOP就不生效了（在不使用<code>@EnableAspectJAutoProxy</code>注解前提下）。<br>所以为了保险期间请一律加上<code>@EnableAspetJAutoProxy</code>注解。<br>（3）方式二（简写形式，省去了<code>@Pointcut</code>）：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> <span class="comment">// 将这个类注入到容器中</span></span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">// 使用这个注解标注这个类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoAspect</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 下面的注解的意思是在com.xxx.service.*.*(..)切入</span></span><br><span class="line">    <span class="comment">// 意思就是在com.xxx.service.*.*(..)所有方法前后，都会执行下面recordTime中的逻辑</span></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.xxx.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">recordTime</span><span class="params">(ProceedingJoinPoint p)</span>&#123;</span><br><span class="line">        p.proceed(); <span class="comment">// 调用原始方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（3）方式三（注解的形式，灵活）：（比较详细）<br>创建一个注解：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用该注解标注的方法会执行切入类中的方法</span></span><br><span class="line"><span class="comment">// 这样就不用写 execution(* com.xxx.service.*.*(..)) 匹配规则了</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> LogUserProjectOperation &#123;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">description</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;无法获知此用户的操作行为&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建切面类：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProjectProcessRecordAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用注解的方式来定切入点</span></span><br><span class="line">    <span class="comment">// 比如我在xxx方法上使用@LogUserProjectOperation注解标注之后，</span></span><br><span class="line">    <span class="comment">// 当执行到xxx方法时，因为使用的@AfterReturning的形式，</span></span><br><span class="line">    <span class="comment">// 所以会在xxx方法后面执行下面的方法</span></span><br><span class="line">    <span class="comment">// joinPoint参数可以获取到xxx方法的各种值</span></span><br><span class="line">    <span class="comment">// 使用returnValue，必须在注解中声明returning = &quot;returnValue&quot;，这个是获取xxx方法返回值</span></span><br><span class="line">    <span class="meta">@AfterReturning(value = &quot;@annotation(LogUserProjectOperation)&quot;, returning = &quot;returnValue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logUserProjectOperation</span><span class="params">(JoinPoint joinPoint, Object returnValue)</span> &#123;</span><br><span class="line">        <span class="comment">// 这个是可以获取@LogUserProjectOperation 注解的参数</span></span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> signature.getMethod();</span><br><span class="line">        <span class="type">LogUserProjectOperation</span> <span class="variable">annotation</span> <span class="operator">=</span> method.getAnnotation(LogUserProjectOperation.class);</span><br><span class="line">        <span class="type">String</span> <span class="variable">description</span> <span class="operator">=</span> annotation.description();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 获取xxx</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> joinPoint.getSignature().getName();</span><br><span class="line">        <span class="comment">// 获取xxx所属的类名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> joinPoint.getTarget().getClass().getSimpleName();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取xxx方法的参数</span></span><br><span class="line">        Object[] args = joinPoint.getArgs();</span><br><span class="line">        <span class="keyword">for</span> (Object arg : args) &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用方式：在需要的方法上使用<code>@LogUserProjectOperation</code>注解  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/projectCheck&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProjectCheckController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在需要的方法上使用@LogUserProjectOperation注解</span></span><br><span class="line">    <span class="meta">@LogUserProjectOperation</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/approveOperate&quot;, method = RequestMethod.PUT)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;Boolean&gt; <span class="title function_">approveOperate</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要想获取http请求的各种参数，比如请求类型（get、post等），使用：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServletRequestAttributes</span> <span class="variable">attributes</span> <span class="operator">=</span> (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line"><span class="keyword">if</span> (attributes == <span class="literal">null</span>) &#123;</span><br><span class="line">       log.error(<span class="string">&quot;正常日志获取attributes为空,时间：&quot;</span> + System.currentTimeMillis());</span><br><span class="line">       <span class="keyword">return</span>;        </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取请求</span></span><br><span class="line"><span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> attributes.getRequest();</span><br><span class="line"><span class="comment">// 获取响应</span></span><br><span class="line"><span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> attributes.getResponse();</span><br><span class="line"><span class="keyword">if</span> (response == <span class="literal">null</span>) &#123;</span><br><span class="line">      log.error(<span class="string">&quot;正常日志获取response失败,时间：&quot;</span> + System.currentTimeMillis());</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、AOP切入点表达式<br>（1）描述<br>描述一（接口）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行com.xxx.dao包下的BookDao接口中的无参数update方法，void是update的返回类型</span></span><br><span class="line">execution(<span class="keyword">void</span> com.xxx.dao.BookDao.update())</span><br></pre></td></tr></table></figure>
<p>描述二（类）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行com.xxx.dao.impl包下的BookDaoImpl类中的无参数update方法，void是update的返回类型</span></span><br><span class="line">execution(<span class="keyword">void</span> com.xxx.dao.impl.BookDaoImpl.update())</span><br></pre></td></tr></table></figure>
<p>描述三（<code>*</code>）：单个独立的任意符号，可以独立出现，也可以作为前缀或者后缀的匹配符出现。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 匹配com.xxx包下的任意包中的UserService类或接口中所有find开头的带有一个参数的方法</span></span><br><span class="line">execution(<span class="keyword">public</span> * com.xxx.*.UserService.find*(*))</span><br></pre></td></tr></table></figure>
<p>描述四（<code>..</code>）：多个连续的任意符号，可以独立出现，常用于简化包名与参数的书写。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 匹配com包下的任意包中的UserService类或接口中所有名称为findById的方法</span></span><br><span class="line">execution(<span class="keyword">public</span> User com..UserService.findById(..))</span><br></pre></td></tr></table></figure>
<p>描述五（<code>+</code>）：专用于匹配子类类型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* *..*Service + .*(..))</span><br></pre></td></tr></table></figure>
<p>（2）表达式格式说明<br>格式：动作关键字（访问修饰符 返回值 包名.类&#x2F;接口.方法名（参数）异常名）  </p>
<ul>
<li>动作关键字：描述切入点的行为动作，例如<code>execution</code>表示执行到指定切入点。  </li>
<li>访问修饰符：<code>public</code>、<code>private</code>等，可以省略。  </li>
<li>返回值。  </li>
<li>包名。  </li>
<li>类&#x2F;接口名。  </li>
<li>方法名。  </li>
<li>参数。  </li>
<li>异常名：方法定义中抛出指定异常，可以省略。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(<span class="keyword">public</span> User com.xxx.service.UserService.findById(<span class="type">int</span>))</span><br></pre></td></tr></table></figure>

<p>4、通知类型<br>（1）<code>@Around</code> 环绕通知（需要传参<code>ProceedingJoinPoint proce</code>自己调用<code>proce.proceed()</code>方法执行原始方法，下面其他的注解不用调用）<br>此注解标注的通知方法在目标方法前、后都被执行。<br>（2）<code>@Before</code> 前置通知<br>此注解标注的通知方法在目标方法前被执行。<br>（3）<code>@After</code> 后置通知<br>此注解标注的通知方法在目标方法后被执行，无论是否有异常都会执行。<br>（4）<code>@AfterReturning</code> 返回后通知<br>此注解标注的通知方法在目标方法后被执行，有异常不会执行。<br>（5）<code>@AfterThrowing</code> 异常后通知<br>此注解标注的通知方法发生异常后执行。<br>5、通知类型的参数<br>（1）非环绕通知，可以将<code>org.aspectj.lang.JoinPoint</code>作为通知方法的第1个参数，通过这个参数获取被调用方法的信息；  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">JoinPoint</span> &#123;  </span><br><span class="line">    String <span class="title function_">toString</span><span class="params">()</span>;         <span class="comment">//连接点所在位置的相关信息  </span></span><br><span class="line">    String <span class="title function_">toShortString</span><span class="params">()</span>;     <span class="comment">//连接点所在位置的简短相关信息  </span></span><br><span class="line">    String <span class="title function_">toLongString</span><span class="params">()</span>;     <span class="comment">//连接点所在位置的全部相关信息  </span></span><br><span class="line">    Object <span class="title function_">getThis</span><span class="params">()</span>;         <span class="comment">//返回AOP代理对象</span></span><br><span class="line">    Object <span class="title function_">getTarget</span><span class="params">()</span>;       <span class="comment">//返回目标对象  </span></span><br><span class="line">    Object[] getArgs();       <span class="comment">//返回被通知方法参数列表，也就是目前调用目标方法传入的参数  </span></span><br><span class="line">    Signature <span class="title function_">getSignature</span><span class="params">()</span>;  <span class="comment">//返回当前连接点签名，这个可以用来获取目标方法的详细信息，如方法Method对象等</span></span><br><span class="line">    SourceLocation <span class="title function_">getSourceLocation</span><span class="params">()</span>;<span class="comment">//返回连接点方法所在类文件中的位置  </span></span><br><span class="line">    String <span class="title function_">getKind</span><span class="params">()</span>;        <span class="comment">//连接点类型  </span></span><br><span class="line">    StaticPart <span class="title function_">getStaticPart</span><span class="params">()</span>; <span class="comment">//返回连接点静态部分  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（2）如果是环绕通知，可以将<code>org.aspectj.lang.ProceedingJoinPoint</code>作为方法的第1个参数，通过这个参数获取被调用方法的信息。  </p>
<h3 id="3、关于-Springboot-配置文件"><a href="#3、关于-Springboot-配置文件" class="headerlink" title="3、关于 Springboot 配置文件"></a>3、关于 Springboot 配置文件</h3><p>1、配置文件加载优先级<br><code>application.properties</code>配置文件 &gt; <code>application.yml</code>配置文件 &gt; <code>application.yaml</code>配置文件。<br>2、<code>properties</code>配置文件名必须是<code>application.properties</code>，如果想更改它的名字，必须在这里配置：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Springboot1.jpg" class="">
<p>3、不止可以在配置文件中配置，还可以在java属性或者命令行配置<br>（1）idea中设置  </p>
<ul>
<li>java属性配置<br>在idea启动配置里有一项配置：VM options<br>例如：可以在VM options里配置端口号：-Dserver.port&#x3D;8080  </li>
<li>命令行配置<br>同java属性配置，有一项配置：Program arguments<br>例如：在Program arguments里配置端口号：–server.port&#x3D;8080</li>
</ul>
<p>（2）在Dos命令行设置  </p>
<ul>
<li>java属性配置<br>java -Derver.port&#x3D;8080 -jar demo.jar</li>
<li>命令行配置<br>java -jar demo.jar –server.port&#x3D;8080</li>
</ul>
<p><strong>注意优先级：</strong>命令行 &gt; java属性 &gt; 配置文件<br>4、多个.yml文件的使用方法<br>SpringBoot默认加载的是<code>application.yml</code>文件，所以想要引入其他配置的yml文件，就要在<code>application.yml</code>中激活该文件，定义一个<code>application-student.yml</code>文件（注意：必须以application-开头）。<br><code>application.yml</code>中：（注意必须是在<code>application.yml</code>或者<code>.properties</code>)</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span>                    <span class="comment"># 这个也是用来启动多环境的</span></span><br><span class="line">  <span class="attr">profiles:</span>               <span class="comment"># 如果有开发、测试、生产环境</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">student</span>      <span class="comment"># 就用这个来启动</span></span><br></pre></td></tr></table></figure>
<p>（1）赋值（如果是xml的话，它是自动完成的）<br><code>application-student.yml</code>配置文件代码：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">student:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">小明</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">27</span></span><br><span class="line">  <span class="attr">sex:</span> <span class="string">男</span></span><br></pre></td></tr></table></figure>
<p>方案一：使用<code>@Value</code>注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;student.name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;student.age&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;student.sex&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(Integer age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSex</span><span class="params">(String sex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, cat=&quot;</span> + cat +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>如果使用<code>application.properties</code>，需要使用<code>@PropertySource(value=&quot;application.properties&quot;)</code>来加载并在属性上使用<code>@Value(&quot;&quot;)</code>使用。<br>方案二：使用<code>@ConfigurationProperties</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(Integer age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSex</span><span class="params">(String sex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, cat=&quot;</span> + cat +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="4、springboot集成mybatis需要的依赖"><a href="#4、springboot集成mybatis需要的依赖" class="headerlink" title="4、springboot集成mybatis需要的依赖"></a>4、springboot集成mybatis需要的依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mysql驱动 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span> </span><br><span class="line">       <span class="comment">&lt;!-- 这里这个可以换，比如如果要用druid的就导入druid的 --&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-----------------或者只需要以下依赖就可以了---------------------&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.spring.boot/mybatis-spring-boot-starter --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在<code>application.yml</code>中配置数据源：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/数据库名字?serverTimezone=UTC&amp;userUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.mysql.cj.jdbc.MysqlDataSource</span> <span class="comment">#这个依赖导入哪个就用哪个</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">实体类包路径，比如com.cn.pojo</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">mapper的路径，比如classpath:mapper/*.xml</span></span><br></pre></td></tr></table></figure>

<h3 id="5、Springboot-bean的管理"><a href="#5、Springboot-bean的管理" class="headerlink" title="5、Springboot bean的管理"></a>5、Springboot bean的管理</h3><p>1、获取bean：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">public</span> ApplicationContext applicationContext;</span><br></pre></td></tr></table></figure>
<p>2、非第三方bean管理<br>我们将一个类注入到<code>spring</code>容器中成为一个<code>bean</code>对象，默认是单例；要想多例只需在该类上加上<code>@Scope(&quot;prototype&quot;)</code>注解，例如：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>3、第三方bean管理<br>第三方bean：比如第三方的jar包，我们无法在第三方jar中某个类上面使用<code>@Component、@Service</code>等注解的情况下，就使用<code>@Bean</code>注解，举个场景：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// 我们想使用JSONObject，必须new</span></span><br><span class="line">    <span class="type">JSONObject</span> <span class="variable">jSONObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面这个场景，我们不能在<code>JSONObject</code>类上面使用注解<code>@Component、@Service</code>来将它注入到容器中，但是我们可以这样：<br>在<code>springboot</code>启动类里，把<code>JSONObject</code>类注入到<code>spring</code>容器中<strong>（不过在启动类中定义是不推荐的，推荐的是在配置类中定义）</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringbootDemo</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        SpringApplication.run(SpringbootDemo.class,args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">// 将当前方法的返回值对象交给IOC容器管理，成为IOC容器bean</span></span><br><span class="line">    <span class="keyword">public</span> JSONObject <span class="title function_">jSONObject</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4、多个<code>bean</code>使用方法<br>概述：<br>通过<code>Spring</code>管理的类,默认是单例模式,但是如果有的类需要使用独立的属性,则需要配置为多例模式的. 但是多例模式不仅仅只是加一个声明,使用<code>@Autowired</code>进行注入,可能并不会是你想要的结果.因为多例模式的类是需要单独调用的。<br>不搞清楚原理直接测试：<br>需要多例的类上加上注解<code>@Scope(“prototype”)</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExampleService</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;test,current bean is&quot;</span> + <span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">引用直接使用<span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExampleService</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ExampleService exampleService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(&quot;test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        exampleService.test();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">结果: 每个request过来的时候,exampleService实例均为同一个实例.</span><br><span class="line"></span><br><span class="line">解决办法：</span><br><span class="line">第一种：不使用<span class="meta">@Autowired</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExampleService</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> org.springframework.beans.factory.BeanFactory beanFactory;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(&quot;test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ExampleService</span> <span class="variable">exampleService</span> <span class="operator">=</span> beanFactory.getBean(ExampleService.class);</span><br><span class="line">        exampleService.test();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">第二种：使用bean工厂</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ApplicationContext context;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> WebSocketHandler <span class="title function_">websocketBHandler</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">PerConnectionWebSocketHandler</span> <span class="variable">perConnectionHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PerConnectionWebSocketHandler</span>(WebSocketBHandler.class);</span><br><span class="line">    perConnectionHandler.setBeanFactory(context.getAutowireCapableBeanFactory());</span><br><span class="line">    <span class="comment">//设置bean工厂，否则bean工厂WebSocketBHandler将不会自动连接</span></span><br><span class="line">    <span class="keyword">return</span> perConnectionHandler;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">然后使用ApplicationContext进行代理bean工厂</span><br><span class="line"></span><br><span class="line">注入</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ApplicationContext context;</span><br><span class="line">使用</span><br><span class="line"><span class="built_in">this</span>.Bservice = context.getBean(BService.class, <span class="built_in">this</span>);</span><br></pre></td></tr></table></figure>

<h3 id="6、Springboot自动配置加载流程"><a href="#6、Springboot自动配置加载流程" class="headerlink" title="6、Springboot自动配置加载流程"></a>6、Springboot自动配置加载流程</h3><p>1、说明<br>（1）导入 <code>starter</code> ，就会导入 <code>autoconfigure</code> 包；<br>（2）<code>autoconfigure</code> 包里面有一个文件： <code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</code> ，<br>里面指定的是启动要加载的所有自动配置类；<br>（3）<code>@EnableAutoConfiguration</code> 会自动的把上面文件里面写的所有自动配置类都导入进<code>spring</code>容器；<br>（4）自动配置类中的 <code>xxxAutoConfiguration</code> 是有条件注解，来进行按需加载的；<br>（5）<code>xxxAutoConfiguration</code> 给容器中导入一堆组件，组件都是从 <code>xxxProperties</code> 中提取属性值的；<br>（6）<code>xxxProperties</code> 又是和配置文件进行了绑定。<br>2、<code>springboot</code>默认配置说明<br>（1）包含了 <code>ContentNegotiatingViewResolver</code> 和 <code>BeanNameViewRseolver</code> 组件，方便视图解析。<br>（2）默认的静态资源处理机制：静态资源在static文件夹下即可直接访问。<br>（3）自动注册了 <code>Converter</code>，<code>GenericConverter</code>，<code>Formatter</code> 组件，适配常见数据类型转换和格式化需求。<br>（4）支持 <code>HttpMessageConverters</code>，可以方便返回<code>json</code>等数据类型。<br>（5）自动使用 <code>ConfigurableWebBindingInitializer</code>，实现消息处理、数据绑定、类型转化、数据校验等功能。<br><strong>重要：</strong><br>（1）如果想保持默认配置，并且自定义更多配置，如：<code>interceptors（拦截器）、formatters（格式化器）、viewControllers（视图解析器）</code>等，可以创建一个新类，使用 <code>@Configuration</code> 注解和实现一个 <code>WebMvcConfigurer</code>接口，并且不要标注 <code>@EnableWebMvc</code> 注解。<br>（2）如果想保持默认配置，但要自定义核心组件实例，比如：<code>RequestMappingHandlerMapping，RequestMappingHandlerAdapter，ExceptionHandlerExceptionResolver</code>等，只需给容器中放一个 <code>WebMvcRegistrations</code> 组件即可。<br>（3）如果想全面接管<code>SpringMvc</code>，<code>@Configuration</code>标注一个配置类，并加上<code>@EnableWebMvc</code>注解，实现<code>WebMvcConfigurer</code>接口。<br>3、<code>WebMvcConfigurer</code>接口方法说明<br>（1）<code>addArgumentResolvers</code>：参数解析器，用来解析<code>Controller</code>中各方法的参数。<br>（2）<code>addCorsMappings</code>：跨域<br>（3）<code>addFormatters</code>：格式化器，用来处理配置文件中格式化的问题。<br>（4）<code>addInterceptors</code>：拦截器<br>（5）<code>addResourceHandlers</code>：资源处理器，处理静态资源规则。<br>（6）<code>addReturnValueHandlers</code>：返回值处理器，当<code>controller</code>返回一个字符串或者对象等时，是要跳转页面还是返回数据。<br>（7）<code>addViewControllers</code>：视图控制器，如果想发一个请求 <code>/a</code> 直接跳转到<code>xxx.html</code>页面，不用写<code>controller</code>，可以在这里设置。<br>（8）<code>configureAsyncSupport</code>：异步支持<br>（9）<code>configureContentNegotiation</code>：内容协商<br>（10）<code>configureHandlerExceptionResolvers</code>：配置异常处理解析器。<br>（11）<code>configureMessageConverters</code>：配置消息转换器<br>（12）<code>configurePathMatch</code>：路径匹配<br>（13）<code>configureViewResolvers</code>：配置视图解析器  </p>
<h3 id="7、循环依赖问题"><a href="#7、循环依赖问题" class="headerlink" title="7、循环依赖问题"></a>7、循环依赖问题</h3><p>1、三级缓存<br>（1）一级缓存（单例池）：<code>singletonObjects</code>，用来存经历过完整生命周期的bean；<br>（2）二级缓存：<code>earlySingletonObjects</code>，用来存还没有初始化的aop代理对象；<br>（3）三级缓存：<code>singletonFactories</code>。<br>2、代码  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">AService &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> BService bService;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BService &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> AService aService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面产生了循环依赖。<br>3、说明  </p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Springboot6.jpg" class="">

<h3 id="8、Springboot源码名词"><a href="#8、Springboot源码名词" class="headerlink" title="8、Springboot源码名词"></a>8、Springboot源码名词</h3><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.png" class="">  
<p>说明一：在springboot源码中用到的<code>ConfigurableApplicationContext</code>是接口，而官网springframework中使用到的<code>GenericApplicationContext</code>是<code>ConfigurableApplicationContext</code>的实现类。<br>说明二：<code>FactoryBean</code>和<code>BeanFactory</code>区别<br>（1）<code>FactoryBean</code>：是Spring中一种特殊的bean，可以在getObject()工厂方法自定义的逻辑创建bean，是一种能够生产其他bean的bean。FactoryBean在容器启动时被创建，而在实际使用时，通过调用getObject()方法来得到其所生产的bean。因此，FactoryBean可以自定义任何所需的初始化逻辑，生产出一些定制化的bean。<br>（2）<code>BeanFactory</code>：是Spring框架的基础，其作为一个顶级接口定义了容器的基本行为，例如管理bean的生命周期、配置文件的加载和解析、bean的装配和依赖注入等。BeanFactory接口提供了访问bean的方式，例如getBean()方法获取指定的bean实例。它可以从不同的来源（例如Mysql数据库、XML文件、Java配置类等）获取bean定义，并将其转换为bean实例。同时，BeanFactory还包含很多子类（例如ApplicationContext接口）提供了额外的强大功能。<br>1、<code>BeanFactory</code>：是接口，位于<code>org.springframework.beans</code>包下，它是bean的一个工厂，它定义了各种获取bean的方法、判断bean是否存在、判断bean是否单例等针对bean的基础方法；<br>2、<code>ApplicationContext</code>：是接口，位于<code>org.springframework.context</code>包下，它就是springIOC容器，它继承了<code>BeanFactory</code>接口，查看源码可以看到它是先继承了<code>ListableBeanFactory</code>接口，再继承的<code>BeanFactory</code>接口，它负责实例化、配置、组装bean；<br>3、<code>ListableBeanFactory</code>：是接口，它继承了<code>BeanFactory</code>接口，在<code>BeanFactory</code>的基础上，扩展了bean的查询方法，例如：根据类型获取beanNames、根据注解获取beanNames、根据bean获取注解；<br>4、<code>AutowireCapableBeanFactory</code>：是接口，它继承了<code>BeanFactory</code>接口，在<code>BeanFactory</code>的基础上，提供了bean的创建、配置、注入、销毁等操作（<strong>注意</strong>：有时候我们需要自己手动注入bean的时候，可以考虑通过实现该接口来完成）；<br>5、<code>HierarchicalBeanFactory</code>：是接口，它继承了<code>BeanFactory</code>接口，在<code>BeanFactory</code>的基础上添加了获取parent beanfactory的方法；<br>6、<code>SingletonBeanRegistry</code>：是接口，定义了对单例bean的定义以及获取方法；<br>7、<code>ConfigurableBeanFactory</code>：是接口，它继承了<code>SingletonBeanRegistry</code>接口和<code>HierarchicalBeanFactory</code>接口，它定义了针对<code>BeanFactory</code>的各种配置以及销毁方法；<br>8、<code>ConfigurableListableBeanFactory</code>：是接口，它继承了<code>ListableBeanFactory</code>接口、<code>AutowireCapableBeanFactory</code>接口和<code>ConfigurableBeanFactory</code>接口，它是<code>BeanFactory</code>的配置清单，这里定义了忽略的类型、接口，通过bean的名词获取BeanDefinition，冻结BeanDefinition等；<br>9、<code>AliasRegistry</code>（alias是别名）：是接口，它定义了对alias的注册、移除、判断以及查询操作；<br>10、<code>SimpleAliasRegistry</code>：是类，它实现了<code>AliasRegistry</code>接口中的所有方法，它还使用ConcurrentHashMap做载体，实现对alias的注册、移除、判断以及查询操作；<br>11、<code>DefaultSingletonBeanRegistry</code>：是类，它继承了<code>SimpleAliasRegistry</code>类，实现了<code>SingletonBeanRegistry</code>接口，这个类基于java中的集合，对<code>SingletonBeanRegistry</code>接口进行了实现；<br>12、<code>FactoryBeanRegistrySupport</code>：是类，继承了<code>DefaultSingletonBeanRegistry</code>类，在<code>DefaultSingletonBeanRegistry</code>的基础上，增加了获取FactoryBean类型、移除FactoryBean缓存的方法等；<br>13、<code>AbstractBeanFactory</code>：是类，继承了<code>FactoryBeanRegistrySupport</code>类，实现了<code>ConfigurableBeanFactory</code>接口；<br>14、<code>AbstractAutowireCapableBeanFactory</code>：是类，它继承了<code>AbstractBeanFactory</code>类，实现了<code>AutowireCapableBeanFactory</code>接口的所有方法；<br>15、<code>BeanDefinitionRegistry</code>：是接口，它继承了<code>AliasRegistry</code>接口，增加了一系列针对<code>BeanDefinition</code>的注册、移除、查询、判断等方法；<br>16、<code>DefaultListableBeanFactory</code>：是类，它继承了<code>AbstractAutowireCapableBeanFactory</code>类，实现了<code>BeanDefinitionRegistry</code>（定义了关于BeanDefinition的注册、移除、查询）、<code>ConfiguraListableBeanFactory</code>和<code>Serializable</code>（序列化接口）接口，它是bean工厂的一个默认实现类，提供了原始的BeanFactory的功能，如：对外提供getBean()方法，这个方法有两种方式获取bean，第一种方式是<code>AbstractBeanFactory</code>中提供的，根据名称获取bean；第二种方式是它自己的，根据类型获取bean（这种方式属于getBean方法的扩展）。<code>beanDefinitionMap</code>属性是beanDefinition信息表；<br>17、<code>InitializingBean</code><br>说明：是spring提供的扩展性接口，<code>InitializingBean</code>接口为bean提供了属性初始化后的处理方法，它只有一个方法，只要实现了该接口的类，所创建出来的bean，在bean初始化后都会执行该方法。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> <span class="keyword">implements</span> <span class="title class_">InitializingBean</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Test</span><span class="params">()</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;构造方法执行&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;afterPropertiesSet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@PostConstruct</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postConstruct</span><span class="params">()</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;@PostConstruct&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;init&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean(initMethod = &quot;init&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> Test <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 输出：输出优先级：构造方法执行 &gt; <span class="doctag">@PostConstruct</span> &gt; afterPropertiesSet &gt; init</span></span><br><span class="line"><span class="comment"> * 构造方法执行</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@PostConstruct</span></span></span><br><span class="line"><span class="comment"> * afterPropertiesSet</span></span><br><span class="line"><span class="comment"> * init</span></span><br><span class="line"><span class="comment"> *  </span></span><br><span class="line"><span class="comment"> *  说明：</span></span><br><span class="line"><span class="comment"> *  在spring初始化bean的时候，如果该bean实现了InitializingBean接口，</span></span><br><span class="line"><span class="comment"> *  并且同时配置了init-method，系统则是先调用afterPropertieSet()方法，</span></span><br><span class="line"><span class="comment"> *  然后再调用init-method中指定的方法。</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>


<br/>

<hr>
<br/>



<h1 id="二、Springboot使用方法"><a href="#二、Springboot使用方法" class="headerlink" title="二、Springboot使用方法"></a>二、Springboot使用方法</h1><h3 id="1、要想在tomcat中启动项目"><a href="#1、要想在tomcat中启动项目" class="headerlink" title="1、要想在tomcat中启动项目"></a>1、要想在tomcat中启动项目</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringbootApplication</span> <span class="keyword">extends</span> <span class="title class_">SpringBootServletInitializer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SpringbootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//要想在tomcat中使用war包启动springboot项目，首先 先继承 SpringBootServletInitializer</span></span><br><span class="line">    <span class="comment">//然后在使用下面的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> SpringApplicationBuilder <span class="title function_">configure</span><span class="params">(SpringApplicationBuilder application)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> application.sources(SpringbootApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、在配置文件中配置静态资源"><a href="#2、在配置文件中配置静态资源" class="headerlink" title="2、在配置文件中配置静态资源"></a>2、在配置文件中配置静态资源</h3><p>默认的静态资源路径为：<br>1、<code>classpath:/static/</code><br>2、<code>classpath:/public/</code><br>3、<code>classpath:/resources/</code><br>4、<code>classpath:/META-INF/resources/</code>  </p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span> </span><br><span class="line">    <span class="attr">mvc:</span> </span><br><span class="line">        <span class="attr">static-path-pattern:</span> <span class="string">/res/**</span>  <span class="comment">#修改静态资源访问路径，项目路径+/res/**</span></span><br><span class="line">    <span class="attr">resources:</span> </span><br><span class="line">        <span class="attr">static-locations:</span> <span class="string">classpath:/zuo</span>  <span class="comment">#修改静态资源存放路径，修改之后只有将静态资源放到zuo目录下才能被访问到。</span></span><br></pre></td></tr></table></figure>

<h3 id="3、springboot各种pom文件需要和学习指南地址"><a href="#3、springboot各种pom文件需要和学习指南地址" class="headerlink" title="3、springboot各种pom文件需要和学习指南地址"></a>3、springboot各种pom文件需要和学习指南地址</h3><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.0.3.RELEASE/reference/htmlsingle/#using-boot-starter">springboot各种pom文件需要和学习指南地址</a></p>
<h3 id="4、Springboot读配置的4种方式"><a href="#4、Springboot读配置的4种方式" class="headerlink" title="4、Springboot读配置的4种方式"></a>4、Springboot读配置的4种方式</h3><p>1、<code>@Value</code>注解<br><strong>使用该注解需要注意：</strong><br>（1）该类必须注入<code>spring</code>容器中，才能使用<code>@Value</code>注解获取配置文件中的数据。<br>（2）配置文件里必须有该属性，不然启动会报异常。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @Value(&quot;$&#123;user.name:默认值&#125;&quot;) 为了不报异常，可以加默认值，如果是：&quot;$&#123;user.name:&#125;&quot;，表示值为&quot;&quot;</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;user.name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userName; <span class="comment">// 如果属性有static和final关键字的话是无法生效的</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、<code>@ConfigurationProperties</code>注解<br>只需要指定配置文件中某一个key的前缀就可以了。例如：<br>（1）配置文件</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">demo:</span></span><br><span class="line">    <span class="attr">userName:</span> <span class="string">xxx</span></span><br></pre></td></tr></table></figure>
<p>（2）JavaDemo</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;demo&quot;)</span> <span class="comment">// 这里的命名规范：要么全小写，要么小写-小写（xxx-xxx）格式，不能下划线</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：使用<code>@ConfigurationProperties</code>注解，必须将bean给spring管理。  </p>
<ol>
<li>方法一：在配置类上使用<code>@EnableConfigurationProperties(&#123;Demo.class&#125;)</code>；  </li>
<li>方法二：在实体类上使用<code>@Component</code>注解。</li>
</ol>
<p>3、通过<code>Environment</code>类动态获取（是spring底层提供的API）<br>（1）第一种实现方式，实现<code>EnvironmentAware</code>接口，重写<code>setEnvironment</code>方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> <span class="keyword">implements</span> <span class="title class_">EnvironmentAware</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Environment env;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEnvironment</span><span class="params">(Environment e)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.env = e;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">	    <span class="type">String</span> <span class="variable">var</span> <span class="operator">=</span> env.getProperty(<span class="string">&quot;demo.userName&quot;</span>);</span><br><span class="line">	    System.out.println(<span class="string">&quot;从配置文件获取&quot;</span> + <span class="keyword">var</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（2）第二种通过自动注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> Environment env;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">var</span> <span class="operator">=</span> env.getProperty(<span class="string">&quot;demo.name&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;从配置文件获取&quot;</span> + <span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>以上三种是获取默认的配置文件，要想获取自定义的配置文件可以通过下面的方法：</strong>  </p>
<ol>
<li>默认的配置文件：<code>application</code>开头  </li>
<li>自定义：<code>demo.properties</code></li>
</ol>
<p>4、<code>@PropertySource</code>注解<br>只能获取<code>properties</code>的配置文件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@PropertySources(@PropertySource(value = &quot;classpath:demo.properties&quot;,encoding = &quot;utf-8&quot;))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;user.name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要想获取yml的需要设置配置类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyYmlConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> PropertySourcesPlacehokderConfigurer <span class="title function_">yamlConfigurer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">PropertySourcesPlacehokderConfigurer</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PropertySourcesPlacehokderConfigurer</span>();</span><br><span class="line">        <span class="type">YamlPropertiesFactory</span> <span class="variable">y</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">YamlPropertiesFactory</span>();</span><br><span class="line">        y.setResources(<span class="keyword">new</span> <span class="title class_">ClassPathResource</span>(<span class="string">&quot;demo.yml&quot;</span>));</span><br><span class="line">        p.setProperties(Objects.requireNonNull(y.getObject()));</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后就可以通过第一种方式@Value注解获取。  </p>
<h3 id="5、Springboot获取bean对象方法"><a href="#5、Springboot获取bean对象方法" class="headerlink" title="5、Springboot获取bean对象方法"></a>5、Springboot获取bean对象方法</h3><p>1、启动获取<code>ApplicationContext</code><br>在项目启动时先获取 <code>ApplicationContext</code> 对象，然后将其存储在一个地方，以便后续用到时进行使用。<br>这里提供两种场景的获取：<br>（1）基于 <code>xml</code> 配置 <code>bean</code> 的形式，适用于比较古老的项目，已经很少使用了；<br>（2）基于 <code>SpringBoot</code> 启动时获取 <code>ApplicationContext</code> 对象；<br><strong>基于 xml 的形式实现：</strong><br>其中<code>applicationContext.xml</code> 为配置容器的<code>xml</code>，不过现在一般很少使用了。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">ac</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileSystemXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>这里等于直接初始化容器，并且获得容器的引用。这种方式适用于采用 <code>Spring</code> 框架的独立应用程序，需要程序通过配置文件手工初始化 <code>Spring</code> 的情况。目前大多数 <code>Spring</code> 项目已经不再采用 <code>xml</code> 配置，很少使用了。<br><strong>基于 SpringBoot 启动实现：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExampleApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 启动时，保存上下文，并保存为静态</span></span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">ac</span> <span class="operator">=</span> SpringApplication.run(ExampleApplication.class, args);</span><br><span class="line">        SpringContextUtil.setApplicationContext(ac);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对应的 SpringContextUtil 类如下：</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringContextUtil1</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ApplicationContext ac;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(String beanName, Class&lt;T&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">bean</span> <span class="operator">=</span> ac.getBean(beanName, clazz);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span>&#123;</span><br><span class="line">        ac = applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>两种方式都是在启动 <code>Spring</code> 项目时，直接获取到 <code>ApplicationContext</code> 的引用，然后将其存储到工具类当中。在使用时，则从工具类中获取 <code>ApplicationContext</code> 容器，进而从中获得 <code>Bean</code> 对象。</p>
<p>2、通过继承<code>ApplicationObjectSupport</code><br>此种方式依旧是先获得 <code>ApplicationContext</code> 容器，然后从中获取 <code>Bean</code> 对象，只不过是基于继承 <code>ApplicationObjectSupport</code> 类实现的，具体实现代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringContextUtil</span> <span class="keyword">extends</span> <span class="title class_">ApplicationObjectSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(Class&lt;T&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ac</span> <span class="operator">=</span> getApplicationContext();</span><br><span class="line">        <span class="keyword">if</span>(ac == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ac.getBean(clazz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>这里的 <code>SpringContextUtil</code> 类需要实例化。<br><code>ApplicationObjectSupport</code> 类图，我们看到它实现了 <code>ApplicationContextAware</code> 接口，在 <code>Spring</code> 容器初始化过程中回调方法 <code>setApplicationContext</code> 来完成 <code>ApplicationContext</code> 的赋值。</p>
<p>3、通过继承<code>WebApplicationObjectSupport</code><br><code>WebApplicationObjectSupport</code> 是 <code>ApplicationObjectSupport</code> 的一个实现类，提供了 <code>Web</code> 相关的支持。实现原理与 <code>ApplicationObjectSupport</code> 一样，具体实现代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringContextUtil</span> <span class="keyword">extends</span> <span class="title class_">WebApplicationObjectSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(Class&lt;T&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ac</span> <span class="operator">=</span> getApplicationContext();</span><br><span class="line">        <span class="keyword">if</span>(ac == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ac.getBean(clazz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过类图我们可以看到它是 <code>ApplicationObjectSupport</code> 的实现子类，此方式除了继承对象不同外，没有其他区别，都是基于 <code>getApplicationContext</code> 方法来获取。</p>
<p>4、通过<code>WebApplicationContextUtils</code><br>Spring提供了工具类<code>WebApplicationContextUtils</code>，通过该类可获取<code>WebApplicationContext</code>对象，具体实现代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringContextUtil2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(ServletContext request, String name, Class&lt;T&gt; clazz)</span>&#123;</span><br><span class="line">        <span class="comment">// 或者 WebApplicationContext webApplicationContext1 = WebApplicationContextUtils.getWebApplicationContext(request);</span></span><br><span class="line">        <span class="type">WebApplicationContext</span> <span class="variable">webApplicationContext</span> <span class="operator">=</span> WebApplicationContextUtils.getRequiredWebApplicationContext(request);</span><br><span class="line">        <span class="comment">// webApplicationContext1.getBean(name, clazz)</span></span><br><span class="line">        <span class="type">T</span> <span class="variable">bean</span> <span class="operator">=</span> webApplicationContext.getBean(name, clazz);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个方法很常见于 <code>SpringMVC</code> 构建的 Web 项目中，适用于 Web 项目的 B&#x2F;S 结构。</p>
<p>5、通过<code>ApplicationContextAware</code><br>通过实现<code>ApplicationContextAware</code>接口，在Spring容器启动时将<code>ApplicationContext</code>注入进去，从而获取<code>ApplicationContext</code>对象，这种方法也是常见的获取Bean的一种方式，推荐使用，具体实现代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringContextUtil3</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextAware</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ApplicationContext ac;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        ac = applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(Class&lt;T&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">bean</span> <span class="operator">=</span> ac.getBean(clazz);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种方式与前面通过 <code>BeanFactoryAware</code> 获得 <code>BeanFactory</code> 的思路一致。</p>
<p>6、通过<code>ContextLoader</code><br>使用 <code>ContextLoader</code> 提供的 <code>getCurrentWebApplicationContext</code> 方法，也是常用的获取 <code>WebApplicationContext</code> 的一种方法，具体实现代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">WebApplicationContext</span> <span class="variable">wac</span> <span class="operator">=</span> ContextLoader.getCurrentWebApplicationContext();</span><br><span class="line">wac.getBean(beanID);</span><br></pre></td></tr></table></figure>
<p>该方法常见于 SpringMVC 实现的 Web 项目中。该方式是一种不依赖于 Servlet，不需要注入的方式。但是需要注意一点，在服务器启动时和 Spring 容器初始化时，不能通过该方法获取 Spring 容器。</p>
<p>7、通过<code>BeanFactoryPostProcessor</code><br>Spring 工具类，方便在非 Spring 管理环境中获取 Bean。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">SpringUtils</span> <span class="keyword">implements</span> <span class="title class_">BeanFactoryPostProcessor</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Spring应用上下文环境 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ConfigurableListableBeanFactory beanFactory;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postProcessBeanFactory</span><span class="params">(ConfigurableListableBeanFactory beanFactory)</span> <span class="keyword">throws</span> BeansException&#123;</span><br><span class="line">        SpringUtilsS.beanFactory = beanFactory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取对象</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> Object 一个以所给名字注册的bean的实例</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> BeansException</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(String name)</span> <span class="keyword">throws</span> BeansException&#123;</span><br><span class="line">        <span class="keyword">return</span> (T) beanFactory.getBean(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取类型为requiredType的对象</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> clz</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> BeansException</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(Class&lt;T&gt; clz)</span> <span class="keyword">throws</span> BeansException&#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">result</span> <span class="operator">=</span> (T) beanFactory.getBean(clz);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 如果BeanFactory包含一个与所给名称匹配的bean定义，则返回true</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> boolean</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">containsBean</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beanFactory.containsBean(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 判断以给定名字注册的bean定义是一个singleton还是一个prototype。 如果与给定名字相应的bean定义没有被找到，将会抛出一个异常（NoSuchBeanDefinitionException）</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> boolean</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> NoSuchBeanDefinitionException</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isSingleton</span><span class="params">(String name)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException&#123;</span><br><span class="line">        <span class="keyword">return</span> beanFactory.isSingleton(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> Class 注册对象的类型</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> NoSuchBeanDefinitionException</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Class&lt;?&gt; getType(String name) <span class="keyword">throws</span> NoSuchBeanDefinitionException&#123;</span><br><span class="line">        <span class="keyword">return</span> beanFactory.getType(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 如果给定的bean名字在bean定义中有别名，则返回这些别名</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> NoSuchBeanDefinitionException</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String[] getAliases(String name) <span class="keyword">throws</span> NoSuchBeanDefinitionException&#123;</span><br><span class="line">        <span class="keyword">return</span> beanFactory.getAliases(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取aop代理对象</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> invoker</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getAopProxy</span><span class="params">(T invoker)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (T) AopContext.currentProxy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中 ConfigurableListableBeanFactory 接口，也属于 BeanFactory 的子接口。</p>
<h3 id="6、怎么使用好springboot自动配置"><a href="#6、怎么使用好springboot自动配置" class="headerlink" title="6、怎么使用好springboot自动配置"></a>6、怎么使用好springboot自动配置</h3><p>1、选场景：<code>spring-boot-starter-data-redis</code><br>然后找到这个场景的自动配置类 <code>xxxAutoConfiguration</code><br>2、写配置<br>在这个自动配置类中，找到 <code>@EnableConfigurationProperties(xxxProperties.class)</code> 分析开启了哪些属性绑定关系,修改redis相关的配置<br>3、分析组件<br>在 <code>xxxAutoConfiguration</code> 这个自动配置类中分析，因为有两个方法，表示这个自动配置类给容器中放了两个组件，有一个组件（方法）叫 <code>stringRedisTemplate</code> ，然后去业务代码中使用自动装配注解装配这个方法。（使用组件的前提是，知道这个组件是干嘛的）<br>4、定制化（如果不满足需求，需要定制化）<br>自定义组件，自己写一个 <code>stringRedisTemplate</code> 方法，并放到容器中（自动配置类中的 <code>stringRedisTemplate</code> 这个方法上面标注了 <code>@ConditionalOnMissingBean</code>，这个注解的作用就是如果我们自己写了下面的方法，则这个自动配置类就不加载这个方法，容器中使用我们自己自定义的方法。）<br>5、例子：自定义starter启动类<br>（1）步骤：  </p>
<ul>
<li>创建 aliyun-oss-spring-boot-starter 模块。（只负责依赖管理）  </li>
<li>创建 aliyun-oss-spring-boot-autoconfigure 模块，在 starter 模块引入该模块</li>
<li>在 aliyun-oss-spring-boot-autoconfigure 模块中定义自动配置功能，并定义自动配置文件 META-INF&#x2F;spring&#x2F;xxx.imports （老版本的为 META-INF&#x2F;spring.factories）</li>
</ul>
<p>（2）实例（对应上面的步骤）  </p>
<ol>
<li>创建 aliyun-oss-spring-boot-starter 模块：<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Springboot2.jpg" class="">
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Springboot3.jpg" class="">
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Springboot4.jpg" class=""></li>
<li>创建 aliyun-oss-spring-boot-autoconfigure 模块，在 starter 模块引入该模块，pom文件同上：<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Springboot5.jpg" class="">
注意：没有启动类、配置文件、测试类。</li>
</ol>
<ul>
<li>在步骤<code>1.</code>创建的模块pom文件中加入步骤<code>2.</code>创建的模块依赖：<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-oss-spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPDHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>在步骤<code>2.</code>创建的模块pom文件中引入oss依赖：<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-sdk-oss<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.15.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.xml.bind<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.activation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>activation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.glassfish.jaxb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-runtime<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>在<code>2.</code>模块中创建 <code>AliOSSProperties</code> 类 和 <code>AliOSSUtils</code> 类：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;aliyun.oss&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliOSSProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line">    <span class="keyword">private</span> String accessKeyId;</span><br><span class="line">    <span class="keyword">private</span> String accessKeySecret;</span><br><span class="line">    <span class="keyword">private</span> String bucketName;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// get 和 set 方法.....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliOSSUtils</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> AliOSSProperties aliOSSProperties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// aliOSSProperties 的get方法</span></span><br><span class="line">    <span class="keyword">public</span> AliOSSProperties <span class="title function_">getAliOSSProperties</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> aliOSSProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// aliOSSProperties 的set方法</span></span><br><span class="line">    <span class="keyword">public</span> AliOSSProperties <span class="title function_">setAliOSSProperties</span><span class="params">(AliOSSProperties aliOSSProperties)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.aliOSSProperties = aliOSSProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">endpoint</span> <span class="operator">=</span> aliOSSProperties.getEndpoint();</span><br><span class="line">        String accessKeyId= aliOSSProperties.getAccessKeyId();</span><br><span class="line">        String accessKeySecret= aliOSSProperties.getAccessKeySecret();</span><br><span class="line">        String bucketName= aliOSSProperties.getBcketName();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取上传的文件输入流</span></span><br><span class="line">        <span class="type">InputStrem</span> <span class="variable">inputStream</span> <span class="operator">=</span> file.getInputStream();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 避免文件名重复导致被覆盖</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">originalFileName</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> UUID.randomUUID().toString() + originalFileName.substring(originalFileName.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 上传文件到OSS</span></span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(endpoint,accessKeyId,accessKeySecret);</span><br><span class="line">        ossClient.putObject(bucketName,fileName,inputStream);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 拼接文件访问路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> endpoint.split(<span class="string">&quot;//&quot;</span>)]<span class="number">0</span>] + <span class="string">&quot;//&quot;</span> + bucketName + <span class="string">&quot;.&quot;</span> + endpoint.split(<span class="string">&quot;//&quot;</span>)[<span class="number">1</span>] + <span class="string">&quot;/&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 关闭ossClient</span></span><br><span class="line">        ossClient.shutdown();</span><br><span class="line">        <span class="keyword">return</span> url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>2.</code>模块中创建 AliOSSAutoConfiguration 配置类：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(AliOSSProperties.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliOSSAutoConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> AliOSSUtils <span class="title function_">aliOSSUtils</span><span class="params">(AliOSSProperties aliOSSProperties)</span> &#123;</span><br><span class="line">        <span class="type">AliOSSUtils</span> <span class="variable">aliOSSUtils</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AliOSSUtils</span>();</span><br><span class="line">        aliOSSUtils.setAliOSSProperties(aliOSSProperties);</span><br><span class="line">        <span class="keyword">return</span> aliOSSUtils;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="3">
<li>在 <code>aliyun-oss-spring-boot-autoconfigure</code> 模块中定义自动配置功能，并定义自动配置文件 <code>META-INF/spring/xxx.imports</code> （老版本的为 <code>META-INF/spring.factories</code>）</li>
</ol>
<ul>
<li>在<code>2.</code>模块的<code>resource</code>目录下创建文件夹 <code>META-INF</code>，继续在<code>META-INF</code>文件夹下创建<code>spring</code>文件夹，继续在<code>spring</code>文件夹下创建：<code>org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>文件</li>
<li>将 <code>AliOSSAutoConfiguration</code> 类的全类名填入<code>org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>文件中</li>
</ul>
<h3 id="7、springboot多环境配置"><a href="#7、springboot多环境配置" class="headerlink" title="7、springboot多环境配置"></a>7、springboot多环境配置</h3><p>1、<code>properties</code>文件<br>将应用程序的配置参数分离到不同的<code>properties</code>文件中，每个环境对应一个<code>properties</code>文件。例如，可以创建<code>application-dev.properties</code>、<code>application-prod.properties</code>和<code>application-test.properties</code>等文件，在这些文件中，可以定义各自环境的配置参数，如数据库连接信息、端口号等，然后在<code>application.properties</code>中通过<code>spring.profiles.active</code>属性指定当前使用的环境，springboot会根据该属性来加载对应环境的<code>properties</code>文件，覆盖默认的配置。<br>2、<code>yml</code>文件<br>同<code>properties</code>文件。<br>3、命令行参数（动态）<br>可以通过命令行参数来指定当前的环境，例如，使用<code>--spring.profiles.active=dev</code>来指定使用开发环境。  </p>
<h3 id="8、springboot打包插件"><a href="#8、springboot打包插件" class="headerlink" title="8、springboot打包插件"></a>8、springboot打包插件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>



<br/>

<hr>
<br/>

<h1 id="三、Springboot其他组件"><a href="#三、Springboot其他组件" class="headerlink" title="三、Springboot其他组件"></a>三、Springboot其他组件</h1><h3 id="1、全局异常处理器"><a href="#1、全局异常处理器" class="headerlink" title="1、全局异常处理器"></a>1、全局异常处理器</h3><p>说明：<br>当出现异常的时候，会把异常抛到前端，抛出数据格式不符合规范，所以我们必须在每个controller中去处理异常，这样的话每个controller类中的方法都要去写这个处理的过程，太繁琐了，所以我们就要弄一个全局异常处理器。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span>&#123;</span><br><span class="line">    <span class="comment">// 这个注解的作用是指定 要捕获的异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">ex</span><span class="params">(Exception ex)</span>&#123;</span><br><span class="line">        ex.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> Result.error(<span class="string">&quot;对不起，操作失败，请联系管理员&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、过滤器和拦截器"><a href="#2、过滤器和拦截器" class="headerlink" title="2、过滤器和拦截器"></a>2、过滤器和拦截器</h3><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/3.png" class="">  
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.png" class="">  
<p>说明：过滤器是在浏览器发送请求到服务器（<code>DispatchServlet</code>）之前，而拦截器是在<code>handlerAdpater</code>与<code>handler</code>之间，以及视图返回到<code>DispatchServlet</code>之间。<br>1、过滤器<br><code>Filter</code>快速入门（是<code>javax.servlet</code>下的）：<br>（1）定义<code>Filter</code><br>定义一个类，实现<code>Filter</code>接口，并重写其所有方法。<br>（2）配置<code>Filter</code><br><code>Filter</code>类上加<code>@WebFilter</code>注解，配置拦截资源的路径，启动类上加<code>@ServletComponentScan</code>开启<code>Servlet</code>组件支持。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// urlPatterns ：要拦截什么样的请求，&quot;/*&quot;表示所有</span></span><br><span class="line"><span class="meta">@WebFilter(urlPatterns = &quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="comment">// 初始化方法，Web服务器启动，创建Filter时调用，只调用一次</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span>&#123;</span><br><span class="line">        Filter.<span class="built_in">super</span>.init(filterConfig);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 拦截到请求时，调用该方法，可调用多次</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request,ServletResponse response,FilterChain chain)</span>&#123;</span><br><span class="line">        <span class="comment">// 放行</span></span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 销毁方法，服务器关闭时调用，只调用一次</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>&#123;</span><br><span class="line">        Filter.<span class="built_in">super</span>.destroy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、拦截器<br><code>Interceptor</code>快速入门：<br>（1）介绍<br><code>HandlerInterceptor</code>是Spring框架中的一个接口，它用于实现拦截器。在Spring框架中，拦截器是一种特殊的中间件，用于在请求处理之前或之后执行一些特定的操作。<code>HandlerInterceptor</code>口定义了三个方法：<code>preHandle()</code>、<code>postHandle()</code>和<code>afterCompletion()</code>，分别用于在请求处理之前、之后以及视图渲染之后执行一些操作。<br>实现<code>HandlerInterceptor</code>接口的类可以用于处理请求和响应，例如：  </p>
<ol>
<li>在请求处理之前执行一些操作，例如权限验证、日志记录等；  </li>
<li>在请求处理之后执行一些操作，例如处理异常、记录日志等；  </li>
<li>在视图渲染之后执行一些操作，例如清理资源、关闭连接等。</li>
</ol>
<p>要使用<code>HandlerInterceptor</code>接口，需要将其实现类注册到Spring容器中。可以通过实现<code>WebMvcConfigurer</code>接口的<code>addInterceptors()</code>方法来注册拦截器。<br>（2）实现方式<br>有两种方式（选择其中之一就可）：  </p>
<ol>
<li>方式一：定义一个类，实现<code>org.springframework.web.servlet.HandlerInterceptor</code>接口；  </li>
<li>方式二：定义一个类，继承已实现了<code>HandlerInterceptor</code>接口的类，例如<code>org.springframework.web.servlet.handler.HandlerInterceptorAdapter</code>抽象类。</li>
</ol>
<p>然后添加<code>Interceptor</code>拦截器到<code>WebMvcConfigurer</code>配置器中，以前一般继承<code>org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter</code>类，不过SrpingBoot 2.0以上<code>WebMvcConfigurerAdapter</code>类就过时了。有以下两种替代方法：  </p>
<ul>
<li>第一种方式：直接实现<code>org.springframework.web.servlet.config.annotation.WebMvcConfigurer</code>接口（推荐）；  </li>
<li>第二种方式：继承<code>org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport</code>类，但是继承<code>WebMvcConfigurationSupport</code>会让SpringBoot对mvc的自动配置失效，不过目前大多数项目是前后端分离，并没有对静态资源有自动配置的需求，所以继承<code>WebMvcConfigurationSupport</code>也未尝不可。</li>
</ul>
<p>（3）实现步骤  </p>
<ol>
<li>定义拦截器<br>实现<code>HandlerInterceptor</code>接口，并重写其所有方法。  </li>
<li>注册拦截器  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginCheckInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span>&#123;</span><br><span class="line">    <span class="comment">// 目标资源方法执行前执行，返回true：放行；返回false：不放行</span></span><br><span class="line">	<span class="comment">// 预处理，在业务处理器处理请求之前被调用，可以进行登录拦截，编码处理、安全控制、权限校验等处理；</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest req,HttpServletResponse resp,Object handler)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 目标资源方法执行后执行</span></span><br><span class="line">	<span class="comment">// 后处理，在业务处理器处理请求执行完成后，生成视图之前被调用。即调用了Service并返回ModelAndView，</span></span><br><span class="line">	<span class="comment">// 但未进行页面渲染，可以修改ModelAndView，这个比较少用</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest req,HttpServletResponse resp,Object handler,ModelAndView modelAnd View)</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//  视图渲染完毕后执行，最后执行</span></span><br><span class="line">	<span class="comment">// 返回处理，在DispatcherServlet完全处理完请求后被调用，可用于清理资源等。已经渲染了页面。</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest req,HttpServletResponse resp,Object handler,Exception ex)</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
例子一：实现<code>HandlerInterceptor</code>接口<br>说明：此拦截器演示了通过注解形式，对用户权限进行拦截校验。  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nobody.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nobody.annotation.UserAuthenticate;</span><br><span class="line"><span class="keyword">import</span> com.nobody.context.UserContext;</span><br><span class="line"><span class="keyword">import</span> com.nobody.context.UserContextManager;</span><br><span class="line"><span class="keyword">import</span> com.nobody.exception.RestAPIError;</span><br><span class="line"><span class="keyword">import</span> com.nobody.exception.RestException;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.HandlerMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserPermissionInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> UserContextManager userContextManager;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setContextManager</span><span class="params">(UserContextManager userContextManager)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.userContextManager = userContextManager;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">      Object handler)</span> &#123;</span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">&quot;&gt;&gt;&gt; UserPermissionInterceptor preHandle -- &quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (handler <span class="keyword">instanceof</span> HandlerMethod) &#123;</span><br><span class="line">      <span class="type">HandlerMethod</span> <span class="variable">handlerMethod</span> <span class="operator">=</span> (HandlerMethod) handler;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 获取用户权限校验注解(优先获取方法，无则再从类获取)</span></span><br><span class="line">      <span class="type">UserAuthenticate</span> <span class="variable">userAuthenticate</span> <span class="operator">=</span></span><br><span class="line">          handlerMethod.getMethod().getAnnotation(UserAuthenticate.class);</span><br><span class="line">      <span class="keyword">if</span> (<span class="literal">null</span> == userAuthenticate) &#123;</span><br><span class="line">        userAuthenticate = handlerMethod.getMethod().getDeclaringClass()</span><br><span class="line">            .getAnnotation(UserAuthenticate.class);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (userAuthenticate != <span class="literal">null</span> &amp;&amp; userAuthenticate.permission()) &#123;</span><br><span class="line">        <span class="comment">// 获取用户信息</span></span><br><span class="line">        <span class="type">UserContext</span> <span class="variable">userContext</span> <span class="operator">=</span> userContextManager.getUserContext(request);</span><br><span class="line">        <span class="comment">// 权限校验</span></span><br><span class="line">        <span class="keyword">if</span> (userAuthenticate.type() != userContext.getType()) &#123;</span><br><span class="line">          <span class="comment">// 如若不抛出异常，也可返回false</span></span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RestException</span>(RestAPIError.AUTH_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler,</span></span><br><span class="line"><span class="params">      ModelAndView modelAndView)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;&gt;&gt;&gt; UserPermissionInterceptor postHandle -- &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">      Object handler, Exception ex)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;&gt;&gt;&gt; UserPermissionInterceptor afterCompletion -- &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
例子二：继承<code>HandlerInterceptorAdapter</code>类  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nobody.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.handler.HandlerInterceptorAdapter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserPermissionInterceptorAdapter</span> <span class="keyword">extends</span> <span class="title class_">HandlerInterceptorAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">      Object handler)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;&gt;&gt;&gt; UserPermissionInterceptorAdapter preHandle -- &quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler,</span></span><br><span class="line"><span class="params">      ModelAndView modelAndView)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;&gt;&gt;&gt; UserPermissionInterceptorAdapter postHandle -- &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">      Object handler, Exception ex)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;&gt;&gt;&gt; UserPermissionInterceptorAdapter afterCompletion -- &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>添加拦截器配置<br>方法一：实现<code>WebMvcConfigurer</code>接口（推荐）  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebWvcConfigure</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginCheckInterceptor loginCheckInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span>&#123;</span><br><span class="line">        registry.addInterceptor(loginCheckInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
方法一例子：  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nobody.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nobody.context.UserContextResolver;</span><br><span class="line"><span class="keyword">import</span> com.nobody.interceptor.UserPermissionInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.nobody.interceptor.UserPermissionInterceptorAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.support.HandlerMethodArgumentResolver;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebAppConfigurer</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> UserPermissionInterceptor userPermissionInterceptor;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> UserPermissionInterceptorAdapter userPermissionInterceptorAdapter;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> UserContextResolver userContextResolver;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserPermissionInterceptor</span><span class="params">(UserPermissionInterceptor userPermissionInterceptor)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.userPermissionInterceptor = userPermissionInterceptor;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserPermissionInterceptorAdapter</span><span class="params">(</span></span><br><span class="line"><span class="params">      UserPermissionInterceptorAdapter userPermissionInterceptorAdapter)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.userPermissionInterceptorAdapter = userPermissionInterceptorAdapter;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserContextResolver</span><span class="params">(UserContextResolver userContextResolver)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.userContextResolver = userContextResolver;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">    <span class="comment">// 可以添加多个拦截器，一般只添加一个</span></span><br><span class="line">    <span class="comment">// addPathPatterns(&quot;/**&quot;) 表示对所有请求都拦截</span></span><br><span class="line">    <span class="comment">// .excludePathPatterns(&quot;/base/index&quot;) 表示排除对/base/index请求的拦截</span></span><br><span class="line">    <span class="comment">// 多个拦截器可以设置order顺序，值越小，preHandle越先执行，postHandle和afterCompletion越后执行</span></span><br><span class="line">    <span class="comment">// order默认的值是0，如果只添加一个拦截器，可以不显示设置order的值</span></span><br><span class="line">    registry.addInterceptor(userPermissionInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">        .excludePathPatterns(<span class="string">&quot;/base/index&quot;</span>).order(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// registry.addInterceptor(userPermissionInterceptorAdapter).addPathPatterns(&quot;/**&quot;)</span></span><br><span class="line">    <span class="comment">// .excludePathPatterns(&quot;/base/index&quot;).order(1);</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addArgumentResolvers</span><span class="params">(List&lt;HandlerMethodArgumentResolver&gt; resolvers)</span> &#123;</span><br><span class="line">    resolvers.add(userContextResolver);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
方法二：继承<code>WebMvcConfigurationSupport</code>类  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nobody.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nobody.interceptor.UserPermissionInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.nobody.interceptor.UserPermissionInterceptorAdapter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebAppConfigurerSupport</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> UserPermissionInterceptor userPermissionInterceptor;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// @Autowired</span></span><br><span class="line">  <span class="comment">// private UserPermissionInterceptorAdapter userPermissionInterceptorAdapter;</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">    <span class="comment">// 可以添加多个拦截器，一般只添加一个</span></span><br><span class="line">    <span class="comment">// addPathPatterns(&quot;/**&quot;) 表示对所有请求都拦截</span></span><br><span class="line">    <span class="comment">// .excludePathPatterns(&quot;/base/index&quot;) 表示排除对/base/index请求的拦截</span></span><br><span class="line">    registry.addInterceptor(userPermissionInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">        .excludePathPatterns(<span class="string">&quot;/base/index&quot;</span>);</span><br><span class="line">    <span class="comment">// registry.addInterceptor(userPermissionInterceptorAdapter).addPathPatterns(&quot;/**&quot;)</span></span><br><span class="line">    <span class="comment">// .excludePathPatterns(&quot;/base/index&quot;);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
（4）其他主要辅助类  </li>
<li>用户上下文类  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nobody.context;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nobody.enums.AuthenticationTypeEnum;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> lombok.Setter;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserContext</span> &#123;</span><br><span class="line">  <span class="comment">// 用户名称</span></span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="comment">// 用户ID</span></span><br><span class="line">  <span class="keyword">private</span> String userId;</span><br><span class="line">  <span class="comment">// 用户类型</span></span><br><span class="line">  <span class="keyword">private</span> AuthenticationTypeEnum type;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>用户上下文操作类  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nobody.context;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nobody.enums.AuthenticationTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.nobody.exception.RestAPIError;</span><br><span class="line"><span class="keyword">import</span> com.nobody.exception.RestException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserContextManager</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">COOKIE_KEY</span> <span class="operator">=</span> <span class="string">&quot;__userToken&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// @Autowired</span></span><br><span class="line">  <span class="comment">// private RedisService redisService;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 获取用户上下文信息</span></span><br><span class="line"><span class="comment">   * </span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> UserContext <span class="title function_">getUserContext</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">userToken</span> <span class="operator">=</span> getUserToken(request, COOKIE_KEY);</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(userToken)) &#123;</span><br><span class="line">      <span class="comment">// 从缓存或者第三方获取用户信息</span></span><br><span class="line">      <span class="comment">// String userContextStr = redisService.getString(userToken);</span></span><br><span class="line">      <span class="comment">// if (!StringUtils.isEmpty(userContextStr)) &#123;</span></span><br><span class="line">      <span class="comment">// return JSON.parseObject(userContextStr, UserContext.class);</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">      <span class="comment">// 因为演示，没集成Redis，故简单new对象</span></span><br><span class="line">      <span class="type">UserContext</span> <span class="variable">userContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserContext</span>();</span><br><span class="line">      userContext.setName(<span class="string">&quot;Mr.nobody&quot;</span>);</span><br><span class="line">      userContext.setUserId(<span class="string">&quot;0000001&quot;</span>);</span><br><span class="line">      userContext.setType(AuthenticationTypeEnum.ADMIN);</span><br><span class="line">      <span class="keyword">return</span> userContext;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RestException</span>(RestAPIError.AUTH_ERROR);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getUserToken</span><span class="params">(HttpServletRequest request, String cookieKey)</span> &#123;</span><br><span class="line">    Cookie[] cookies = request.getCookies();</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != cookies) &#123;</span><br><span class="line">      <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Objects.equals(cookie.getName(), cookieKey)) &#123;</span><br><span class="line">          <span class="keyword">return</span> cookie.getValue();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 保存用户上下文信息</span></span><br><span class="line"><span class="comment">   * </span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> userContextStr</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUserContext</span><span class="params">(HttpServletResponse response, String userContextStr)</span> &#123;</span><br><span class="line">    <span class="comment">// 用户token实际根据自己业务进行生成，此处简单用UUID</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">userToken</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">    <span class="comment">// 设置cookie</span></span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(COOKIE_KEY, userToken);</span><br><span class="line">    cookie.setPath(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">    response.addCookie(cookie);</span><br><span class="line">    <span class="comment">// redis缓存</span></span><br><span class="line">    <span class="comment">// redisService.setString(userToken, userContextStr, 3600);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>方法参数解析器类  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nobody.context;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.MethodParameter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.support.WebDataBinderFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.NativeWebRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.support.HandlerMethodArgumentResolver;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.support.ModelAndViewContainer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  对有UserContext参数的接口，进行拦截注入用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserContextResolver</span> <span class="keyword">implements</span> <span class="title class_">HandlerMethodArgumentResolver</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> UserContextManager userContextManager;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> Object <span class="title function_">resolveArgument</span><span class="params">(MethodParameter parameter, ModelAndViewContainer mavContainer,</span></span><br><span class="line"><span class="params">      NativeWebRequest webRequest, WebDataBinderFactory binderFactory)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;&gt;&gt;&gt; resolveArgument -- begin...&quot;</span>);</span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> webRequest.getNativeRequest(HttpServletRequest.class);</span><br><span class="line">    <span class="comment">// 从缓存获取用户信息赋值到接口参数中</span></span><br><span class="line">    <span class="keyword">return</span> userContextManager.getUserContext(request);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 只对UserContext参数进行拦截赋值</span></span><br><span class="line"><span class="comment">   * </span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> methodParameter</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">supportsParameter</span><span class="params">(MethodParameter methodParameter)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (methodParameter.getParameterType().equals(UserContext.class)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
（5）拦截路径  </li>
<li><code>/*</code> ：能匹配 <code>/dept、/emps、/login</code>，不能匹配 <code>/dept/list</code>。  </li>
<li><code>/**</code> ：能匹配 <code>/dept、/dept/list、/dept/list/find</code>。  </li>
<li><code>/dept/*</code> ：能匹配 <code>/dept/list</code>，不能匹配 <code>/dept/list/find、/dept</code>。  </li>
<li><code>/dept/**</code> ：能匹配 <code>/dept、/dept/list、/dept/list/find</code>。</li>
</ol>
<p>（6）多个拦截器执行顺序  </p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/4.png" class="">  
<p>上面这个图是每个拦截器都放行的情况下。<br>如果其中一个拦截器不放行，那所有的<code>postHandle</code>都不会执行，然后不放行的拦截器中的<code>afterCompletion</code>不会执行，其他的拦截器的<code>afterCompletion</code>会执行。例如：拦截器3不放行，那么执行的方法为：<code>拦截器1的preHandle</code>-》<code>拦截器2的preHandle</code>-》<code>拦截器3的preHandle</code>-》<code>拦截器2的afterCompletion</code>-》<code>拦截器1的afterCompletion</code>。<br>总结就是：  </p>
<ol>
<li>只有所有拦截器都放行了，postHandle方法才会执行。  </li>
<li>只有当前拦截器放行了，当前拦截器的afterCompletion方法才会执行。</li>
</ol>
<p>3、过滤器和拦截器的区别<br>（1）执行流程  </p>
<ol>
<li>浏览器发送请求  </li>
<li><code>Filter</code>过滤器  </li>
<li><code>DispatcherServlet</code>  </li>
<li><code>Interceptor</code>拦截器  </li>
<li><code>Controller</code></li>
</ol>
<p>（2）区别  </p>
<ol>
<li>接口规范不同<br><code>Filter</code>过滤器需要实现<code>Filter</code>接口，而拦截器需要实现<code>HandlerInterceptor</code>接口。  </li>
<li>拦截范围不同<br>过滤器<code>Filter</code>会拦截所有的资源，而<code>Interceptor</code>只会拦截spring环境中的资源。  </li>
<li>拦截器是<code>spring</code>中的，只能作用于<code>DispatcherServlet</code>，过滤器是<code>servlet</code>。  </li>
<li>拦截器基于java反射机制，过滤器基于函数回调。  </li>
<li>拦截器只对<code>action</code>请求起作用，过滤器几乎所有请求都起作用。  </li>
<li>拦截器可以多次被调用，过滤器只能在初始化的时候被调用一次。</li>
</ol>
<h3 id="3、热部署"><a href="#3、热部署" class="headerlink" title="3、热部署"></a>3、热部署</h3><p>1、使用 jrebel 插件<br>编写玩代码后，使用 <code>jrebel</code> 这个插件自带的启动按钮启动，然后每次编写玩都按 <code>ctrl + f9</code> 使用热部署。</p>
<p>2、设置IDEA热部署<br>设置后，我们就不用频繁的去手动重启，它会自动刷新。就是写好代码后，在IDEA中按<code>ctrl + F9</code>，再去浏览器刷新。如果不想按<code>ctrl + F9</code>，也可以这样设置，先设置，<code>Settings ---&gt; Build ---&gt; Compiler</code>，设置自动编译（<code>Builed project automatically</code>勾选），然后<code>ctrl + shift + alt + /</code>，点击<code>Registry</code>，勾选<code>compiler.automake.allow.app.running</code>。</p>
<br/>

<hr>
<br/>

<h1 id="四、Springboot使用过程中遇到的问题合集"><a href="#四、Springboot使用过程中遇到的问题合集" class="headerlink" title="四、Springboot使用过程中遇到的问题合集"></a>四、Springboot使用过程中遇到的问题合集</h1><h3 id="1、springboot自动注入问题"><a href="#1、springboot自动注入问题" class="headerlink" title="1、springboot自动注入问题"></a>1、springboot自动注入问题</h3><p>1、使用了<code>@Component</code>注解还是无法获取到<code>bean</code>对象<br>原因：是因为<code>springboot</code>扫描器没有扫描到，默认扫描<code>springboot</code>启动类同级的包。<br>（1）解决方法一：需要到<code>springboot</code>启动类上加上包扫描注解<code>@ComponentScan</code>，而且不止要扫描需要扫描的包，还要扫描原来<code>springboot</code>启动类同级的包：<code>@ComponentScan(&#123;&quot;xxx.xxx.xxx&quot;,&quot;yyy.yyy.yyy&#125;)</code>。<br>（2）解决方法二：在<code>springboot</code>启动类上使用<code>@Import</code>注解，例子：<code>@Import(&#123;Demo1.class,Demo2.class&#125;)</code>，大括号里的<code>class</code>是需要被扫描到的类（不需要使用任何注解的普通类）。<br>（3）解决方法三：新建一个配置类（使用<code>@Configuration</code>注解标注的类），把需要被扫描的类在这个配置类中使用<code>@Bean</code>注解标注，在启动类上使用<code>@Import</code>注解，将这个配置类导入。例子：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoConfig</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Demo1 <span class="title function_">demo1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Demo1</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Demo2 <span class="title function_">demo2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Demo2</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动类</span></span><br><span class="line"><span class="meta">@Import(&#123;DemoConfig.class&#125;)</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span>()&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;.....&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（4）解决方法四：新建一个配置类（使用<code>@Configuration</code>注解标注的类），把需要被扫描的类在这个配置类中使用<code>@Bean</code>注解标注，在新建一个选择器类实现<code>ImportSelector</code>接口，实现这个接口的方法，在这个方法中，将配置类返回，然后将这个选择器类在启动类上使用<code>@Import</code>注解导入，例子：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoConfig</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Demo1 <span class="title function_">demo1</span><span class="params">()</span>&#123; <span class="comment">// 需要扫描的类</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Demo1</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Demo2 <span class="title function_">demo2</span><span class="params">()</span>&#123; <span class="comment">// 需要扫描的类</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Demo2</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择器类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoSelect</span> <span class="keyword">implements</span> <span class="title class_">ImportSelector</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String[] selectImports(AnnotationMetadata i)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;xxx.xxx.DemoConfig&quot;</span>&#125;; <span class="comment">// 上面的配置类包路径</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动类</span></span><br><span class="line"><span class="meta">@Import(&#123;DemoSelect.class&#125;)</span>  <span class="comment">// 将上面选择器类导入</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span>()&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;.....&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong><br>上面的方法太繁琐了，一般需要扫描的包中会提供给我们一个注解<code>@EnableXXXX</code>注解，这个注解封装了上面使用到<code>@Import</code>和<code>@ImportSelector</code>注解，我们直接在启动类上使用<code>@EnableXXXX</code>注解就可以了。  </p>
<h3 id="2、Springboot多传参数导致JSON-parse-error-Unrecognized-filed-…异常"><a href="#2、Springboot多传参数导致JSON-parse-error-Unrecognized-filed-…异常" class="headerlink" title="2、Springboot多传参数导致JSON parse error: Unrecognized filed …异常"></a>2、Springboot多传参数导致JSON parse error: Unrecognized filed …异常</h3><p>1、说明：<br>（1）一个方法中只能有一个<code>@RequestBody</code>注解，因为<code>RequestBody</code>就是<code>request</code>的<code>inputStream</code>，这个流在第一次使用该注解后会关闭，后面的都会报错（stream closed）；<br>（2）默认情况下<code>@RequestBody</code>标注的对象必须包含前台传来的所有字段，如果没有包含前台传来的字段，就会报错：<code>Unrecognized field xxx , not marked as ignorable</code>，这是因为<code>MappingJacksonHttpMessageConverter</code>默认要求必须存在相应的字段，如果没有前台传来的某个字段，就会报错。<br>2、解决前端请求多余字段转换报错问题<br>（1）第一种：后端实体类可以增加一个字段来接收前台传来的这个值。<br>（2）第二种：在前端往后端传值的时候，去掉无用的字段，这样还能减少网络传输的大小。<br>（3）第三种：使用<code>com.fasterxml.jackson</code>提供的json注解  </p>
<ul>
<li><code>@JsonIgnore</code>注解用来忽略某些字段，可以用在Field或者Getter方法上，用在Setter方法时，和Filed效果一样。  </li>
<li><code>@JsonIgnoreProperties(ignoreUnknown = true)</code>，将这个注解写在类上之后，就会忽略类中不存在的字段。  </li>
<li><code>@JsonIgnoreProperties(&#123; &quot;internalId&quot;, &quot;secretKey&quot; &#125;)</code>，指定要忽略的字段，用在类上。<br>例子：  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实体类</span></span><br><span class="line"><span class="meta">@JsonIgnoreProperties(ignoreUnknown = true)</span></span><br><span class="line"><span class="keyword">public</span> Myclass &#123;</span><br><span class="line">....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
（4）第四种：重写配置类方式  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MappingJackson2HttpMessageConverter <span class="title function_">mappingJackson2HttpMessageConverter</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">MappingJackson2HttpMessageConverter</span> <span class="variable">converter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>();</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="comment">//添加此配置</span></span><br><span class="line">        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, <span class="literal">false</span>);</span><br><span class="line">        converter.setObjectMapper(objectMapper);</span><br><span class="line">        <span class="keyword">return</span> converter;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3、有关对象属性中有枚举list怎么传参"><a href="#3、有关对象属性中有枚举list怎么传参" class="headerlink" title="3、有关对象属性中有枚举list怎么传参"></a>3、有关对象属性中有枚举list怎么传参</h3><p>1、实体类  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImageScanningScheme</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> List&lt;ImageScanningRuleEnum&gt; rule;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、枚举类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ImageScanningRuleEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    LOW(<span class="string">&quot;LOW&quot;</span>, <span class="string">&quot;较低&quot;</span>),</span><br><span class="line">    HIGH(<span class="string">&quot;HIGH&quot;</span>, <span class="string">&quot;高危&quot;</span>),</span><br><span class="line">    MEDIUM(<span class="string">&quot;MEDIUM&quot;</span>, <span class="string">&quot;中危&quot;</span>),</span><br><span class="line">    CRITICAL(<span class="string">&quot;CRITICAL&quot;</span>, <span class="string">&quot;严重&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String text;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ImageScanningRuleEnum(String code, String text) &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.text = text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、前端（postman）传参</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;rule&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;LOW&quot;</span><span class="punctuation">,</span> <span class="string">&quot;MEDIUM&quot;</span><span class="punctuation">,</span> <span class="string">&quot;HIGH&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CRITICAL&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="4、事务失效问题"><a href="#4、事务失效问题" class="headerlink" title="4、事务失效问题"></a>4、事务失效问题</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/likeguang/p/15715702.html">完整详情链接</a><br>1、场景一  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> UserService &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">		jdbcTemplate.execute(<span class="string">&quot;insert into t1 values(1,1,1,1)&quot;</span>);</span><br><span class="line">		a();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 此传播方式：如果已经存在了一个事务就抛出异常</span></span><br><span class="line">	<span class="meta">@Transactional(propagation = Propagation.NEVER)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">()</span> &#123;</span><br><span class="line">		jdbcTemplate.execute(<span class="string">&quot;insert into t1 values(2,2,2,2)&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>说明：因为<code>test</code>方法被<code>@Transactional</code>标注，事务又是基于<code>aop</code>实现的，所以<code>UserService</code>的代理类执行<code>test</code>方法，<code>a</code>方法也被<code>@Transactional</code>标注，并且传播方式为：如果已经存在了一个事务就抛出异常；很明显，已经存在一个事务，所以正常情况会抛出异常，但是现在不会，因为事务失效了。<br>原因：<code>test</code>方法中执行<code>a</code>方法，是<code>UserService</code>类本身去调用执行的，并不是它的代理类去调用执行，所以它失效了。<br>解决办法：<br>让它代理类去调用执行<code>a</code>方法，而不是它本身去调用执行。<br>（1）办法一  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> UserService &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserService userService;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">		jdbcTemplate.execute(<span class="string">&quot;insert into t1 values(1,1,1,1)&quot;</span>);</span><br><span class="line">		userService.a();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 此传播方式：如果已经存在了一个事务就抛出异常</span></span><br><span class="line">	<span class="meta">@Transactional(propagation = Propagation.NEVER)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">()</span> &#123;</span><br><span class="line">		jdbcTemplate.execute(<span class="string">&quot;insert into t1 values(2,2,2,2)&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（2）办法二  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加注解防止报错</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(exposeProxy = true)</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> UserService &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">		jdbcTemplate.execute(<span class="string">&quot;insert into t1 values(1,1,1,1)&quot;</span>);</span><br><span class="line">		<span class="comment">// 加入后运行会报个错，需要你设置exposeProxy = true 在该类上加个注解</span></span><br><span class="line">		<span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) AopContext.currentProxy();</span><br><span class="line">		userService.a();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 此传播方式：如果已经存在了一个事务就抛出异常</span></span><br><span class="line">	<span class="meta">@Transactional(propagation = Propagation.NEVER)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">()</span> &#123;</span><br><span class="line">		jdbcTemplate.execute(<span class="string">&quot;insert into t1 values(2,2,2,2)&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（3）办法三<br>将<code>a</code>方法提出去另一个类（<code>xxxService</code>）中，在由这个类来调用执行。  </p>
<h3 id="5、关于配置类List对象映射到实体类问题"><a href="#5、关于配置类List对象映射到实体类问题" class="headerlink" title="5、关于配置类List对象映射到实体类问题"></a>5、关于配置类List对象映射到实体类问题</h3><p>1、实体类<br>实体类中的属性名称必须对应配置文件中list对象中属性的名称。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DetectionPackageType</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String language;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、实体配置类  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;detection-package-type&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DetectionPackageTypeConfig</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// packages必须对应配置文件中名称</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;DetectionPackageType&gt; packages;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、yaml配置文件  </p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">detection-package-type:</span></span><br><span class="line">  <span class="attr">packages:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Java检测规则包</span></span><br><span class="line">      <span class="attr">code:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">Java</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Css基础检测包</span></span><br><span class="line">      <span class="attr">code:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">Css</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">JavaScript基础检测包</span></span><br><span class="line">      <span class="attr">code:</span> <span class="number">3</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">JavaScript</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Html基础检测包</span></span><br><span class="line">      <span class="attr">code:</span> <span class="number">4</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">Html</span></span><br></pre></td></tr></table></figure>
<p>4、使用  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注意：这里注入的是实体配置类！</span></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> DetectionPackageTypeConfig detectionPackageTypeConfig;</span><br></pre></td></tr></table></figure>


<h3 id="6、VO、DTO、BO、PO、DO的区别"><a href="#6、VO、DTO、BO、PO、DO的区别" class="headerlink" title="6、VO、DTO、BO、PO、DO的区别"></a>6、VO、DTO、BO、PO、DO的区别</h3><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/5.png" class="">  


<h3 id="7、链式调用"><a href="#7、链式调用" class="headerlink" title="7、链式调用"></a>7、链式调用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="type">Test</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line">		test.test1().test2().test3();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Test <span class="title function_">test1</span><span class="params">()</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;test1&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Test <span class="title function_">test2</span><span class="params">()</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;test2&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Test <span class="title function_">test3</span><span class="params">()</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;test3&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">test1</span></span><br><span class="line">test2</span><br><span class="line">test3</span><br></pre></td></tr></table></figure>


<h3 id="8、替换-Autowired注解的方式"><a href="#8、替换-Autowired注解的方式" class="headerlink" title="8、替换@Autowired注解的方式"></a>8、替换@Autowired注解的方式</h3><p>使用lombok的<code>@RequiredArgsConstructor</code>注解。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line">	<span class="comment">// 这里的final必须和@RequiredArgsConstructor一起用</span></span><br><span class="line">    <span class="comment">// 不注入的话就不用加final，要注入才加final</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> TestService testService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar/avatar.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar/avatar.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">十七</div><div class="post-copyright__author_desc">积少成多，只要学不死就往死里学v👀</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://zc-zjy.github.io/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://zc-zjy.github.io/2023/10/24/Springboot学习笔记/')">Springboot学习笔记</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/reward/zjyzanshang.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/reward/zjyzanshang.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/reward/zjyzfb.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/reward/zjyzfb.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://zc-zjy.github.io/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Springboot学习笔记&amp;url=https://zc-zjy.github.io/2023/10/24/Springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/&amp;pic=/img/page_background/cover_background_light.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zc-zjy.github.io" target="_blank">小Z成长录😀丶</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>工作技能<span class="tagsPageCount">40</span></a><a class="post-meta__box__tags" href="/tags/%E5%90%8E%E7%AB%AF/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>后端<span class="tagsPageCount">25</span></a><a class="post-meta__box__tags" href="/tags/Spring/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Spring<span class="tagsPageCount">7</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/img/page_background/cover_background_light.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/18/Mybatis-Plus%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/page_background/cover_background_light.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Mybatis-Plus学习笔记</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/27/Vue2-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/page_background/cover_background_light.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Vue学习笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2023/10/04/%E5%85%B3%E4%BA%8ESpring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="关于Spring学习笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/page_background/cover_background_light.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-04</div><div class="title">关于Spring学习笔记</div></div></a></div><div><a href="/2023/10/09/%E5%85%B3%E4%BA%8EspringMVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="关于springMVC学习笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/page_background/cover_background_light.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-09</div><div class="title">关于springMVC学习笔记</div></div></a></div><div><a href="/2024/01/31/%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/" title="常用注解"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/page_background/cover_background_light.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-01-31</div><div class="title">常用注解</div></div></a></div><div><a href="/2024/09/03/SpringSecurity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="SpringSecurity学习笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/page_background/cover_background_light.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-09-03</div><div class="title">SpringSecurity学习笔记</div></div></a></div><div><a href="/2024/11/22/Springboot%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Springboot日志框架学习笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/page_background/cover_background_light.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-11-22</div><div class="title">Springboot日志框架学习笔记</div></div></a></div><div><a href="/2024/11/27/SpringCloud%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="SpringCloud学习笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/page_background/cover_background_light.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-11-27</div><div class="title">SpringCloud学习笔记</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">喜欢分享，也喜欢交朋友，正在努力钻研java、spring全家桶、前端vue等等技术，梦想成为一名技术大牛</div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81Springboot%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">一、Springboot基础知识记录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81Springboot-IOC%E5%92%8CDI%E6%B3%A8%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">1.0.1.</span> <span class="toc-text">1、Springboot IOC和DI注入方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81Springboot-%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8-AOP"><span class="toc-number">1.0.2.</span> <span class="toc-text">2、Springboot 关于使用 AOP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%85%B3%E4%BA%8E-Springboot-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.0.3.</span> <span class="toc-text">3、关于 Springboot 配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81springboot%E9%9B%86%E6%88%90mybatis%E9%9C%80%E8%A6%81%E7%9A%84%E4%BE%9D%E8%B5%96"><span class="toc-number">1.0.4.</span> <span class="toc-text">4、springboot集成mybatis需要的依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81Springboot-bean%E7%9A%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.0.5.</span> <span class="toc-text">5、Springboot bean的管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81Springboot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8A%A0%E8%BD%BD%E6%B5%81%E7%A8%8B"><span class="toc-number">1.0.6.</span> <span class="toc-text">6、Springboot自动配置加载流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96%E9%97%AE%E9%A2%98"><span class="toc-number">1.0.7.</span> <span class="toc-text">7、循环依赖问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81Springboot%E6%BA%90%E7%A0%81%E5%90%8D%E8%AF%8D"><span class="toc-number">1.0.8.</span> <span class="toc-text">8、Springboot源码名词</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Springboot%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">二、Springboot使用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E8%A6%81%E6%83%B3%E5%9C%A8tomcat%E4%B8%AD%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.0.1.</span> <span class="toc-text">1、要想在tomcat中启动项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%9C%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="toc-number">2.0.2.</span> <span class="toc-text">2、在配置文件中配置静态资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81springboot%E5%90%84%E7%A7%8Dpom%E6%96%87%E4%BB%B6%E9%9C%80%E8%A6%81%E5%92%8C%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97%E5%9C%B0%E5%9D%80"><span class="toc-number">2.0.3.</span> <span class="toc-text">3、springboot各种pom文件需要和学习指南地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81Springboot%E8%AF%BB%E9%85%8D%E7%BD%AE%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">2.0.4.</span> <span class="toc-text">4、Springboot读配置的4种方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81Springboot%E8%8E%B7%E5%8F%96bean%E5%AF%B9%E8%B1%A1%E6%96%B9%E6%B3%95"><span class="toc-number">2.0.5.</span> <span class="toc-text">5、Springboot获取bean对象方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8%E5%A5%BDspringboot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">2.0.6.</span> <span class="toc-text">6、怎么使用好springboot自动配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81springboot%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">2.0.7.</span> <span class="toc-text">7、springboot多环境配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81springboot%E6%89%93%E5%8C%85%E6%8F%92%E4%BB%B6"><span class="toc-number">2.0.8.</span> <span class="toc-text">8、springboot打包插件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81Springboot%E5%85%B6%E4%BB%96%E7%BB%84%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">三、Springboot其他组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">3.0.1.</span> <span class="toc-text">1、全局异常处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">3.0.2.</span> <span class="toc-text">2、过滤器和拦截器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%83%AD%E9%83%A8%E7%BD%B2"><span class="toc-number">3.0.3.</span> <span class="toc-text">3、热部署</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Springboot%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%90%88%E9%9B%86"><span class="toc-number">4.</span> <span class="toc-text">四、Springboot使用过程中遇到的问题合集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81springboot%E8%87%AA%E5%8A%A8%E6%B3%A8%E5%85%A5%E9%97%AE%E9%A2%98"><span class="toc-number">4.0.1.</span> <span class="toc-text">1、springboot自动注入问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81Springboot%E5%A4%9A%E4%BC%A0%E5%8F%82%E6%95%B0%E5%AF%BC%E8%87%B4JSON-parse-error-Unrecognized-filed-%E2%80%A6%E5%BC%82%E5%B8%B8"><span class="toc-number">4.0.2.</span> <span class="toc-text">2、Springboot多传参数导致JSON parse error: Unrecognized filed …异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%9C%89%E5%85%B3%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E4%B8%AD%E6%9C%89%E6%9E%9A%E4%B8%BElist%E6%80%8E%E4%B9%88%E4%BC%A0%E5%8F%82"><span class="toc-number">4.0.3.</span> <span class="toc-text">3、有关对象属性中有枚举list怎么传参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88%E9%97%AE%E9%A2%98"><span class="toc-number">4.0.4.</span> <span class="toc-text">4、事务失效问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%85%B3%E4%BA%8E%E9%85%8D%E7%BD%AE%E7%B1%BBList%E5%AF%B9%E8%B1%A1%E6%98%A0%E5%B0%84%E5%88%B0%E5%AE%9E%E4%BD%93%E7%B1%BB%E9%97%AE%E9%A2%98"><span class="toc-number">4.0.5.</span> <span class="toc-text">5、关于配置类List对象映射到实体类问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81VO%E3%80%81DTO%E3%80%81BO%E3%80%81PO%E3%80%81DO%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">4.0.6.</span> <span class="toc-text">6、VO、DTO、BO、PO、DO的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8"><span class="toc-number">4.0.7.</span> <span class="toc-text">7、链式调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E6%9B%BF%E6%8D%A2-Autowired%E6%B3%A8%E8%A7%A3%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">4.0.8.</span> <span class="toc-text">8、替换@Autowired注解的方式</span></a></li></ol></li></ol></li></ol></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/footer/shangban.jpg" alt="上班摸鱼中~" title="上班摸鱼中~"/><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2023 - 2025 By <a class="footer-bar-link" href="/" title="十七" target="_blank">十七</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#footer-type-tips", {
      strings: ["积少成多，只要学不死就往死里学v👀"],
      startDelay: 300,
      typeSpeed: 150,
      loop: false,
      backSpeed: 50
    })
  } else {
    document.getElementById("footer-type-tips").innerHTML = '积少成多，只要学不死就往死里学v👀'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" href="/" title="还没备案喔~">还没备案喔~</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">2</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Camunda/" style="font-size: 0.88rem;">Camunda<sup>1</sup></a><a href="/tags/ElasticSearch/" style="font-size: 0.88rem;">ElasticSearch<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>1</sup></a><a href="/tags/IntelliJ-IDEA-2020-3-3-x64%E6%BF%80%E6%B4%BB%E6%96%B9%E6%B3%95/" style="font-size: 0.88rem;">IntelliJ IDEA 2020.3.3 x64激活方法<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>14</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/Maven/" style="font-size: 0.88rem;">Maven<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 0.88rem;">Mybatis<sup>1</sup></a><a href="/tags/MybatisPlus/" style="font-size: 0.88rem;">MybatisPlus<sup>1</sup></a><a href="/tags/Mysql/" style="font-size: 0.88rem;">Mysql<sup>1</sup></a><a href="/tags/Postgresql/" style="font-size: 0.88rem;">Postgresql<sup>1</sup></a><a href="/tags/Postman/" style="font-size: 0.88rem;">Postman<sup>1</sup></a><a href="/tags/SVN/" style="font-size: 0.88rem;">SVN<sup>1</sup></a><a href="/tags/Spring/" style="font-size: 0.88rem;">Spring<sup>7</sup></a><a href="/tags/Vue/" style="font-size: 0.88rem;">Vue<sup>1</sup></a><a href="/tags/css/" style="font-size: 0.88rem;">css<sup>1</sup></a><a href="/tags/navicat/" style="font-size: 0.88rem;">navicat<sup>1</sup></a><a href="/tags/%E4%B9%A6%E6%9C%AC%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">书本知识<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 0.88rem;">前端<sup>3</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 0.88rem;">后端<sup>25</sup></a><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/" style="font-size: 0.88rem;">工作技能<sup>40</sup></a><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%B5%81/" style="font-size: 0.88rem;">工作流<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 0.88rem;">数据库<sup>3</sup></a><a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 0.88rem;">服务器<sup>3</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">测试工具<sup>1</sup></a><a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 0.88rem;">消息队列<sup>1</sup></a><a href="/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" style="font-size: 0.88rem;">版本控制<sup>2</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 0.88rem;">设计模式<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("09/17/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2023 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 十七 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("09/17/2023 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "/img/footer/xiaban.jpg";
        img.title = "下班啦啦啦啦，嘿嘿~";
        img.alt = "下班啦啦啦啦，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async src="//at.alicdn.com/t/c/font_4240673_wweo9mtor0h.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="true" data-text="I,LOVE,YOU,黄洁,十七,小Z,早上好鸭👋, 祝你一天好心情！,上午好👋, 状态很好，鼓励一下～,11点多啦, 在坚持一下就吃饭啦～,午安👋, 宝贝,🌈充实的一天辛苦啦！,奖励一顿丰盛的大餐吧🍔,晚上好👋,晚上好👋, 在属于自己的时间好好放松😌~,晚安😴" data-fontsize="15px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>