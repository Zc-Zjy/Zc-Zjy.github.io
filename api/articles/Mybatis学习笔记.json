{"title":"Mybatis学习笔记","slug":"Mybatis学习笔记","date":"2023-10-16T09:10:15.000Z","updated":"2025-06-17T07:44:59.709Z","comments":true,"path":"api/articles/Mybatis学习笔记.json","realPath":null,"excerpt":null,"covers":["/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/0.png","/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.png","/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.png","/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/3.png","/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/4.png","/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/5.png","/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/6.png"],"cover":null,"content":"<hr>\n<h1 id=\"一、中文学习文档链接地址\"><a href=\"#一、中文学习文档链接地址\" class=\"headerlink\" title=\"一、中文学习文档链接地址\"></a>一、中文学习文档链接地址</h1><p>&emsp;&emsp;<a href=\"https://mybatis.org/mybatis-3/zh_CN/index.html\">https://mybatis.org/mybatis-3/zh_CN&#x2F;index.html</a></p>\n<br/>\n\n<hr>\n<br/>\n\n<h1 id=\"二、依赖配置\"><a href=\"#二、依赖配置\" class=\"headerlink\" title=\"二、依赖配置\"></a>二、依赖配置</h1><h3 id=\"1、所需依赖\"><a href=\"#1、所需依赖\" class=\"headerlink\" title=\"1、所需依赖\"></a>1、所需依赖</h3><p>要使用myBatis，要导入两个依赖，一个是myBatis包，一个是myBatis驱动包。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- mysql驱动 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>8.0.20<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- mybatis --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.2.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>或者</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 这个包含了上面两个依赖 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、配置\"><a href=\"#2、配置\" class=\"headerlink\" title=\"2、配置\"></a>2、配置</h3><p>数据库URL</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">jdbc</span>:<span class=\"string\">mysql://localhost:3306/stu?useSSL=true&amp;amp;useUnicode=true&amp;amp;serverTimezone=GMT</span></span><br></pre></td></tr></table></figure>\n\n<br/>\n\n<hr>\n<br/>\n\n<h1 id=\"三、学习笔记\"><a href=\"#三、学习笔记\" class=\"headerlink\" title=\"三、学习笔记\"></a>三、学习笔记</h1><h3 id=\"1、XML文件里的结果集映射\"><a href=\"#1、XML文件里的结果集映射\" class=\"headerlink\" title=\"1、XML文件里的结果集映射\"></a>1、XML文件里的结果集映射</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--这里的id对应select里resultMap，resultMap里是什么，这里的id就是什么--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;UserMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- column为数据库里的字段名，property为实例类中的属性名--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;id&quot;</span>/&gt;</span> </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;name&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;pwd&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;password&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getUserById&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;UserMap&quot;</span>&gt;</span> <span class=\"comment\">&lt;!--这里的resultMap随意取--&gt;</span></span><br><span class=\"line\">    select * from user where id=#&#123;id&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、多对一查询方法\"><a href=\"#2、多对一查询方法\" class=\"headerlink\" title=\"2、多对一查询方法\"></a>2、多对一查询方法</h3><p>1、第一种方法  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pojo.Student</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Student</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String aname;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Teacher teacher;</span><br><span class=\"line\">    <span class=\"comment\">// getter和setter方法</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// pojo.Teacher</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Teacher</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tname;</span><br><span class=\"line\">    <span class=\"comment\">// getter和setter方法</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- StudentTeacher随便取--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findAll&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;StudentTeacher&quot;</span>&gt;</span></span><br><span class=\"line\">        select * from student</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--StudentTeacher要对应上面随便取的名字--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;StudentTeacher&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;pojo.Student&quot;</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"comment\">&lt;!--getTeacher要对应下面随便取的名字，tid是副表当中对应主表id的字段--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">association</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;teacher&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;tid&quot;</span> <span class=\"attr\">javaType</span>=<span class=\"string\">&quot;pojo.Teacher&quot;</span> <span class=\"attr\">select</span>=<span class=\"string\">&quot;getTeacher&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">association</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getTeacher&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;pojo.Teacher&quot;</span>&gt;</span> <span class=\"comment\">&lt;!--getTeacher随便取--&gt;</span></span><br><span class=\"line\">        select * from teacher where id=#&#123;id&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2、第二种方法  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findAllOne&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;StudentTeacher2&quot;</span>&gt;</span></span><br><span class=\"line\">        select s.id sid,s.name sname,t.name tname </span><br><span class=\"line\">        from student s,teacher t </span><br><span class=\"line\">        where s.tid=t.id</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;StudentTeacher2&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;pojo.Student&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;sid&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">result</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;sname&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">result</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">association</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;teacher&quot;</span> <span class=\"attr\">javaType</span>=<span class=\"string\">&quot;pojo.Teacher&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;tname&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">result</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">association</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>3、第三种方法（分步查询）  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- mapper层：--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 通过分步查询员工以及员工所对应的部门信息 --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 分步查询第一步：查询员工信息 --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Emp getEmpAndDeptByStepOne(@Param(&quot;uid&quot;)String uid); --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 分步查询第二步：查询部门信息 --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Dept getEmpAndDeptStepTwo(@Param(&quot;did&quot;)String did); --&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- mapper.xml：--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;empAndDeptByStepResultMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;Emp&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;uid&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;uid&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;empName&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;emp_name&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- 不是驼峰命名的属性可以不写，它自动就映射了 --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;age&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;age&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;sex&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;sex&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- 这里的dept是Emp实体类中的属性，类型为Dept  --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">association</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">select</span>=<span class=\"string\">&quot;getEmpAndDeptStepTwo&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;did&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">association</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getEmpAndDeptByStepOne&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;empAndDeptByStepResultMap&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from t_emp where uid = #&#123;uid&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getEmpAndDeptStepTwo&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;Dept&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from t_dept where did = #&#123;did&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">\t将多列值封装为map传递，写法：columu=&quot;&#123;key1=column1,key2=column2&#125;&quot;</span></span><br><span class=\"line\"><span class=\"comment\">\tkey1代表第二条查询语句的数据库字段，column1代表当前要传递的值</span></span><br><span class=\"line\"><span class=\"comment\"> --&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3、一对多查询方法\"><a href=\"#3、一对多查询方法\" class=\"headerlink\" title=\"3、一对多查询方法\"></a>3、一对多查询方法</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 客户实体类，一个客户有多个订单</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Customer</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Integer customerId;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String customerName;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> List&lt;Order&gt; orders;</span><br><span class=\"line\">\t<span class=\"comment\">// getter和setter</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 订单实体类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Order</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Integer orderId;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String orderName;</span><br><span class=\"line\">\t<span class=\"comment\">// getter和setter</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;customerMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;customer&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">colimn</span>=<span class=\"string\">&quot;customer_id&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;customerId&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;customer_name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;customerName&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">     property：集合属性名，和Customer实体类中的List&lt;Order&gt; orders保持一致</span></span><br><span class=\"line\"><span class=\"comment\">\t ofType：集合的泛型类型，和Customer实体类中的List&lt;Order&gt; orders保持一致</span></span><br><span class=\"line\"><span class=\"comment\">   --&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">collection</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;orders&quot;</span> <span class=\"attr\">ofType</span>=<span class=\"string\">&quot;order&quot;</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;order_id&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;orderId&quot;</span> /&gt;</span></span><br><span class=\"line\">\t <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;order_name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;orderName&quot;</span> /&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">collection</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;queryList&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;customerMap&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from t_order tor join t_customer tur on tor.customer_id = tur.customer</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"4、分页查询\"><a href=\"#4、分页查询\" class=\"headerlink\" title=\"4、分页查询\"></a>4、分页查询</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--startIndex 是数据的下标  pageSize是显示多少条数据--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findAllMap&quot;</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">&quot;map&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;pojo.User&quot;</span>&gt;</span></span><br><span class=\"line\">        select * from user limit #&#123;startIndex&#125;,#&#123;pageSize&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// MybatisUtil工具类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MybatisUtil</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">SqlSessionFactory</span> <span class=\"variable\">factory</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">config</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;mybatis.xml&quot;</span>;</span><br><span class=\"line\">         <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">              <span class=\"type\">InputStream</span> <span class=\"variable\">inputStream</span> <span class=\"operator\">=</span> Resource.getResourceAsStream(config);</span><br><span class=\"line\">              factory = <span class=\"keyword\">new</span> <span class=\"title class_\">SqlSessionFactoryBuilder</span>().build(inputStream);</span><br><span class=\"line\">          &#125;<span class=\"keyword\">catch</span>(IOException e)&#123;</span><br><span class=\"line\">              e.printStackTrace();</span><br><span class=\"line\">          &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> SqlSession <span class=\"title function_\">getSqlSession</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">SqlSession</span> <span class=\"variable\">session</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(factory != <span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            factory.openSession();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> session;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Dao层方法：</span></span><br><span class=\"line\">List&lt;User&gt; <span class=\"title function_\">findAllMap</span><span class=\"params\">(Map&lt;String,Integer&gt; map)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 测试：</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">SqlSession</span> <span class=\"variable\">sqlSession</span> <span class=\"operator\">=</span> MybatisUtil.getSqlSession();</span><br><span class=\"line\">        <span class=\"type\">UserDao</span> <span class=\"variable\">mapper</span> <span class=\"operator\">=</span> sqlSession.getMapper(UserDao.class);</span><br><span class=\"line\"><span class=\"comment\">//        List&lt;User&gt; userList = mapper.findAll();</span></span><br><span class=\"line\"><span class=\"comment\">//        for (User user :</span></span><br><span class=\"line\"><span class=\"comment\">//                userList) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//            System.out.println(user);</span></span><br><span class=\"line\"><span class=\"comment\">//        &#125;</span></span><br><span class=\"line\">        HashMap&lt;String, Integer&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;String, Integer&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;startIndex&quot;</span>,<span class=\"number\">2</span>);</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;pageSize&quot;</span>,<span class=\"number\">4</span>);</span><br><span class=\"line\">        List&lt;User&gt; userList = mapper.findAllMap(map);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : userList) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        sqlSession.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5、模糊查询\"><a href=\"#5、模糊查询\" class=\"headerlink\" title=\"5、模糊查询\"></a>5、模糊查询</h3><p>1、第一种方法<br>（1）Java代码执行的时候，传递通配符 <code>% %</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;User&gt; userList = mapper.getUserLike(<span class=\"string\">&quot;%李%&quot;</span>); <span class=\"comment\">//查询姓李的人</span></span><br></pre></td></tr></table></figure>\n<p>（2）在sql拼接中使用通配符</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">where</span> name <span class=\"keyword\">like</span> &quot;%&quot; #&#123;<span class=\"keyword\">value</span>&#125; &quot;%&quot;;</span><br></pre></td></tr></table></figure>\n<p>2、第二种方法<br>在xml查询中直接使用<code>concat</code>，比如：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">where</span> name <span class=\"keyword\">like</span> concat(&quot;%&quot;,#&#123;<span class=\"keyword\">value</span>&#125;,&quot;%&quot;);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6、关于-“-”-和-“-”-的使用\"><a href=\"#6、关于-“-”-和-“-”-的使用\" class=\"headerlink\" title=\"6、关于 “#” 和 “$” 的使用\"></a>6、关于 “#” 和 “$” 的使用</h3><p><strong>说明：</strong>因为 “$” 不是安全的，会造成sql注入，所以一般查询条件使用 “#”，后者是直接将字符串原模原样映射到sql语句中的。<br>例子：</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 传的参数是：</span><br><span class=\"line\"><span class=\"built_in\">public</span> <span class=\"keyword\">User</span> getUser(<span class=\"type\">int</span> id);</span><br><span class=\"line\"></span><br><span class=\"line\">// 写的<span class=\"keyword\">sql</span>语句是：</span><br><span class=\"line\">&lt;<span class=\"keyword\">select</span> id=&quot;getUser&quot;&gt;</span><br><span class=\"line\">    <span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> $&#123;id&#125; <span class=\"keyword\">desc</span></span><br><span class=\"line\">&lt;/<span class=\"keyword\">select</span>&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">// 实际上输出的<span class=\"keyword\">sql</span>语句是：</span><br><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> id <span class=\"keyword\">desc</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7、新增数据之后自动获取数据主键\"><a href=\"#7、新增数据之后自动获取数据主键\" class=\"headerlink\" title=\"7、新增数据之后自动获取数据主键\"></a>7、新增数据之后自动获取数据主键</h3><p>1、第一种：  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 说明：--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- useGenerateKeys：开启自动获取主键功能 --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- keyProperty：将获取的主键用什么属性接收（获取主键id，肯定是用id来接收了）--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;xxxx&quot;</span> <span class=\"attr\">useGenerateKeys</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;id&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>2、第二种：  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertHepKbesPlanProgramme&quot;</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">&quot;HepKbesPlanProgrammeEvent&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 说明：</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\tselectKey标签是获取新增数据之后自动获取数据主键</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\tkeyProperty：将获取的主键用什么属性接收（获取主键id，肯定是用id来接收了）</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\tresultType：返回主键的类型</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\torder：指定selectKey标签中的sql语句在insert语句之前还是之后执行（AFTER/BEFORE）</span></span><br><span class=\"line\"><span class=\"comment\">\t\t--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;programmeId&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;Long&quot;</span> <span class=\"attr\">order</span>=<span class=\"string\">&quot;AFTER&quot;</span>&gt;</span></span><br><span class=\"line\">            select LAST_INSERT_ID()</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></span><br><span class=\"line\">        insert into hep_kbes_plan_programme_event</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">trim</span> <span class=\"attr\">prefix</span>=<span class=\"string\">&quot;(&quot;</span> <span class=\"attr\">suffix</span>=<span class=\"string\">&quot;)&quot;</span> <span class=\"attr\">suffixOverrides</span>=<span class=\"string\">&quot;,&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;planId != null&quot;</span>&gt;</span>plan_id,<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t...</span><br><span class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">trim</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">trim</span> <span class=\"attr\">prefix</span>=<span class=\"string\">&quot;values (&quot;</span> <span class=\"attr\">suffix</span>=<span class=\"string\">&quot;)&quot;</span> <span class=\"attr\">suffixOverrides</span>=<span class=\"string\">&quot;,&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;planId != null&quot;</span>&gt;</span>#&#123;planId&#125;,<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t...</span><br><span class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">trim</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"8、在DAO层模拟创建数据库的方法\"><a href=\"#8、在DAO层模拟创建数据库的方法\" class=\"headerlink\" title=\"8、在DAO层模拟创建数据库的方法\"></a>8、在DAO层模拟创建数据库的方法</h3><p>1、在dao层创建一个dao类，例如DepartmentDao类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DepartmentDao</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>2、使用HashMap创建数据库</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DepartmentDao</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//模拟数据库中的数据</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Map&lt;Integer, Department&gt; departmentMap = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//创建一个部门表</span></span><br><span class=\"line\">        departmentMap = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;Integer,Department&gt;();</span><br><span class=\"line\">        departmentMap.put(<span class=\"number\">101</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;学交部&quot;</span>));</span><br><span class=\"line\">        departmentMap.put(<span class=\"number\">102</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">102</span>,<span class=\"string\">&quot;编辑部&quot;</span>));</span><br><span class=\"line\">        departmentMap.put(<span class=\"number\">103</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">103</span>,<span class=\"string\">&quot;后勤部&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>3、创建一个员工表</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Repository</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">EmployeeDao</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//模拟创建数据库</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Map&lt;Integer, Employee&gt; employeeMap = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DepartmentDao departmentDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//创建一个员工表</span></span><br><span class=\"line\">        employeeMap = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;Integer,Employee&gt;();</span><br><span class=\"line\">        employeeMap.put(<span class=\"number\">1</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>(<span class=\"number\">1</span>,<span class=\"string\">&quot;AA&quot;</span>,<span class=\"string\">&quot;1234@qq.com&quot;</span>,<span class=\"number\">0</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;学交部&quot;</span>),<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">        employeeMap.put(<span class=\"number\">2</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>(<span class=\"number\">2</span>,<span class=\"string\">&quot;BB&quot;</span>,<span class=\"string\">&quot;1234@qq.com&quot;</span>,<span class=\"number\">1</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;编辑部&quot;</span>),<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">        employeeMap.put(<span class=\"number\">3</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>(<span class=\"number\">3</span>,<span class=\"string\">&quot;CC&quot;</span>,<span class=\"string\">&quot;1234@qq.com&quot;</span>,<span class=\"number\">0</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;学交部&quot;</span>),<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">        employeeMap.put(<span class=\"number\">4</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>(<span class=\"number\">4</span>,<span class=\"string\">&quot;DD&quot;</span>,<span class=\"string\">&quot;1234@qq.com&quot;</span>,<span class=\"number\">1</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;后勤部&quot;</span>),<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//主键自增</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Integer</span> <span class=\"variable\">initId</span> <span class=\"operator\">=</span> <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//增加一个员工</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">add</span><span class=\"params\">(Employee employee)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (employee.getEmployeeId() == <span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            employee.setEmployeeId(initId ++);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        employee.setDepartment(departmentDao.getDepartemntById(employee.getDepartment().getDepartmentId()));</span><br><span class=\"line\">        employeeMap.put(employee.getEmployeeId(),employee);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//删除一个员工</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">deleteEmployee</span><span class=\"params\">(Integer id)</span>&#123;</span><br><span class=\"line\">        employeeMap.remove(id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//查找所有员工</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Collection&lt;Employee&gt; <span class=\"title function_\">findAllEmployee</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> employeeMap.values();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//查找一个员工</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Employee <span class=\"title function_\">findEmployeeById</span><span class=\"params\">(Integer id)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> employeeMap.get(id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"9、Spring是如何整合Mybatis将Mapper接口注册为Bean的原理？\"><a href=\"#9、Spring是如何整合Mybatis将Mapper接口注册为Bean的原理？\" class=\"headerlink\" title=\"9、Spring是如何整合Mybatis将Mapper接口注册为Bean的原理？\"></a>9、Spring是如何整合Mybatis将Mapper接口注册为Bean的原理？</h3><p>1、首先MyBatis的Mapper接口核心是JDK动态代理；<br>2、Spring会排除接口，无法注册到IOC容器中；<br>3、MyBatis实现了<code>BeanDefinitionRegistryPostProcessor</code>可以动态注册BeanDefinition；<br>4、需要自定义扫描器（继承Spring内部扫描器<code>ClassPathBeanDefinitionScanner</code>）重写排除接口的方法（<code>isCandidateComponent</code>）；<br>5、但是接口虽然注册成了BeanDefinition，但是无法实例化bean，因为接口无法实例化；<br>6、需要将BeanDefinition的BeanClass替换成JDK动态代理的实例；<br>7、Mybatis通过FactoryBean的工厂方法设计模式可以自由控制Bean的实例化过程，可以在getObject方法中创建JDK动态代理。<br>8、示例（更具体的示例查看<code>Springboot学习笔记</code>，搜索<code>仿Mybatis</code>）<br>（1）在com.example.mapper新建一个mapper接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface DemoMapper &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">select</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）新建一个类去实现FactoryBean接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DemoMapperFactoryBean</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">FactoryBean</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// 各个mapper接口的类路径名</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String className;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"title function_\">DemoMapperFactoryBean</span><span class=\"params\">(String className)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.className = className;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> DemoMapper <span class=\"title function_\">getObject</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\t\tClass&lt;?&gt; interfaceClass = Class.forName(className);</span><br><span class=\"line\">\t\t<span class=\"comment\">// 生成动态代理对象返回</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> Proxy.newProxyInstance(DemoMapperFactoryBean.class.getClassLoader(), <span class=\"keyword\">new</span> <span class=\"title class_\">Class</span>&lt;?&gt;[] &#123;interfaceClass&#125;, <span class=\"keyword\">new</span> <span class=\"title class_\">InvocationHandler</span>() &#123;</span><br><span class=\"line\">\t\t\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">public</span> Object <span class=\"title function_\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable &#123;</span><br><span class=\"line\">\t\t\t\tSystem.out.println(<span class=\"string\">&quot;执行方法：&quot;</span> + method.getName());</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\tClass&lt;?&gt; interfaceClass = Class.forName(className);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> interfaceClass;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">\t\t\te.printStackTrace();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）将DemoMapperFactoryBean注册到容器中：  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> DemoMapperFactoryBean <span class=\"title function_\">demoMapperFactoryBean</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DemoMapperFactoryBean</span>(<span class=\"string\">&quot;com.example.mapper.DemoMapper&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"10、Mapper接口传参方式\"><a href=\"#10、Mapper接口传参方式\" class=\"headerlink\" title=\"10、Mapper接口传参方式\"></a>10、Mapper接口传参方式</h3><p>1、单个简单类型参数<br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByName</span> <span class=\"params\">(String name)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByName&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- #&#123;&#125;中的参数如果参数只有一个的时候可以随便写，推荐写参数名 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;n&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>2、多个简单类型参数<br>第一种方式：使用<code>@Param</code>注解<br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(<span class=\"meta\">@Param(&quot;name&quot;)</span> String name, <span class=\"meta\">@Param(&quot;age&quot;)</span> Integer age)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;name&#125; and age = #&#123;age&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>第二种方式：使用<code>arg</code><br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(String name, Integer age)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- arg0对应接口方法中的第一个参数，arg1对应接口方法中的第二个参数 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;arg0&#125; and age = #&#123;arg1&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>第三种方式：使用<code>param</code><br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(String name, Integer age)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- param0对应接口方法中的第一个参数，param1对应接口方法中的第二个参数 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;param0&#125; and age = #&#123;param1&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>3、单个实体对象参数<br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(User user)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）service  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> TestService &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> TestMapper testMapper;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">\t\tuser.setName(<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\">\t\tuser.setAge(<span class=\"number\">18</span>);</span><br><span class=\"line\">\t\tList&lt;User&gt; list = testMapper.getListUserByNameAndAge(user);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">&quot;User&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- #&#123;&#125;中的字符串必须是和User对象中的属性名一样 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;name&#125; and age = #&#123;age&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>4、Map参数<br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(Map map)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）service  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> TestService &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> TestMapper testMapper;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">Map</span> <span class=\"variable\">map</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">\t\tmap.put(<span class=\"string\">&quot;name&quot;</span>, <span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\">\t\tmap.put(<span class=\"string\">&quot;age&quot;</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\">\t\tList&lt;User&gt; list = testMapper.getListUserByNameAndAge(map);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">&quot;Map&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- #&#123;&#125;中的字符串必须是和map对象中的key一样 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;name&#125; and age = #&#123;age&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"11、插入后返回主键\"><a href=\"#11、插入后返回主键\" class=\"headerlink\" title=\"11、插入后返回主键\"></a>11、插入后返回主键</h3><p>1、主键是自增模式<br>（1）mapper.xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">\tuseGeneratedKeys=&quot;true&quot;：使用数据库生成主键</span></span><br><span class=\"line\"><span class=\"comment\">\tkeyColumn=&quot;id&quot;：指定数据库主键的字段名</span></span><br><span class=\"line\"><span class=\"comment\">\tkeyProperty=&quot;id&quot;：指定Java实体类中用来接收主键的字段名</span></span><br><span class=\"line\"><span class=\"comment\"> --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertEmp&quot;</span> <span class=\"attr\">useGeneratedKeys</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">keyColumn</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;id&quot;</span>&gt;</span></span><br><span class=\"line\">  insert into t_emp(name,email,gender) values(#&#123;name&#125;,#&#123;email&#125;,#&#123;gender&#125;)</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>（2）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">insertEmp</span> <span class=\"params\">(Employee employee)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）service  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> TestService &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> TestMapper testMapper;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">Employee</span> <span class=\"variable\">employee</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>();</span><br><span class=\"line\">\t\temployee.setName(<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\">\t\temployee.setEmail(<span class=\"string\">&quot;zhangsan@qq.com&quot;</span>);</span><br><span class=\"line\">\t\temployee.setGender(<span class=\"string\">&quot;男&quot;</span>);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\ttestMapper.insertEmp(employee);</span><br><span class=\"line\">\t\tSystem.out.println(employee.getId());</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>2、主键是非自增模式（比如主键是varchar类型）<br>（1）mapper.xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertTeacher&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">     selectKey：插入之前，先指定一段sql语句，生成一个主键值。</span></span><br><span class=\"line\"><span class=\"comment\">\t order=&quot;before | after&quot;：sql语句是在插入语句之前还是之后执行</span></span><br><span class=\"line\"><span class=\"comment\">\t resultType=&quot;&quot;：返回值类型</span></span><br><span class=\"line\"><span class=\"comment\">\t keyProperty=&quot;&quot;：将生成出来的值给谁</span></span><br><span class=\"line\"><span class=\"comment\">  --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">order</span>=<span class=\"string\">&quot;before&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;string&quot;</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;tId&quot;</span>&gt;</span></span><br><span class=\"line\">    select replace(uuid(), &#x27;-&#x27;, &#x27;&#x27;);</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></span><br><span class=\"line\">  insert into teacher (id, name) value (#&#123;tId&#125;, #&#123;tName&#125;);</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>（2）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">insertEmp</span> <span class=\"params\">(Employee employee)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）service  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> TestService &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> TestMapper testMapper;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">Teacher</span> <span class=\"variable\">teacher</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Teacher</span>();</span><br><span class=\"line\">\t\tteacher.setName(<span class=\"string\">&quot;张三&quot;</span>)</span><br><span class=\"line\">\t\tSystem.out.println(teacher.getId());</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"12、foreach标签\"><a href=\"#12、foreach标签\" class=\"headerlink\" title=\"12、foreach标签\"></a>12、foreach标签</h3><p>1、批量查询  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- List&lt;User&gt; selectBatch(@Param(&quot;ids&quot;) List&lt;Integer&gt; idList); --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;selectBatch&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from user where id in</span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">     collection=&quot;idList | arg0 | list&quot;</span></span><br><span class=\"line\"><span class=\"comment\">\t open：遍历之前要追加的字符串</span></span><br><span class=\"line\"><span class=\"comment\">\t close：遍历结束需要添加的字符串</span></span><br><span class=\"line\"><span class=\"comment\">\t separator：每次遍历之间需要添加的字符串，如果是最后一次就不会追加了</span></span><br><span class=\"line\"><span class=\"comment\">\t item：获取每个遍历项</span></span><br><span class=\"line\"><span class=\"comment\">   --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">foreach</span> <span class=\"attr\">collection</span>=<span class=\"string\">&quot;idList&quot;</span> <span class=\"attr\">item</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">open</span>=<span class=\"string\">&quot;(&quot;</span> <span class=\"attr\">separator</span>=<span class=\"string\">&quot;,&quot;</span> <span class=\"attr\">close</span>=<span class=\"string\">&quot;)&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 对应item --&gt;</span></span><br><span class=\"line\">\t#&#123;id&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">foreach</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2、批量插入  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- void insertBatch(@Param(&quot;users&quot;) List&lt;User&gt; userList); --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertBatch&quot;</span>&gt;</span></span><br><span class=\"line\">  insert into user (name, age) values</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">foreach</span> <span class=\"attr\">collection</span>=<span class=\"string\">&quot;list&quot;</span> <span class=\"attr\">item</span>=<span class=\"string\">&quot;user&quot;</span> <span class=\"attr\">separator</span>=<span class=\"string\">&quot;,&quot;</span>&gt;</span></span><br><span class=\"line\">    (#&#123;user.name&#125;, #&#123;user.age&#125;)</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">foreach</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>3、批量更新<br>批量更新需要注意，如果一个标签涉及多个语句执行，需要设置允许指定多语句执行。<br>可以在数据库url链接后面加<code>allowMultiQueries=true</code>。<br>比如：<code>jdbc:mysql://localhost:3306/mybatis?allowMultiQueries=true</code>  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- int updateBatch(@Param(&quot;users&quot;) List&lt;User&gt; userList); --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">update</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;updateBatch&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">foreach</span> <span class=\"attr\">collection</span>=<span class=\"string\">&quot;list&quot;</span> <span class=\"attr\">item</span>=<span class=\"string\">&quot;user&quot;</span> <span class=\"attr\">separator</span>=<span class=\"string\">&quot;;&quot;</span>&gt;</span></span><br><span class=\"line\">    update user set name = #&#123;user.name&#125;, age = #&#123;user.age&#125; where id = #&#123;user.id&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">foreach</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">update</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"13、分页插件\"><a href=\"#13、分页插件\" class=\"headerlink\" title=\"13、分页插件\"></a>13、分页插件</h3><p>1、导入依赖  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.github.pagehelper<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>pagehelper<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.3.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2、配置插件<br>在mybatis-config.xml中配置插件。  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- 分页插件 --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">plugin</span> <span class=\"attr\">interceptor</span>=<span class=\"string\">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 分页参数合理化 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;helperDialect&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;mysql&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>其中，<code>com.github.pagehelper.PageInterceptor</code>是PageHelper插件的名词，<code>dialect</code>属性用于指定数据库类型（支持多种数据库）。<br>3、使用  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 调用查询方法之前必须先设置分页参数</span></span><br><span class=\"line\"><span class=\"comment\">// 第一个参数为：pageNum，表示当前页</span></span><br><span class=\"line\"><span class=\"comment\">// 第二个参数为：pageSize，表示每页显示的条数</span></span><br><span class=\"line\"><span class=\"comment\">// 注意：这里这个设置分页参数方法只针对一个查询方法，如果有多个查询方法，需要多次设置</span></span><br><span class=\"line\">PageHelper.startPage(<span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">List&lt;User&gt; userList = userMapper.selectBatch();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 将查询到的结果封装到一个PageInfo的分页实体类中</span></span><br><span class=\"line\">PageInfo&lt;User&gt; pageInfo = <span class=\"keyword\">new</span> <span class=\"title class_\">PageInfo</span>&lt;&gt;(userList);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 当前页</span></span><br><span class=\"line\">pageInfo.getPageNum();</span><br><span class=\"line\"><span class=\"comment\">// 总页数</span></span><br><span class=\"line\">pageInfo.getPages();</span><br><span class=\"line\"><span class=\"comment\">// 总条数</span></span><br><span class=\"line\">pageInfo.getTotal();</span><br><span class=\"line\"><span class=\"comment\">// 当前页的条数</span></span><br><span class=\"line\">pageInfo.getSize();</span><br><span class=\"line\"><span class=\"comment\">// 当前页的数据</span></span><br><span class=\"line\">pageInfo.getList();</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"14、生成代码\"><a href=\"#14、生成代码\" class=\"headerlink\" title=\"14、生成代码\"></a>14、生成代码</h3><p>MyBatisX 是一个 MyBatis 的代码生成插件，可以通过简单的配置和操作快速生成 MyBatis Mapper、pojo 类和 Mapper.xml 文件。下面是使用 MyBatisX 插件实现逆向工程的步骤：<br>1、安装插件<br>在 IntelliJ IDEA 中打开插件市场，搜索 MyBatisX 并安装。<br>2、使用 IntelliJ IDEA连接数据库<br>（1）连接数据库  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/0.png\" class=\"\">  \n<p>（2）填写信息  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.png\" class=\"\">  \n<p>（3）展示库表  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.png\" class=\"\">  \n<p>（4）生成代码  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/3.png\" class=\"\">  \n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/4.png\" class=\"\">  \n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/5.png\" class=\"\">  \n<p>（5）查看结果  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/6.png\" class=\"\">  \n\n\n<h3 id=\"15、鉴别器\"><a href=\"#15、鉴别器\" class=\"headerlink\" title=\"15、鉴别器\"></a>15、鉴别器</h3><p>1、说明<br><code>discriminator</code>标签在MyBatis中是一种用于实现结果映射（ResultMap）的动态分支选择 的标签。它类似于Java中的switch-case或if-else逻辑，可以根据查询结果中的某个字段值（鉴别器字段）动态决定如何映射不同的结果类型。<br>2、作用<br>根据某个字段的值（如user_type、status等），动态选择不同的映射规则，适用于继承关系或多态查询。<br>3、示例<br>假设有一个 user 表，包含不同类型的用户（type 字段决定用户角色）：<br>（1）<code>type=1</code>：普通用户（GeneralUser）；<br>（2）<code>type=2</code>：VIP用户（VipUser）；<br>（3）<code>其他</code>：默认映射到基础用户（User）。<br>Java实体类：  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer type; <span class=\"comment\">// 鉴别字段：1=普通用户，2=VIP用户</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">GeneralUser</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String generalField; <span class=\"comment\">// 普通用户特有字段</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">VipUser</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String vipField; <span class=\"comment\">// VIP用户特有字段</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 基础映射 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;userMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;id&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;name&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;type&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;type&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 动态分支选择 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">discriminator</span> <span class=\"attr\">javaType</span>=<span class=\"string\">&quot;int&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;type&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">case</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;generalUserMap&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">case</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;2&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;vipUserMap&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">case</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;userMap&quot;</span>/&gt;</span> <span class=\"comment\">&lt;!-- 默认映射 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">discriminator</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 普通用户子映射 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;generalUserMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;GeneralUser&quot;</span> <span class=\"attr\">extends</span>=<span class=\"string\">&quot;userMap&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;generalField&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;general_field&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- VIP用户子映射 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;vipUserMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;VipUser&quot;</span> <span class=\"attr\">extends</span>=<span class=\"string\">&quot;userMap&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;vipField&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;vip_field&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getUserById&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;userMap&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT id, name, type, general_field, vip_field</span><br><span class=\"line\">    FROM user</span><br><span class=\"line\">    WHERE id = #&#123;id&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"16、sql标签\"><a href=\"#16、sql标签\" class=\"headerlink\" title=\"16、sql标签\"></a>16、sql标签</h3><p>在sql标签中使用变量别名。  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">sql</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dynamicAliasColumns&quot;</span>&gt;</span></span><br><span class=\"line\">    $&#123;tableAlias&#125;.id as $&#123;columnPrefix&#125;Id,</span><br><span class=\"line\">    $&#123;tableAlias&#125;.name as $&#123;columnPrefix&#125;Name</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">sql</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;selectData&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;map&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">include</span> <span class=\"attr\">refid</span>=<span class=\"string\">&quot;dynamicAliasColumns&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;tableAlias&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;u&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;columnPrefix&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;user&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span>,</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">include</span> <span class=\"attr\">refid</span>=<span class=\"string\">&quot;dynamicAliasColumns&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;tableAlias&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;d&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;columnPrefix&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;dept&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">    FROM user u</span><br><span class=\"line\">    LEFT JOIN department d ON u.dept_id = d.id</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"17、trim标签\"><a href=\"#17、trim标签\" class=\"headerlink\" title=\"17、trim标签\"></a>17、trim标签</h3><p><code>trim</code>标签中有四个属性：<br>（1）<code>prefix</code>：前缀，给拼接后的字符串拼接上一个前缀；<br>（2）<code>prefixOverrides</code>：前缀覆盖，去掉多余的字符；<br>（3）<code>suffix</code>：后缀，给拼接后的字符串拼接上一个后缀；<br>（4）<code>suffixOverrides</code>：后缀覆盖，去掉多余的字符。  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findUser&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from user</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">trim</span> <span class=\"attr\">prefix</span>=<span class=\"string\">&quot;where&quot;</span> <span class=\"attr\">suffixOverrides</span>=<span class=\"string\">&quot;and&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;id != 0&quot;</span>&gt;</span></span><br><span class=\"line\">        id=#&#123;id&#125; and</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;username != null&quot;</span>&gt;</span></span><br><span class=\"line\">        sex=#&#123;sex&#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">trim</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>说明：<br>（1）<code>prefix=&quot;where&quot;</code>：如果内容不为空，在最前面添加”where”关键字；<br>（2）<code>suffixOverrides=&quot;and&quot;</code>：如果内容以”and”结尾，移除最后的”and”。  </p>\n<h3 id=\"18、choose标签\"><a href=\"#18、choose标签\" class=\"headerlink\" title=\"18、choose标签\"></a>18、choose标签</h3><p>只会执行一个条件。<br>1、基本语法  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;条件1&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- SQL片段1 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;条件2&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- SQL片段2 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 默认SQL片段 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2、示例一：根据不同搜索类型查询  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;searchUsers&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT * FROM users</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;searchType == &#x27;name&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">                AND name LIKE CONCAT(&#x27;%&#x27;, #&#123;keyword&#125;, &#x27;%&#x27;)</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;searchType == &#x27;email&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">                AND email LIKE CONCAT(&#x27;%&#x27;, #&#123;keyword&#125;, &#x27;%&#x27;)</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;searchType == &#x27;phone&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">                AND phone = #&#123;keyword&#125;</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">                AND (name LIKE CONCAT(&#x27;%&#x27;, #&#123;keyword&#125;, &#x27;%&#x27;) </span><br><span class=\"line\">                OR email LIKE CONCAT(&#x27;%&#x27;, #&#123;keyword&#125;, &#x27;%&#x27;))</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>说明：（只会执行一个条件）<br>（1）如果满足<code>searchType == &#39;name&#39;</code>，就执行<code>AND name LIKE CONCAT(&#39;%&#39;, #&#123;keyword&#125;, &#39;%&#39;)</code>；<br>（2）如果满足<code>searchType == &#39;email&#39;</code>，就执行<code>AND email LIKE CONCAT(&#39;%&#39;, #&#123;keyword&#125;, &#39;%&#39;)</code>；<br>（3）如果满足<code>searchType == &#39;phone&#39;</code>，就执行<code>AND phone = #&#123;keyword&#125;</code>；<br>（4）如果上面都不满足，就执行<code>otherwise</code>标签中的内容。<br>3、示例二：多条件优先级查询  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findSpecialUsers&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT * FROM users</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;vipFlag != null and vipFlag == true&quot;</span>&gt;</span></span><br><span class=\"line\">                AND is_vip = 1  <span class=\"comment\">&lt;!-- 优先查询VIP用户 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;age != null&quot;</span>&gt;</span></span><br><span class=\"line\">                AND age = #&#123;age&#125;  <span class=\"comment\">&lt;!-- 其次按年龄查询 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;gender != null&quot;</span>&gt;</span></span><br><span class=\"line\">                AND gender = #&#123;gender&#125;  <span class=\"comment\">&lt;!-- 最后按性别查询 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">                AND status = &#x27;ACTIVE&#x27;  <span class=\"comment\">&lt;!-- 默认查询活跃用户 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>4、注意<br>（1）<code>&lt;choose&gt;</code>标签内必须有至少一个<code>&lt;when&gt;</code>子标签；<br>（2）<code>&lt;otherwise&gt;</code>是可选的，最多只能有一个；<br>（3）条件判断是按照<code>&lt;when&gt;</code>的顺序进行的，第一个满足条件的会被执行;<br>（4）可以嵌套使用，但不宜嵌套过深影响可读性；<br>（5）通常与<code>&lt;where&gt;</code>标签结合使用，避免SQL语法错误。  </p>\n<h3 id=\"19、Mybatis内置参数\"><a href=\"#19、Mybatis内置参数\" class=\"headerlink\" title=\"19、Mybatis内置参数\"></a>19、Mybatis内置参数</h3><p>注意：使用内置参数时不需要在方法参数中声明。<br>1、<code>_parameter</code>常用<br>（1）含义：代表整个传入的参数对象。<br>（2）用法  </p>\n<ul>\n<li>如果方法只有一个参数：_parameter 就代表这个参数本身；  </li>\n<li>如果方法有多个参数：_parameter 代表所有参数组成的 Map。</li>\n</ul>\n<p>（3）示例  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findUser&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT * FROM user</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_parameter != null&quot;</span>&gt;</span></span><br><span class=\"line\">            AND username LIKE CONCAT(&#x27;%&#x27;, #&#123;_parameter&#125;, &#x27;%&#x27;)</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>2、<code>_databaseId</code>常用<br>（1）含义：代表当前配置的数据库厂商标识。<br>（2）用法：用于编写多数据库支持的 SQL 语句。<br>（3）示例<br>需要在Mybatis配置文件中配置：  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">databaseIdProvider</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;DB_VENDOR&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;MySQL&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;mysql&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;Oracle&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;oracle&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;DB2&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;db2&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">databaseIdProvider</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertUser&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;int&quot;</span> <span class=\"attr\">order</span>=<span class=\"string\">&quot;BEFORE&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;oracle&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT seq_user.nextval FROM dual</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;db2&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            VALUES nextval for seq_user</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;mysql&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT LAST_INSERT_ID()</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></span><br><span class=\"line\">    INSERT INTO user(id, name) VALUES(#&#123;id&#125;, #&#123;name&#125;)</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>3、其它示例一：根据参数类型动态判断  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findByCondition&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT * FROM user</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_parameter instanceof java.util.Map&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- 当参数是Map时 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;mapParam.username != null&quot;</span>&gt;</span></span><br><span class=\"line\">                AND username = #&#123;mapParam.username&#125;</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_parameter instanceof com.example.User&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- 当参数是User对象时 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;id != null&quot;</span>&gt;</span></span><br><span class=\"line\">                AND id = #&#123;id&#125;</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>4、其它示例二：多数据库支持  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getCurrentDate&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;string&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;oracle&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT TO_CHAR(SYSDATE, &#x27;YYYY-MM-DD&#x27;) FROM dual</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;mysql&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT DATE_FORMAT(NOW(), &#x27;%Y-%m-%d&#x27;)</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;postgresql&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT TO_CHAR(NOW(), &#x27;YYYY-MM-DD&#x27;)</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">            SELECT CONVERT(VARCHAR(10), GETDATE(), 120)</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"20、sql标签动态别名用法\"><a href=\"#20、sql标签动态别名用法\" class=\"headerlink\" title=\"20、sql标签动态别名用法\"></a>20、sql标签动态别名用法</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">sql</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;test&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"comment\">&lt;!-- 如果有别名就执行 --&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_parameter != null and _parameter[&#x27;tableAlias&#x27;] != null and _parameter[&#x27;tableAlias&#x27;] != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.user_id,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.dept_id,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.user_name,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.nick_name,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.email,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.avatar,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.phonenumber,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.password,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.sex,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.status,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.del_flag,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.login_ip,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.login_date,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.create_by,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.create_time,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.remark</span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">&lt;!-- 如果没有别名就执行 --&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">\t\t\t\tuser_id, dept_id, user_name, nick_name, email, avatar, phonenumber, password, sex, status, del_flag, login_ip, login_date, create_by, create_time, remark</span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">sql</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;testOne&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;SysUserResult&quot;</span>&gt;</span></span><br><span class=\"line\">\t\tselect <span class=\"tag\">&lt;<span class=\"name\">include</span> <span class=\"attr\">refid</span>=<span class=\"string\">&quot;test&quot;</span>/&gt;</span> from sys_user</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;testTwo&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;SysUserResult&quot;</span>&gt;</span></span><br><span class=\"line\">\t\tselect <span class=\"tag\">&lt;<span class=\"name\">include</span> <span class=\"attr\">refid</span>=<span class=\"string\">&quot;test&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;tableAlias&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;u&quot;</span>/&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span>from sys_user u</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"21、不使用分页插件，实现分页复用\"><a href=\"#21、不使用分页插件，实现分页复用\" class=\"headerlink\" title=\"21、不使用分页插件，实现分页复用\"></a>21、不使用分页插件，实现分页复用</h3><p>使用MyBatis的动态SQL和Java代码来实现复用。<br>通用的分页工具类：  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PageHelper</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">appendPageSql</span><span class=\"params\">(String sql, <span class=\"type\">int</span> pageNum, <span class=\"type\">int</span> pageSize)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">offset</span> <span class=\"operator\">=</span> (pageNum - <span class=\"number\">1</span>) * pageSize;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sql + <span class=\"string\">&quot; LIMIT &quot;</span> + pageSize + <span class=\"string\">&quot; OFFSET &quot;</span> + offset;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>然后在Mapper接口中调用：  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SelectProvider(type = UserSqlProvider.class, method = &quot;getUserListSql&quot;)</span></span><br><span class=\"line\">List&lt;User&gt; <span class=\"title function_\">getUserList</span><span class=\"params\">(<span class=\"type\">int</span> status, <span class=\"type\">int</span> pageNum, <span class=\"type\">int</span> pageSize)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">UserSqlProvider</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getUserListSql</span><span class=\"params\">(<span class=\"type\">int</span> status, <span class=\"type\">int</span> pageNum, <span class=\"type\">int</span> pageSize)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">sql</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;SELECT id, username, email FROM users WHERE status = #&#123;status&#125;&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> PageHelper.appendPageSql(sql, pageNum, pageSize);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这样，任何需要分页的查询都可以复用PageHelper，只需要传入页码和每页大小即可。这种方式在Java层实现了SQL的动态拼接，既灵活又可控。  </p>\n","more":"<hr>\n<h1 id=\"一、中文学习文档链接地址\"><a href=\"#一、中文学习文档链接地址\" class=\"headerlink\" title=\"一、中文学习文档链接地址\"></a>一、中文学习文档链接地址</h1><p>&emsp;&emsp;<a href=\"https://mybatis.org/mybatis-3/zh_CN/index.html\">https://mybatis.org/mybatis-3/zh_CN&#x2F;index.html</a></p>\n<br/>\n\n<hr>\n<br/>\n\n<h1 id=\"二、依赖配置\"><a href=\"#二、依赖配置\" class=\"headerlink\" title=\"二、依赖配置\"></a>二、依赖配置</h1><h3 id=\"1、所需依赖\"><a href=\"#1、所需依赖\" class=\"headerlink\" title=\"1、所需依赖\"></a>1、所需依赖</h3><p>要使用myBatis，要导入两个依赖，一个是myBatis包，一个是myBatis驱动包。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- mysql驱动 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>8.0.20<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- mybatis --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.2.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>或者</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 这个包含了上面两个依赖 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、配置\"><a href=\"#2、配置\" class=\"headerlink\" title=\"2、配置\"></a>2、配置</h3><p>数据库URL</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">jdbc</span>:<span class=\"string\">mysql://localhost:3306/stu?useSSL=true&amp;amp;useUnicode=true&amp;amp;serverTimezone=GMT</span></span><br></pre></td></tr></table></figure>\n\n<br/>\n\n<hr>\n<br/>\n\n<h1 id=\"三、学习笔记\"><a href=\"#三、学习笔记\" class=\"headerlink\" title=\"三、学习笔记\"></a>三、学习笔记</h1><h3 id=\"1、XML文件里的结果集映射\"><a href=\"#1、XML文件里的结果集映射\" class=\"headerlink\" title=\"1、XML文件里的结果集映射\"></a>1、XML文件里的结果集映射</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--这里的id对应select里resultMap，resultMap里是什么，这里的id就是什么--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;UserMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- column为数据库里的字段名，property为实例类中的属性名--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;id&quot;</span>/&gt;</span> </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;name&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;pwd&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;password&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getUserById&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;UserMap&quot;</span>&gt;</span> <span class=\"comment\">&lt;!--这里的resultMap随意取--&gt;</span></span><br><span class=\"line\">    select * from user where id=#&#123;id&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、多对一查询方法\"><a href=\"#2、多对一查询方法\" class=\"headerlink\" title=\"2、多对一查询方法\"></a>2、多对一查询方法</h3><p>1、第一种方法  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pojo.Student</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Student</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String aname;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Teacher teacher;</span><br><span class=\"line\">    <span class=\"comment\">// getter和setter方法</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// pojo.Teacher</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Teacher</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tname;</span><br><span class=\"line\">    <span class=\"comment\">// getter和setter方法</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- StudentTeacher随便取--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findAll&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;StudentTeacher&quot;</span>&gt;</span></span><br><span class=\"line\">        select * from student</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--StudentTeacher要对应上面随便取的名字--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;StudentTeacher&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;pojo.Student&quot;</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"comment\">&lt;!--getTeacher要对应下面随便取的名字，tid是副表当中对应主表id的字段--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">association</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;teacher&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;tid&quot;</span> <span class=\"attr\">javaType</span>=<span class=\"string\">&quot;pojo.Teacher&quot;</span> <span class=\"attr\">select</span>=<span class=\"string\">&quot;getTeacher&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">association</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getTeacher&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;pojo.Teacher&quot;</span>&gt;</span> <span class=\"comment\">&lt;!--getTeacher随便取--&gt;</span></span><br><span class=\"line\">        select * from teacher where id=#&#123;id&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2、第二种方法  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findAllOne&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;StudentTeacher2&quot;</span>&gt;</span></span><br><span class=\"line\">        select s.id sid,s.name sname,t.name tname </span><br><span class=\"line\">        from student s,teacher t </span><br><span class=\"line\">        where s.tid=t.id</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;StudentTeacher2&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;pojo.Student&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;sid&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">result</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;sname&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">result</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">association</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;teacher&quot;</span> <span class=\"attr\">javaType</span>=<span class=\"string\">&quot;pojo.Teacher&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;tname&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">result</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">association</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>3、第三种方法（分步查询）  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- mapper层：--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 通过分步查询员工以及员工所对应的部门信息 --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 分步查询第一步：查询员工信息 --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Emp getEmpAndDeptByStepOne(@Param(&quot;uid&quot;)String uid); --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 分步查询第二步：查询部门信息 --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Dept getEmpAndDeptStepTwo(@Param(&quot;did&quot;)String did); --&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- mapper.xml：--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;empAndDeptByStepResultMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;Emp&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;uid&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;uid&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;empName&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;emp_name&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- 不是驼峰命名的属性可以不写，它自动就映射了 --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;age&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;age&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;sex&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;sex&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- 这里的dept是Emp实体类中的属性，类型为Dept  --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">association</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">select</span>=<span class=\"string\">&quot;getEmpAndDeptStepTwo&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;did&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">association</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getEmpAndDeptByStepOne&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;empAndDeptByStepResultMap&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from t_emp where uid = #&#123;uid&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getEmpAndDeptStepTwo&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;Dept&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from t_dept where did = #&#123;did&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">\t将多列值封装为map传递，写法：columu=&quot;&#123;key1=column1,key2=column2&#125;&quot;</span></span><br><span class=\"line\"><span class=\"comment\">\tkey1代表第二条查询语句的数据库字段，column1代表当前要传递的值</span></span><br><span class=\"line\"><span class=\"comment\"> --&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3、一对多查询方法\"><a href=\"#3、一对多查询方法\" class=\"headerlink\" title=\"3、一对多查询方法\"></a>3、一对多查询方法</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 客户实体类，一个客户有多个订单</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Customer</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Integer customerId;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String customerName;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> List&lt;Order&gt; orders;</span><br><span class=\"line\">\t<span class=\"comment\">// getter和setter</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 订单实体类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Order</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Integer orderId;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String orderName;</span><br><span class=\"line\">\t<span class=\"comment\">// getter和setter</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;customerMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;customer&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">colimn</span>=<span class=\"string\">&quot;customer_id&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;customerId&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;customer_name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;customerName&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">     property：集合属性名，和Customer实体类中的List&lt;Order&gt; orders保持一致</span></span><br><span class=\"line\"><span class=\"comment\">\t ofType：集合的泛型类型，和Customer实体类中的List&lt;Order&gt; orders保持一致</span></span><br><span class=\"line\"><span class=\"comment\">   --&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">collection</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;orders&quot;</span> <span class=\"attr\">ofType</span>=<span class=\"string\">&quot;order&quot;</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;order_id&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;orderId&quot;</span> /&gt;</span></span><br><span class=\"line\">\t <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;order_name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;orderName&quot;</span> /&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">collection</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;queryList&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;customerMap&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from t_order tor join t_customer tur on tor.customer_id = tur.customer</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"4、分页查询\"><a href=\"#4、分页查询\" class=\"headerlink\" title=\"4、分页查询\"></a>4、分页查询</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--startIndex 是数据的下标  pageSize是显示多少条数据--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findAllMap&quot;</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">&quot;map&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;pojo.User&quot;</span>&gt;</span></span><br><span class=\"line\">        select * from user limit #&#123;startIndex&#125;,#&#123;pageSize&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// MybatisUtil工具类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MybatisUtil</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">SqlSessionFactory</span> <span class=\"variable\">factory</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">config</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;mybatis.xml&quot;</span>;</span><br><span class=\"line\">         <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">              <span class=\"type\">InputStream</span> <span class=\"variable\">inputStream</span> <span class=\"operator\">=</span> Resource.getResourceAsStream(config);</span><br><span class=\"line\">              factory = <span class=\"keyword\">new</span> <span class=\"title class_\">SqlSessionFactoryBuilder</span>().build(inputStream);</span><br><span class=\"line\">          &#125;<span class=\"keyword\">catch</span>(IOException e)&#123;</span><br><span class=\"line\">              e.printStackTrace();</span><br><span class=\"line\">          &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> SqlSession <span class=\"title function_\">getSqlSession</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">SqlSession</span> <span class=\"variable\">session</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(factory != <span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            factory.openSession();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> session;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Dao层方法：</span></span><br><span class=\"line\">List&lt;User&gt; <span class=\"title function_\">findAllMap</span><span class=\"params\">(Map&lt;String,Integer&gt; map)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 测试：</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">SqlSession</span> <span class=\"variable\">sqlSession</span> <span class=\"operator\">=</span> MybatisUtil.getSqlSession();</span><br><span class=\"line\">        <span class=\"type\">UserDao</span> <span class=\"variable\">mapper</span> <span class=\"operator\">=</span> sqlSession.getMapper(UserDao.class);</span><br><span class=\"line\"><span class=\"comment\">//        List&lt;User&gt; userList = mapper.findAll();</span></span><br><span class=\"line\"><span class=\"comment\">//        for (User user :</span></span><br><span class=\"line\"><span class=\"comment\">//                userList) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//            System.out.println(user);</span></span><br><span class=\"line\"><span class=\"comment\">//        &#125;</span></span><br><span class=\"line\">        HashMap&lt;String, Integer&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;String, Integer&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;startIndex&quot;</span>,<span class=\"number\">2</span>);</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;pageSize&quot;</span>,<span class=\"number\">4</span>);</span><br><span class=\"line\">        List&lt;User&gt; userList = mapper.findAllMap(map);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : userList) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        sqlSession.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5、模糊查询\"><a href=\"#5、模糊查询\" class=\"headerlink\" title=\"5、模糊查询\"></a>5、模糊查询</h3><p>1、第一种方法<br>（1）Java代码执行的时候，传递通配符 <code>% %</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;User&gt; userList = mapper.getUserLike(<span class=\"string\">&quot;%李%&quot;</span>); <span class=\"comment\">//查询姓李的人</span></span><br></pre></td></tr></table></figure>\n<p>（2）在sql拼接中使用通配符</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">where</span> name <span class=\"keyword\">like</span> &quot;%&quot; #&#123;<span class=\"keyword\">value</span>&#125; &quot;%&quot;;</span><br></pre></td></tr></table></figure>\n<p>2、第二种方法<br>在xml查询中直接使用<code>concat</code>，比如：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">where</span> name <span class=\"keyword\">like</span> concat(&quot;%&quot;,#&#123;<span class=\"keyword\">value</span>&#125;,&quot;%&quot;);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6、关于-“-”-和-“-”-的使用\"><a href=\"#6、关于-“-”-和-“-”-的使用\" class=\"headerlink\" title=\"6、关于 “#” 和 “$” 的使用\"></a>6、关于 “#” 和 “$” 的使用</h3><p><strong>说明：</strong>因为 “$” 不是安全的，会造成sql注入，所以一般查询条件使用 “#”，后者是直接将字符串原模原样映射到sql语句中的。<br>例子：</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 传的参数是：</span><br><span class=\"line\"><span class=\"built_in\">public</span> <span class=\"keyword\">User</span> getUser(<span class=\"type\">int</span> id);</span><br><span class=\"line\"></span><br><span class=\"line\">// 写的<span class=\"keyword\">sql</span>语句是：</span><br><span class=\"line\">&lt;<span class=\"keyword\">select</span> id=&quot;getUser&quot;&gt;</span><br><span class=\"line\">    <span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> $&#123;id&#125; <span class=\"keyword\">desc</span></span><br><span class=\"line\">&lt;/<span class=\"keyword\">select</span>&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">// 实际上输出的<span class=\"keyword\">sql</span>语句是：</span><br><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> id <span class=\"keyword\">desc</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7、新增数据之后自动获取数据主键\"><a href=\"#7、新增数据之后自动获取数据主键\" class=\"headerlink\" title=\"7、新增数据之后自动获取数据主键\"></a>7、新增数据之后自动获取数据主键</h3><p>1、第一种：  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 说明：--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- useGenerateKeys：开启自动获取主键功能 --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- keyProperty：将获取的主键用什么属性接收（获取主键id，肯定是用id来接收了）--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;xxxx&quot;</span> <span class=\"attr\">useGenerateKeys</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;id&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>2、第二种：  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertHepKbesPlanProgramme&quot;</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">&quot;HepKbesPlanProgrammeEvent&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 说明：</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\tselectKey标签是获取新增数据之后自动获取数据主键</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\tkeyProperty：将获取的主键用什么属性接收（获取主键id，肯定是用id来接收了）</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\tresultType：返回主键的类型</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\torder：指定selectKey标签中的sql语句在insert语句之前还是之后执行（AFTER/BEFORE）</span></span><br><span class=\"line\"><span class=\"comment\">\t\t--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;programmeId&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;Long&quot;</span> <span class=\"attr\">order</span>=<span class=\"string\">&quot;AFTER&quot;</span>&gt;</span></span><br><span class=\"line\">            select LAST_INSERT_ID()</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></span><br><span class=\"line\">        insert into hep_kbes_plan_programme_event</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">trim</span> <span class=\"attr\">prefix</span>=<span class=\"string\">&quot;(&quot;</span> <span class=\"attr\">suffix</span>=<span class=\"string\">&quot;)&quot;</span> <span class=\"attr\">suffixOverrides</span>=<span class=\"string\">&quot;,&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;planId != null&quot;</span>&gt;</span>plan_id,<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t...</span><br><span class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">trim</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">trim</span> <span class=\"attr\">prefix</span>=<span class=\"string\">&quot;values (&quot;</span> <span class=\"attr\">suffix</span>=<span class=\"string\">&quot;)&quot;</span> <span class=\"attr\">suffixOverrides</span>=<span class=\"string\">&quot;,&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;planId != null&quot;</span>&gt;</span>#&#123;planId&#125;,<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t...</span><br><span class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">trim</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"8、在DAO层模拟创建数据库的方法\"><a href=\"#8、在DAO层模拟创建数据库的方法\" class=\"headerlink\" title=\"8、在DAO层模拟创建数据库的方法\"></a>8、在DAO层模拟创建数据库的方法</h3><p>1、在dao层创建一个dao类，例如DepartmentDao类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DepartmentDao</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>2、使用HashMap创建数据库</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DepartmentDao</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//模拟数据库中的数据</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Map&lt;Integer, Department&gt; departmentMap = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//创建一个部门表</span></span><br><span class=\"line\">        departmentMap = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;Integer,Department&gt;();</span><br><span class=\"line\">        departmentMap.put(<span class=\"number\">101</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;学交部&quot;</span>));</span><br><span class=\"line\">        departmentMap.put(<span class=\"number\">102</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">102</span>,<span class=\"string\">&quot;编辑部&quot;</span>));</span><br><span class=\"line\">        departmentMap.put(<span class=\"number\">103</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">103</span>,<span class=\"string\">&quot;后勤部&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>3、创建一个员工表</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Repository</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">EmployeeDao</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//模拟创建数据库</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Map&lt;Integer, Employee&gt; employeeMap = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DepartmentDao departmentDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//创建一个员工表</span></span><br><span class=\"line\">        employeeMap = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;Integer,Employee&gt;();</span><br><span class=\"line\">        employeeMap.put(<span class=\"number\">1</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>(<span class=\"number\">1</span>,<span class=\"string\">&quot;AA&quot;</span>,<span class=\"string\">&quot;1234@qq.com&quot;</span>,<span class=\"number\">0</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;学交部&quot;</span>),<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">        employeeMap.put(<span class=\"number\">2</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>(<span class=\"number\">2</span>,<span class=\"string\">&quot;BB&quot;</span>,<span class=\"string\">&quot;1234@qq.com&quot;</span>,<span class=\"number\">1</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;编辑部&quot;</span>),<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">        employeeMap.put(<span class=\"number\">3</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>(<span class=\"number\">3</span>,<span class=\"string\">&quot;CC&quot;</span>,<span class=\"string\">&quot;1234@qq.com&quot;</span>,<span class=\"number\">0</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;学交部&quot;</span>),<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">        employeeMap.put(<span class=\"number\">4</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>(<span class=\"number\">4</span>,<span class=\"string\">&quot;DD&quot;</span>,<span class=\"string\">&quot;1234@qq.com&quot;</span>,<span class=\"number\">1</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Department</span>(<span class=\"number\">101</span>,<span class=\"string\">&quot;后勤部&quot;</span>),<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//主键自增</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Integer</span> <span class=\"variable\">initId</span> <span class=\"operator\">=</span> <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//增加一个员工</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">add</span><span class=\"params\">(Employee employee)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (employee.getEmployeeId() == <span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            employee.setEmployeeId(initId ++);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        employee.setDepartment(departmentDao.getDepartemntById(employee.getDepartment().getDepartmentId()));</span><br><span class=\"line\">        employeeMap.put(employee.getEmployeeId(),employee);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//删除一个员工</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">deleteEmployee</span><span class=\"params\">(Integer id)</span>&#123;</span><br><span class=\"line\">        employeeMap.remove(id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//查找所有员工</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Collection&lt;Employee&gt; <span class=\"title function_\">findAllEmployee</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> employeeMap.values();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//查找一个员工</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Employee <span class=\"title function_\">findEmployeeById</span><span class=\"params\">(Integer id)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> employeeMap.get(id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"9、Spring是如何整合Mybatis将Mapper接口注册为Bean的原理？\"><a href=\"#9、Spring是如何整合Mybatis将Mapper接口注册为Bean的原理？\" class=\"headerlink\" title=\"9、Spring是如何整合Mybatis将Mapper接口注册为Bean的原理？\"></a>9、Spring是如何整合Mybatis将Mapper接口注册为Bean的原理？</h3><p>1、首先MyBatis的Mapper接口核心是JDK动态代理；<br>2、Spring会排除接口，无法注册到IOC容器中；<br>3、MyBatis实现了<code>BeanDefinitionRegistryPostProcessor</code>可以动态注册BeanDefinition；<br>4、需要自定义扫描器（继承Spring内部扫描器<code>ClassPathBeanDefinitionScanner</code>）重写排除接口的方法（<code>isCandidateComponent</code>）；<br>5、但是接口虽然注册成了BeanDefinition，但是无法实例化bean，因为接口无法实例化；<br>6、需要将BeanDefinition的BeanClass替换成JDK动态代理的实例；<br>7、Mybatis通过FactoryBean的工厂方法设计模式可以自由控制Bean的实例化过程，可以在getObject方法中创建JDK动态代理。<br>8、示例（更具体的示例查看<code>Springboot学习笔记</code>，搜索<code>仿Mybatis</code>）<br>（1）在com.example.mapper新建一个mapper接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface DemoMapper &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">select</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）新建一个类去实现FactoryBean接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DemoMapperFactoryBean</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">FactoryBean</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// 各个mapper接口的类路径名</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String className;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"title function_\">DemoMapperFactoryBean</span><span class=\"params\">(String className)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.className = className;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> DemoMapper <span class=\"title function_\">getObject</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\t\tClass&lt;?&gt; interfaceClass = Class.forName(className);</span><br><span class=\"line\">\t\t<span class=\"comment\">// 生成动态代理对象返回</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> Proxy.newProxyInstance(DemoMapperFactoryBean.class.getClassLoader(), <span class=\"keyword\">new</span> <span class=\"title class_\">Class</span>&lt;?&gt;[] &#123;interfaceClass&#125;, <span class=\"keyword\">new</span> <span class=\"title class_\">InvocationHandler</span>() &#123;</span><br><span class=\"line\">\t\t\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">public</span> Object <span class=\"title function_\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable &#123;</span><br><span class=\"line\">\t\t\t\tSystem.out.println(<span class=\"string\">&quot;执行方法：&quot;</span> + method.getName());</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\tClass&lt;?&gt; interfaceClass = Class.forName(className);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> interfaceClass;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">\t\t\te.printStackTrace();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）将DemoMapperFactoryBean注册到容器中：  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> DemoMapperFactoryBean <span class=\"title function_\">demoMapperFactoryBean</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DemoMapperFactoryBean</span>(<span class=\"string\">&quot;com.example.mapper.DemoMapper&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"10、Mapper接口传参方式\"><a href=\"#10、Mapper接口传参方式\" class=\"headerlink\" title=\"10、Mapper接口传参方式\"></a>10、Mapper接口传参方式</h3><p>1、单个简单类型参数<br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByName</span> <span class=\"params\">(String name)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByName&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- #&#123;&#125;中的参数如果参数只有一个的时候可以随便写，推荐写参数名 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;n&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>2、多个简单类型参数<br>第一种方式：使用<code>@Param</code>注解<br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(<span class=\"meta\">@Param(&quot;name&quot;)</span> String name, <span class=\"meta\">@Param(&quot;age&quot;)</span> Integer age)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;name&#125; and age = #&#123;age&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>第二种方式：使用<code>arg</code><br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(String name, Integer age)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- arg0对应接口方法中的第一个参数，arg1对应接口方法中的第二个参数 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;arg0&#125; and age = #&#123;arg1&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>第三种方式：使用<code>param</code><br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(String name, Integer age)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- param0对应接口方法中的第一个参数，param1对应接口方法中的第二个参数 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;param0&#125; and age = #&#123;param1&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>3、单个实体对象参数<br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(User user)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）service  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> TestService &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> TestMapper testMapper;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">\t\tuser.setName(<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\">\t\tuser.setAge(<span class=\"number\">18</span>);</span><br><span class=\"line\">\t\tList&lt;User&gt; list = testMapper.getListUserByNameAndAge(user);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">&quot;User&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- #&#123;&#125;中的字符串必须是和User对象中的属性名一样 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;name&#125; and age = #&#123;age&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>4、Map参数<br>（1）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\tList&lt;User&gt; <span class=\"title function_\">getListUserByNameAndAge</span> <span class=\"params\">(Map map)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（2）service  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> TestService &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> TestMapper testMapper;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">Map</span> <span class=\"variable\">map</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">\t\tmap.put(<span class=\"string\">&quot;name&quot;</span>, <span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\">\t\tmap.put(<span class=\"string\">&quot;age&quot;</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\">\t\tList&lt;User&gt; list = testMapper.getListUserByNameAndAge(map);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getListUserByNameAndAge&quot;</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">&quot;Map&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- #&#123;&#125;中的字符串必须是和map对象中的key一样 --&gt;</span></span><br><span class=\"line\">  select * from user where name = #&#123;name&#125; and age = #&#123;age&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"11、插入后返回主键\"><a href=\"#11、插入后返回主键\" class=\"headerlink\" title=\"11、插入后返回主键\"></a>11、插入后返回主键</h3><p>1、主键是自增模式<br>（1）mapper.xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">\tuseGeneratedKeys=&quot;true&quot;：使用数据库生成主键</span></span><br><span class=\"line\"><span class=\"comment\">\tkeyColumn=&quot;id&quot;：指定数据库主键的字段名</span></span><br><span class=\"line\"><span class=\"comment\">\tkeyProperty=&quot;id&quot;：指定Java实体类中用来接收主键的字段名</span></span><br><span class=\"line\"><span class=\"comment\"> --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertEmp&quot;</span> <span class=\"attr\">useGeneratedKeys</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">keyColumn</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;id&quot;</span>&gt;</span></span><br><span class=\"line\">  insert into t_emp(name,email,gender) values(#&#123;name&#125;,#&#123;email&#125;,#&#123;gender&#125;)</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>（2）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">insertEmp</span> <span class=\"params\">(Employee employee)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）service  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> TestService &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> TestMapper testMapper;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">Employee</span> <span class=\"variable\">employee</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Employee</span>();</span><br><span class=\"line\">\t\temployee.setName(<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\">\t\temployee.setEmail(<span class=\"string\">&quot;zhangsan@qq.com&quot;</span>);</span><br><span class=\"line\">\t\temployee.setGender(<span class=\"string\">&quot;男&quot;</span>);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\ttestMapper.insertEmp(employee);</span><br><span class=\"line\">\t\tSystem.out.println(employee.getId());</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>2、主键是非自增模式（比如主键是varchar类型）<br>（1）mapper.xml  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertTeacher&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">     selectKey：插入之前，先指定一段sql语句，生成一个主键值。</span></span><br><span class=\"line\"><span class=\"comment\">\t order=&quot;before | after&quot;：sql语句是在插入语句之前还是之后执行</span></span><br><span class=\"line\"><span class=\"comment\">\t resultType=&quot;&quot;：返回值类型</span></span><br><span class=\"line\"><span class=\"comment\">\t keyProperty=&quot;&quot;：将生成出来的值给谁</span></span><br><span class=\"line\"><span class=\"comment\">  --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">order</span>=<span class=\"string\">&quot;before&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;string&quot;</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;tId&quot;</span>&gt;</span></span><br><span class=\"line\">    select replace(uuid(), &#x27;-&#x27;, &#x27;&#x27;);</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></span><br><span class=\"line\">  insert into teacher (id, name) value (#&#123;tId&#125;, #&#123;tName&#125;);</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>（2）接口  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Interface TestMapper &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">insertEmp</span> <span class=\"params\">(Employee employee)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>（3）service  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> TestService &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> TestMapper testMapper;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">Teacher</span> <span class=\"variable\">teacher</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Teacher</span>();</span><br><span class=\"line\">\t\tteacher.setName(<span class=\"string\">&quot;张三&quot;</span>)</span><br><span class=\"line\">\t\tSystem.out.println(teacher.getId());</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"12、foreach标签\"><a href=\"#12、foreach标签\" class=\"headerlink\" title=\"12、foreach标签\"></a>12、foreach标签</h3><p>1、批量查询  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- List&lt;User&gt; selectBatch(@Param(&quot;ids&quot;) List&lt;Integer&gt; idList); --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;selectBatch&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from user where id in</span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- </span></span><br><span class=\"line\"><span class=\"comment\">     collection=&quot;idList | arg0 | list&quot;</span></span><br><span class=\"line\"><span class=\"comment\">\t open：遍历之前要追加的字符串</span></span><br><span class=\"line\"><span class=\"comment\">\t close：遍历结束需要添加的字符串</span></span><br><span class=\"line\"><span class=\"comment\">\t separator：每次遍历之间需要添加的字符串，如果是最后一次就不会追加了</span></span><br><span class=\"line\"><span class=\"comment\">\t item：获取每个遍历项</span></span><br><span class=\"line\"><span class=\"comment\">   --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">foreach</span> <span class=\"attr\">collection</span>=<span class=\"string\">&quot;idList&quot;</span> <span class=\"attr\">item</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">open</span>=<span class=\"string\">&quot;(&quot;</span> <span class=\"attr\">separator</span>=<span class=\"string\">&quot;,&quot;</span> <span class=\"attr\">close</span>=<span class=\"string\">&quot;)&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 对应item --&gt;</span></span><br><span class=\"line\">\t#&#123;id&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">foreach</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2、批量插入  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- void insertBatch(@Param(&quot;users&quot;) List&lt;User&gt; userList); --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertBatch&quot;</span>&gt;</span></span><br><span class=\"line\">  insert into user (name, age) values</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">foreach</span> <span class=\"attr\">collection</span>=<span class=\"string\">&quot;list&quot;</span> <span class=\"attr\">item</span>=<span class=\"string\">&quot;user&quot;</span> <span class=\"attr\">separator</span>=<span class=\"string\">&quot;,&quot;</span>&gt;</span></span><br><span class=\"line\">    (#&#123;user.name&#125;, #&#123;user.age&#125;)</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">foreach</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>3、批量更新<br>批量更新需要注意，如果一个标签涉及多个语句执行，需要设置允许指定多语句执行。<br>可以在数据库url链接后面加<code>allowMultiQueries=true</code>。<br>比如：<code>jdbc:mysql://localhost:3306/mybatis?allowMultiQueries=true</code>  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- int updateBatch(@Param(&quot;users&quot;) List&lt;User&gt; userList); --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">update</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;updateBatch&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">foreach</span> <span class=\"attr\">collection</span>=<span class=\"string\">&quot;list&quot;</span> <span class=\"attr\">item</span>=<span class=\"string\">&quot;user&quot;</span> <span class=\"attr\">separator</span>=<span class=\"string\">&quot;;&quot;</span>&gt;</span></span><br><span class=\"line\">    update user set name = #&#123;user.name&#125;, age = #&#123;user.age&#125; where id = #&#123;user.id&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">foreach</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">update</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"13、分页插件\"><a href=\"#13、分页插件\" class=\"headerlink\" title=\"13、分页插件\"></a>13、分页插件</h3><p>1、导入依赖  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.github.pagehelper<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>pagehelper<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.3.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2、配置插件<br>在mybatis-config.xml中配置插件。  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- 分页插件 --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">plugin</span> <span class=\"attr\">interceptor</span>=<span class=\"string\">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 分页参数合理化 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;helperDialect&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;mysql&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>其中，<code>com.github.pagehelper.PageInterceptor</code>是PageHelper插件的名词，<code>dialect</code>属性用于指定数据库类型（支持多种数据库）。<br>3、使用  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 调用查询方法之前必须先设置分页参数</span></span><br><span class=\"line\"><span class=\"comment\">// 第一个参数为：pageNum，表示当前页</span></span><br><span class=\"line\"><span class=\"comment\">// 第二个参数为：pageSize，表示每页显示的条数</span></span><br><span class=\"line\"><span class=\"comment\">// 注意：这里这个设置分页参数方法只针对一个查询方法，如果有多个查询方法，需要多次设置</span></span><br><span class=\"line\">PageHelper.startPage(<span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">List&lt;User&gt; userList = userMapper.selectBatch();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 将查询到的结果封装到一个PageInfo的分页实体类中</span></span><br><span class=\"line\">PageInfo&lt;User&gt; pageInfo = <span class=\"keyword\">new</span> <span class=\"title class_\">PageInfo</span>&lt;&gt;(userList);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 当前页</span></span><br><span class=\"line\">pageInfo.getPageNum();</span><br><span class=\"line\"><span class=\"comment\">// 总页数</span></span><br><span class=\"line\">pageInfo.getPages();</span><br><span class=\"line\"><span class=\"comment\">// 总条数</span></span><br><span class=\"line\">pageInfo.getTotal();</span><br><span class=\"line\"><span class=\"comment\">// 当前页的条数</span></span><br><span class=\"line\">pageInfo.getSize();</span><br><span class=\"line\"><span class=\"comment\">// 当前页的数据</span></span><br><span class=\"line\">pageInfo.getList();</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"14、生成代码\"><a href=\"#14、生成代码\" class=\"headerlink\" title=\"14、生成代码\"></a>14、生成代码</h3><p>MyBatisX 是一个 MyBatis 的代码生成插件，可以通过简单的配置和操作快速生成 MyBatis Mapper、pojo 类和 Mapper.xml 文件。下面是使用 MyBatisX 插件实现逆向工程的步骤：<br>1、安装插件<br>在 IntelliJ IDEA 中打开插件市场，搜索 MyBatisX 并安装。<br>2、使用 IntelliJ IDEA连接数据库<br>（1）连接数据库  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/0.png\" class=\"\">  \n<p>（2）填写信息  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.png\" class=\"\">  \n<p>（3）展示库表  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.png\" class=\"\">  \n<p>（4）生成代码  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/3.png\" class=\"\">  \n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/4.png\" class=\"\">  \n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/5.png\" class=\"\">  \n<p>（5）查看结果  </p>\n<img src=\"/2023/10/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/6.png\" class=\"\">  \n\n\n<h3 id=\"15、鉴别器\"><a href=\"#15、鉴别器\" class=\"headerlink\" title=\"15、鉴别器\"></a>15、鉴别器</h3><p>1、说明<br><code>discriminator</code>标签在MyBatis中是一种用于实现结果映射（ResultMap）的动态分支选择 的标签。它类似于Java中的switch-case或if-else逻辑，可以根据查询结果中的某个字段值（鉴别器字段）动态决定如何映射不同的结果类型。<br>2、作用<br>根据某个字段的值（如user_type、status等），动态选择不同的映射规则，适用于继承关系或多态查询。<br>3、示例<br>假设有一个 user 表，包含不同类型的用户（type 字段决定用户角色）：<br>（1）<code>type=1</code>：普通用户（GeneralUser）；<br>（2）<code>type=2</code>：VIP用户（VipUser）；<br>（3）<code>其他</code>：默认映射到基础用户（User）。<br>Java实体类：  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer type; <span class=\"comment\">// 鉴别字段：1=普通用户，2=VIP用户</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">GeneralUser</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String generalField; <span class=\"comment\">// 普通用户特有字段</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">VipUser</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String vipField; <span class=\"comment\">// VIP用户特有字段</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 基础映射 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;userMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;id&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;name&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;type&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;type&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 动态分支选择 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">discriminator</span> <span class=\"attr\">javaType</span>=<span class=\"string\">&quot;int&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;type&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">case</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;generalUserMap&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">case</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;2&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;vipUserMap&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">case</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;userMap&quot;</span>/&gt;</span> <span class=\"comment\">&lt;!-- 默认映射 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">discriminator</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 普通用户子映射 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;generalUserMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;GeneralUser&quot;</span> <span class=\"attr\">extends</span>=<span class=\"string\">&quot;userMap&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;generalField&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;general_field&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- VIP用户子映射 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;vipUserMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;VipUser&quot;</span> <span class=\"attr\">extends</span>=<span class=\"string\">&quot;userMap&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;vipField&quot;</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;vip_field&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getUserById&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;userMap&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT id, name, type, general_field, vip_field</span><br><span class=\"line\">    FROM user</span><br><span class=\"line\">    WHERE id = #&#123;id&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"16、sql标签\"><a href=\"#16、sql标签\" class=\"headerlink\" title=\"16、sql标签\"></a>16、sql标签</h3><p>在sql标签中使用变量别名。  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">sql</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dynamicAliasColumns&quot;</span>&gt;</span></span><br><span class=\"line\">    $&#123;tableAlias&#125;.id as $&#123;columnPrefix&#125;Id,</span><br><span class=\"line\">    $&#123;tableAlias&#125;.name as $&#123;columnPrefix&#125;Name</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">sql</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;selectData&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;map&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">include</span> <span class=\"attr\">refid</span>=<span class=\"string\">&quot;dynamicAliasColumns&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;tableAlias&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;u&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;columnPrefix&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;user&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span>,</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">include</span> <span class=\"attr\">refid</span>=<span class=\"string\">&quot;dynamicAliasColumns&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;tableAlias&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;d&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;columnPrefix&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;dept&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">    FROM user u</span><br><span class=\"line\">    LEFT JOIN department d ON u.dept_id = d.id</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"17、trim标签\"><a href=\"#17、trim标签\" class=\"headerlink\" title=\"17、trim标签\"></a>17、trim标签</h3><p><code>trim</code>标签中有四个属性：<br>（1）<code>prefix</code>：前缀，给拼接后的字符串拼接上一个前缀；<br>（2）<code>prefixOverrides</code>：前缀覆盖，去掉多余的字符；<br>（3）<code>suffix</code>：后缀，给拼接后的字符串拼接上一个后缀；<br>（4）<code>suffixOverrides</code>：后缀覆盖，去掉多余的字符。  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findUser&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">  select * from user</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">trim</span> <span class=\"attr\">prefix</span>=<span class=\"string\">&quot;where&quot;</span> <span class=\"attr\">suffixOverrides</span>=<span class=\"string\">&quot;and&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;id != 0&quot;</span>&gt;</span></span><br><span class=\"line\">        id=#&#123;id&#125; and</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;username != null&quot;</span>&gt;</span></span><br><span class=\"line\">        sex=#&#123;sex&#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">trim</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>说明：<br>（1）<code>prefix=&quot;where&quot;</code>：如果内容不为空，在最前面添加”where”关键字；<br>（2）<code>suffixOverrides=&quot;and&quot;</code>：如果内容以”and”结尾，移除最后的”and”。  </p>\n<h3 id=\"18、choose标签\"><a href=\"#18、choose标签\" class=\"headerlink\" title=\"18、choose标签\"></a>18、choose标签</h3><p>只会执行一个条件。<br>1、基本语法  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;条件1&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- SQL片段1 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;条件2&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- SQL片段2 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 默认SQL片段 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2、示例一：根据不同搜索类型查询  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;searchUsers&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT * FROM users</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;searchType == &#x27;name&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">                AND name LIKE CONCAT(&#x27;%&#x27;, #&#123;keyword&#125;, &#x27;%&#x27;)</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;searchType == &#x27;email&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">                AND email LIKE CONCAT(&#x27;%&#x27;, #&#123;keyword&#125;, &#x27;%&#x27;)</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;searchType == &#x27;phone&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">                AND phone = #&#123;keyword&#125;</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">                AND (name LIKE CONCAT(&#x27;%&#x27;, #&#123;keyword&#125;, &#x27;%&#x27;) </span><br><span class=\"line\">                OR email LIKE CONCAT(&#x27;%&#x27;, #&#123;keyword&#125;, &#x27;%&#x27;))</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>说明：（只会执行一个条件）<br>（1）如果满足<code>searchType == &#39;name&#39;</code>，就执行<code>AND name LIKE CONCAT(&#39;%&#39;, #&#123;keyword&#125;, &#39;%&#39;)</code>；<br>（2）如果满足<code>searchType == &#39;email&#39;</code>，就执行<code>AND email LIKE CONCAT(&#39;%&#39;, #&#123;keyword&#125;, &#39;%&#39;)</code>；<br>（3）如果满足<code>searchType == &#39;phone&#39;</code>，就执行<code>AND phone = #&#123;keyword&#125;</code>；<br>（4）如果上面都不满足，就执行<code>otherwise</code>标签中的内容。<br>3、示例二：多条件优先级查询  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findSpecialUsers&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT * FROM users</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;vipFlag != null and vipFlag == true&quot;</span>&gt;</span></span><br><span class=\"line\">                AND is_vip = 1  <span class=\"comment\">&lt;!-- 优先查询VIP用户 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;age != null&quot;</span>&gt;</span></span><br><span class=\"line\">                AND age = #&#123;age&#125;  <span class=\"comment\">&lt;!-- 其次按年龄查询 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;gender != null&quot;</span>&gt;</span></span><br><span class=\"line\">                AND gender = #&#123;gender&#125;  <span class=\"comment\">&lt;!-- 最后按性别查询 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">                AND status = &#x27;ACTIVE&#x27;  <span class=\"comment\">&lt;!-- 默认查询活跃用户 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>4、注意<br>（1）<code>&lt;choose&gt;</code>标签内必须有至少一个<code>&lt;when&gt;</code>子标签；<br>（2）<code>&lt;otherwise&gt;</code>是可选的，最多只能有一个；<br>（3）条件判断是按照<code>&lt;when&gt;</code>的顺序进行的，第一个满足条件的会被执行;<br>（4）可以嵌套使用，但不宜嵌套过深影响可读性；<br>（5）通常与<code>&lt;where&gt;</code>标签结合使用，避免SQL语法错误。  </p>\n<h3 id=\"19、Mybatis内置参数\"><a href=\"#19、Mybatis内置参数\" class=\"headerlink\" title=\"19、Mybatis内置参数\"></a>19、Mybatis内置参数</h3><p>注意：使用内置参数时不需要在方法参数中声明。<br>1、<code>_parameter</code>常用<br>（1）含义：代表整个传入的参数对象。<br>（2）用法  </p>\n<ul>\n<li>如果方法只有一个参数：_parameter 就代表这个参数本身；  </li>\n<li>如果方法有多个参数：_parameter 代表所有参数组成的 Map。</li>\n</ul>\n<p>（3）示例  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findUser&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT * FROM user</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_parameter != null&quot;</span>&gt;</span></span><br><span class=\"line\">            AND username LIKE CONCAT(&#x27;%&#x27;, #&#123;_parameter&#125;, &#x27;%&#x27;)</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>2、<code>_databaseId</code>常用<br>（1）含义：代表当前配置的数据库厂商标识。<br>（2）用法：用于编写多数据库支持的 SQL 语句。<br>（3）示例<br>需要在Mybatis配置文件中配置：  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">databaseIdProvider</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;DB_VENDOR&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;MySQL&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;mysql&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;Oracle&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;oracle&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;DB2&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;db2&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">databaseIdProvider</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;insertUser&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;int&quot;</span> <span class=\"attr\">order</span>=<span class=\"string\">&quot;BEFORE&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;oracle&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT seq_user.nextval FROM dual</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;db2&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            VALUES nextval for seq_user</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;mysql&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT LAST_INSERT_ID()</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></span><br><span class=\"line\">    INSERT INTO user(id, name) VALUES(#&#123;id&#125;, #&#123;name&#125;)</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>3、其它示例一：根据参数类型动态判断  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findByCondition&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;User&quot;</span>&gt;</span></span><br><span class=\"line\">    SELECT * FROM user</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_parameter instanceof java.util.Map&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- 当参数是Map时 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;mapParam.username != null&quot;</span>&gt;</span></span><br><span class=\"line\">                AND username = #&#123;mapParam.username&#125;</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_parameter instanceof com.example.User&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- 当参数是User对象时 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;id != null&quot;</span>&gt;</span></span><br><span class=\"line\">                AND id = #&#123;id&#125;</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>4、其它示例二：多数据库支持  </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;getCurrentDate&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;string&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;oracle&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT TO_CHAR(SYSDATE, &#x27;YYYY-MM-DD&#x27;) FROM dual</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;mysql&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT DATE_FORMAT(NOW(), &#x27;%Y-%m-%d&#x27;)</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_databaseId == &#x27;postgresql&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">            SELECT TO_CHAR(NOW(), &#x27;YYYY-MM-DD&#x27;)</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">            SELECT CONVERT(VARCHAR(10), GETDATE(), 120)</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"20、sql标签动态别名用法\"><a href=\"#20、sql标签动态别名用法\" class=\"headerlink\" title=\"20、sql标签动态别名用法\"></a>20、sql标签动态别名用法</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">sql</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;test&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"comment\">&lt;!-- 如果有别名就执行 --&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;_parameter != null and _parameter[&#x27;tableAlias&#x27;] != null and _parameter[&#x27;tableAlias&#x27;] != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.user_id,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.dept_id,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.user_name,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.nick_name,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.email,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.avatar,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.phonenumber,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.password,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.sex,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.status,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.del_flag,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.login_ip,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.login_date,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.create_by,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.create_time,</span><br><span class=\"line\">\t\t\t\t$&#123;_parameter[&#x27;tableAlias&#x27;]&#125;.remark</span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">&lt;!-- 如果没有别名就执行 --&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">\t\t\t\tuser_id, dept_id, user_name, nick_name, email, avatar, phonenumber, password, sex, status, del_flag, login_ip, login_date, create_by, create_time, remark</span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">sql</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;testOne&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;SysUserResult&quot;</span>&gt;</span></span><br><span class=\"line\">\t\tselect <span class=\"tag\">&lt;<span class=\"name\">include</span> <span class=\"attr\">refid</span>=<span class=\"string\">&quot;test&quot;</span>/&gt;</span> from sys_user</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;testTwo&quot;</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">&quot;SysUserResult&quot;</span>&gt;</span></span><br><span class=\"line\">\t\tselect <span class=\"tag\">&lt;<span class=\"name\">include</span> <span class=\"attr\">refid</span>=<span class=\"string\">&quot;test&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;tableAlias&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;u&quot;</span>/&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span>from sys_user u</span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"21、不使用分页插件，实现分页复用\"><a href=\"#21、不使用分页插件，实现分页复用\" class=\"headerlink\" title=\"21、不使用分页插件，实现分页复用\"></a>21、不使用分页插件，实现分页复用</h3><p>使用MyBatis的动态SQL和Java代码来实现复用。<br>通用的分页工具类：  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PageHelper</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">appendPageSql</span><span class=\"params\">(String sql, <span class=\"type\">int</span> pageNum, <span class=\"type\">int</span> pageSize)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">offset</span> <span class=\"operator\">=</span> (pageNum - <span class=\"number\">1</span>) * pageSize;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sql + <span class=\"string\">&quot; LIMIT &quot;</span> + pageSize + <span class=\"string\">&quot; OFFSET &quot;</span> + offset;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>然后在Mapper接口中调用：  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SelectProvider(type = UserSqlProvider.class, method = &quot;getUserListSql&quot;)</span></span><br><span class=\"line\">List&lt;User&gt; <span class=\"title function_\">getUserList</span><span class=\"params\">(<span class=\"type\">int</span> status, <span class=\"type\">int</span> pageNum, <span class=\"type\">int</span> pageSize)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">UserSqlProvider</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getUserListSql</span><span class=\"params\">(<span class=\"type\">int</span> status, <span class=\"type\">int</span> pageNum, <span class=\"type\">int</span> pageSize)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">sql</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;SELECT id, username, email FROM users WHERE status = #&#123;status&#125;&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> PageHelper.appendPageSql(sql, pageNum, pageSize);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这样，任何需要分页的查询都可以复用PageHelper，只需要传入页码和每页大小即可。这种方式在Java层实现了SQL的动态拼接，既灵活又可控。  </p>\n","categories":[{"name":"工作技能","path":"api/categories/工作技能.json"}],"tags":[{"name":"工作技能","path":"api/tags/工作技能.json"},{"name":"后端","path":"api/tags/后端.json"},{"name":"Mybatis","path":"api/tags/Mybatis.json"}]}